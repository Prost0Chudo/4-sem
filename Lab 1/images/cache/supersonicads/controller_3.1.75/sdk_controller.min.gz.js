!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Eventics=e()}}(function(){return function a(o,s,d){function l(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,a,o,s,d)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(e,t,n){t.exports=function(n){var r,a=["ironBeastEventicsProvider"],o=[],s={},d={},i=this,l=[],e=(n=n||1,"undefined"!=typeof jQuery?jQuery:{}),t=void 0!==window.angular?window.angular:{};function c(e){for(var t=o.length,n=0;n<t;n++)e(o[n])}function u(e){i.extend(d||{},e)}return i.extend=e.extend||t.extend||function(){for(var e,t,n=arguments.length,i=1,r=arguments[0]||{};i<n;i++)if(null!=(e=arguments[i]))for(t in e)void 0!==e[t]&&(r[t]=e[t]);return r},i.trackEvent=function(t,n,i){t&&(i=extend(i||{},d),r?c(function(e){e.trackEvent(t,n,i)}):l.push({eName:t,label:n,data:i,eType:"event"}))},i.trackTiming=function(t,n,i){t&&0<=parseInt(n)&&(i=extend(i||{},d),r?c(function(e){e.trackTiming(t,n,i)}):l.push({eName:t,time:n,data:i,eType:"timing"}))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),a=[];for(var t=e.length,n=0;n<t;n++)a.push(e[n])}},setProvidersConfig:function(e){s=e},init:function(e){r||(e&&u(e),function(){o=[];for(var e=a.length,t=0;t<e;t++){var n=a[t];if("function"==typeof window[n]){var i=new window[n];i.init(s),o.push(i)}}}(),r=!0,function(){for(var e in l){var t=l[e]||{};"event"===t.eType?i.trackEvent(t.eName,t.label,t.data):"timing"===t.eType&&i.trackTiming(t.eName,t.time,t.data)}l=[]}())},updateBaseData:u,createEventic:function(e,t){return(e=e||{}).userChance=n,new f(i,e,t)},updateUserChance:function(e){n=e}}};var f=e("./eventicsHelper.js");window.ironBeastEventicsProvider=e("./providers/ironBeastEventicsProvider.js"),window.QAEventicsProvider=e("./providers/QAEventicsProvider.js"),window.KuduEventicsProvider=e("./providers/KuduEventicsProvider.js")},{"./eventicsHelper.js":2,"./providers/KuduEventicsProvider.js":3,"./providers/QAEventicsProvider.js":4,"./providers/ironBeastEventicsProvider.js":5}],2:[function(e,t,n){t.exports=function(e,t,a){var n=void 0!==(t=t||{}).productChance?t.productChance:1,i=void 0!==t.userChance?t.userChance:1,s=e||{},d=t.baseData||{},l={},c=s.extend,r={};function u(e){return e&&e.name&&e.id}return r.trackEvent=function(e,t,n){if(!u(e)||a.isEventDisabled(e))return!1;var i=e.name,r=e.id;n||(n={}),n.eventId=r,n=c({},d,n||{}),s.trackEvent(i,t,n)},r.trackTimingStart=function(e,t){if(!u(e))return!1;var n=e.name;return t=t||Date.now(),l[n]=t,!0},r.trackTimingStop=function(e,t){if(!u(e))return!1;var n,i,r=e.name;if(t||(t={}),t.eventId=e.id,t&&t.timeStamp?(i=t.timeStamp,delete t.timeStamp):i=Date.now(),t&&t.eNameStart&&t.eNameStart.name?(n=l[t.eNameStart.name],delete t.eNameStart):l[r]&&(n=l[r],l[r]=null),n){var a=i-n,o=c({},d);return t=c(o,t||{}),s.trackTiming(r,a,t),!0}},r.updateBaseData=function(e){for(var t in e)d[t]=e[t];return!0},r.resetBaseData=function(e){for(var t=0;t<e.length;t++)r.unsetParamFromBaseData(e[t])},r.unsetParamFromBaseData=function(e){d.hasOwnProperty(e)&&delete d[e]},r.incrementSessionNumber=function(){return d.sessionDepth?d.sessionDepth++:d.sessionDepth=1,!0},0<i&&i<=n?r:function(){var e={};for(var t in r)"function"==typeof r[t]&&(e[t]=function(){});return e}()}},{}],3:[function(e,t,n){t.exports=function(){var n,i,r="https://logs.ironsrc.mobi/logs",a={table:"supersonic.adunitanalytics.ad_unit_events"},o=["generalmessage","emptyowreason","landingid","callfailreason","rvnomoreoffersreason"];function s(e,t){switch(e){case"landingid":t=parseInt(t);break;case"generalmessage":case"emptyowreason":t=n=void 0===(n=t)?"undefined":null===n?"null":n.toString()}var n;return t}function d(e){if(e){e=function(e){if(!e)return e;for(var t=Object.keys(e),n=t.length;n--;){var i=t[n],r=i.toLowerCase(),a=e[i];-1!==o.indexOf(r)&&(a=s(r,a)),e[r]=a,i!==r&&delete e[i]}return e}(e);var t={table:a.table,data:e};i(t)}}function t(e){var t=new XMLHttpRequest;t.open("POST",n,!0),t.onerror=function(){e&&0<=e.retry&&e.retry<2&&(e.retry++,i(e))},t.send(JSON.stringify(e))}function l(t){var n;try{n=btoa(JSON.stringify(t))}catch(e){t.data.applicationUserId="badName",t.data.userId="badName",t.data.eventName="errorEvent",n=btoa(JSON.stringify(t))}var e=r+"?data="+n,i=new XMLHttpRequest;i.open("GET",e,!0),i.send()}return{init:function(e){i=e&&"POST"===e.method?(n="https://postlog.supersonic.com/logs",t):(n=r,l)},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,d(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,d(n))}}}},{}],4:[function(e,t,n){t.exports=function(){var i,r={};function a(e){if(e){r.data=e;var t=function e(t,n){var i=[];for(var r in t)if(t.hasOwnProperty(r)){var a=n?n+"["+r+"]":r,o=t[r];i.push("object"==typeof o?e(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}(r);delete r.data,(n=i+"?"+t)&&((new Image).src=n)}var n}return{init:function(e){i="http://qa.eventics.qa"},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,a(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,a(n))}}}},{}],5:[function(e,t,n){t.exports=function(){var i,r={table:"supersonic.adunitanalytics.ad_unit_events"};function a(e){if(e){var t;r.data=e;try{t=btoa(JSON.stringify(r))}catch(e){r.data.applicationUserId="badName",r.data.userId="badName",r.data.eventName="errorEvent",t=btoa(JSON.stringify(r))}delete r.data,(n=i+"?data="+t)&&((new Image).src=n)}var n}return{init:function(e){i=e.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},trackEvent:function(e,t,n){if(e){if(t&&"object"==typeof t){var i=Object.keys(t)[0];i&&(n[i]=t[i])}n.eventName=e,a(n)}},trackTiming:function(e,t,n){e&&0<=parseInt(t)&&(n.eventName=e,n.timingValue=t,a(n))}}}},{}]},{},[1])(1)}),function a(o,s,d){function l(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,a,o,s,d)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(e,i,t){(function(e){(function(){var t,n,a,o,s,d,l,c,u,f,p,g,v,m,h,b,S,y,A,C,D,I,w,P;!function(t){var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};function n(n,i){return n!==r&&("function"==typeof Object.create?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(e,t){return n[e]=i?i(e,t):t}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){t(n(r,n(e)))}):"object"==typeof i&&"object"==typeof i.exports?t(n(r,n(i.exports))):t(n(r))}(function(e){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};t=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},o=function(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(o=(a<3?r(o):3<a?r(t,n,o):r(t,n))||o);return 3<a&&o&&Object.defineProperty(t,n,o),o},s=function(n,i){return function(e,t){i(e,t,n)}},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,o,s,d){return new(s||(s=Promise))(function(n,t){function i(e){try{a(d.next(e))}catch(e){t(e)}}function r(e){try{a(d.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,r)}a((d=d.apply(e,o||[])).next())})},c=function(n,i){var r,a,o,e,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,a&&(o=2&t[0]?a.return:t[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,t[1])).done)return o;switch(a=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],a=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},u=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||P(t,e,n)},P=Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(i=a.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},g=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e},v=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,r++)i[r]=a[o];return i},m=function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},h=function(e){return this instanceof h?(this.v=e,this):new h(e)},b=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),o=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(i){a[i]&&(r[i]=function(n){return new Promise(function(e,t){1<o.push([i,n,e,t])||s(i,n)})})}function s(e,t){try{(n=a[e](t)).value instanceof h?Promise.resolve(n.value.v).then(d,l):c(o[0][2],n)}catch(e){c(o[0][3],e)}var n}function d(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},S=function(i){var e,r;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,n){e[t]=i[t]?function(e){return(r=!r)?{value:h(i[t](e)),done:"return"===t}:n?n(e):e}:n}},y=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=d[Symbol.asyncIterator];return t?t.call(d):(d=f(d),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(s){e[s]=d[s]&&function(o){return new Promise(function(e,t){var n,i,r,a;o=d[s](o),n=e,i=t,r=o.done,a=o.value,Promise.resolve(a).then(function(e){n({value:e,done:r})},i)})}}},A=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var r=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};C=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&P(t,e,n);return r(t,e),t},D=function(e){return e&&e.__esModule?e:{default:e}},I=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},w=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},e("__extends",t),e("__assign",n),e("__rest",a),e("__decorate",o),e("__param",s),e("__metadata",d),e("__awaiter",l),e("__generator",c),e("__exportStar",u),e("__createBinding",P),e("__values",f),e("__read",p),e("__spread",g),e("__spreadArrays",v),e("__spreadArray",m),e("__await",h),e("__asyncGenerator",b),e("__asyncDelegator",S),e("__asyncValues",y),e("__makeTemplateObject",A),e("__importStar",C),e("__importDefault",D),e("__classPrivateFieldGet",I),e("__classPrivateFieldSet",w)})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){t.exports=function(e){var t={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0,mediationType:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(t.deviceApiLevel=0)},getCommonRequiredData:function(){return t}}}},{}],3:[function(e,t,n){"use strict";n.__esModule=!0;var i=function(){function e(e,t,n,i,r,a){this.core=e,this.controller=t,this.constants=n,this.jQuery=i,this.dsConfig=r,this.isBidding=a}return e.prototype.parse=function(e){var t=e.seatbid.ext;return this.extendControllerConfigSettings(t),this.extendDSConfigSettings(t),this.extendNetworkConfigSettings(t),this.extendMicroJobLandingIDSettings(t),this.extendBannerCacheSettings(t),t},e.prototype.extendControllerConfigSettings=function(e){e.shouldStartMuted=this.controller.AdUtils.isCampaignShouldStartMuted(this.controller.getConfig().controllerConfig,this.dsConfig.productType);var t=this.controller.AdUtils.delayUntilCloseVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),n=this.controller.AdUtils.delayUntilTimerVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),i=this.controller.AdUtils.endScreenSettings(this.controller.getConfig().controllerConfig,this.dsConfig.productType);this.core.Utils.isDefined(t)&&(e.DEC=t),this.core.Utils.isDefined(n)&&(e.DECT=n),this.core.Utils.isDefined(i)&&this.jQuery.extend(e,{"2EC":i})},e.prototype.extendDSConfigSettings=function(e){this.jQuery.extend(!0,e,this.dsConfig.overrideFeedSettings)},e.prototype.extendNetworkConfigSettings=function(e){this.jQuery.extend(!0,e,this.controller.SupplyConfigurations.getFeaturesConfigByAdSource(e.adSource))},e.prototype.extendMicroJobLandingIDSettings=function(e){e.sdkToggles&&(this.jQuery.extend(!0,e,e.sdkToggles),delete e.sdkToggles)},e.prototype.extendBannerCacheSettings=function(e){this.isBidding||this.dsConfig.productType!==this.constants.BN||(e.numOfBannersToInitSuccess=0,e.numOfBannersToCache=0)},e}();t.exports=i},{}],4:[function(e,t,n){"use strict";n.__esModule=!0,t.exports=function(d,l,c){var e=l.appInfo.orientation,u=e.portrait,f=e.landscape,p={android:function(e,t,n){return e.ext.forceOrientation.toLowerCase()},ios:function(e,t,n){return i=e,r=t.getABTestConfiguration(i.productType,i.ext.landingId).ignoreAppOrientationInForceCampaigns||!1,d.log("shouldIgnoreAppOrientationInForcedCampaign: "+Boolean(r),d.LogLevels.verbose),!r&&c.getOrientation()&&c.isAppOrientation(e.ext.forceOrientation.toLowerCase())?(d.log("forced campaign | application is locked on the same orientation - sending  default: "+n,d.LogLevels.verbose),n):e.ext.forceOrientation.toLowerCase();var i,r}};function g(t){return t&&t.controllerConfig&&["499b4845","406ff65d"].some(function(e){return e===t.controllerConfig.applicationKey})}return{getAdDisplayOrientation:function(e,t,n){if(n){var i,r,a,o="undefined",s=l.defaultOrientation[n.productType];return g(e)&&n.settings&&(n.settings.orientation=u),r=e,(a=n).ext&&a.ext.forceOrientation&&(!g(r)||g(r)&&a.ext.forceOrientation.toLowerCase()===f)?o=s=p[e.mobileSDKSettings.deviceOs](n,t,s):s=(i=n).settings&&i.settings.orientation?n.settings.orientation:c.getOrientation(),"string"==typeof s&&s.toLowerCase()===l.appInfo.orientation.none&&(s=l.defaultOrientation[n.productType]),d.log("adOrientation | forceByCampaign:"+o+" , forceBySession:"+n.settings.orientation+" ,forceByNative:"+c.getOrientation()+" , ChosenOrientation:"+s,d.LogLevels.info),s?s.toLowerCase():""}}}}},{}],5:[function(e,t,n){"use strict";n.__esModule=!0;var x=e("../types"),L=e("./Constants");t.exports=function(o,n,r){var s="MRAID",d="VAST",l="EXTERNAL",c="INTERNAL",u="AT_MP",f="PLAYABLE",p="IMAGE_INTERSTITIAL",g="STATIC_BANNER",v="OTHER",i={};function a(e){if(e)return e.id||b(e,m(e)||"",h(e)||""),e.id&&e.id.toString()}function m(e){if(e){var t=e.crid||e.bannerId||e.bannerID;return t&&t.toString()}}function h(e){if(e)return(e.creativeId||"0").toString()}function b(e,t,n){e.id=t+"_"+n}function S(e,t){if(!e)return"";var n=y(e,t);return i[n]||i.other}i[s]="MR",i[d]="VA",i[l]="EX",i[c]="AT",i[u]="AT_MP",i[f]="PL",i[p]="IM",i[g]="SB",i[v]="OT";var y=function(e,t){var n,i,r=e&&e.ext,a="";return r?a=(i=r)&&i.type&&"imageInterstitial"===i.type?p:o.VastUtils.isVastCampaign(e)?d:A(r)?f:C(r)?s:D(r)?u:I(r)?l:w(r)?c:(n=r)&&n.type&&n.type===x.AdType.StaticBanner?g:v:a};function A(e){return e&&e.type&&"playableAd"===e.type}function C(e){return e&&e.type&&"MRAID"===e.type}function D(e){return e&&e.type&&e.type===x.AdType.AppTrailerMarketplace}function I(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function w(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function P(e){var t={};return t.id=a(e),t.title="",t.credits=e.credits,t.staticContent=o.AdAssets.extractStaticFiles(e,O(e)),t.lastUpdateTime=e.lastUpdateTime,t.inventoryIndex=e.inventoryIndex,t.isCacheable=e.isCacheable=0<t.staticContent.length,t}function O(e){var t=e.ext;return A(t)&&t.videoData&&t.videoData.videoSource&&t.videoData.videoSource.html&&-1<t.videoData.videoSource.html.indexOf(o.AdAssets.getPlayableCacheFlag())}function T(e){var t=n.getApiData({deviceOs:1}).deviceOs;e.standaloneView=t===L.deviceOs.ios,e.translucentView=t===L.deviceOs.android}function F(e,t){var n={};return t&&t.ext&&t.ext.opportunityID&&(n.opportunityId=t.ext.opportunityID),e&&e.requestID&&(n.requestId=e.requestID),n}return{getAdId:a,getAdIdsOfAds:function(e){if(!e||!Array.isArray(e))return[];for(var t=[],n=0;n<e.length;n++)t.push(a(e[n]));return t},generateUniqueAdId:function(e){return e.productType+"."+e.demandSourceName+"."+a(e)+"."+Date.now()},getBannerId:m,getCreativeId:h,getAdType:S,formatParamsToAdId:function(e){if(e){if(!e.id){var t=m(e);t&&b(e,t,L.legacyCreativeId.toString())}return e}},formatAdsForPrecache:function(e){return e.map(function(e,t){return P(e)}).filter(function(e){return e.isCacheable})},isCacheableAd:function(e){return e&&e.hasOwnProperty("isCacheable")},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;var t,n,i="",r=e.ext.clickTags.clickURL;return r&&(t=r.match(/id\d+/g),n="",t&&(t=(t=t[t.length-1]).match(/\d+/g),n=Array.isArray(t)?t[0]:""),i=n||"")&&(e.ext.clickTags.storeAppId=i),i},formatVastAdForPrecache:function(e,t){var n;return(n=P(e)).preProcessing=t,n.isCacheable=e.isCacheable=!0,n},setViewType:function(e,t,n){var i;t&&t.ext&&(i=t.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl)&&T(e),n&&(e.viewType=n)},removeViewTypeFromSetting:function(e){e.viewType&&delete e.viewType},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:F,updateEventWithAdParams:function(e,t,n){return t&&(r.extend(n,F(e,t)),n.bannerId=m(t),n.creativeId=h(t),n.campaignType=S(t,e)),n},isPlayableCampaign:A,isPlayablePrecachedAd:O,isInternalCampaign:w,isAppTrailerMarketPlaceCampaign:D,isMRAIDCampaign:C,isExternalCampaign:I,isCampaignShouldStartMuted:function(e,t){return!(!e||!e[L.sspProductNames[t]]||!0!==e[L.sspProductNames[t]].startVideoOnMute)},delayUntilCloseVisible:function(e,t){if(e&&e[L.sspProductNames[t]]&&o.Utils.isDefined(e[L.sspProductNames[t]].DEC))return e[L.sspProductNames[t]].DEC},endScreenSettings:function(e,t){var n;return null===(n=null==e?void 0:e[L.sspProductNames[t]])||void 0===n?void 0:n["2EC"]},delayUntilTimerVisible:function(e,t){if(e&&e[L.sspProductNames[t]]&&o.Utils.isDefined(e[L.sspProductNames[t]].DECT))return e[L.sspProductNames[t]].DECT},extendAdObjectWithConfig:function(e,t,n,i){t.settings=r.extend(!0,t.settings,i),t.ext&&t.ext.forceOrientation&&(t.settings.orientation=t.ext.forceOrientation.toLowerCase()),r.extend(!0,t,n,{url:e})},extendSettingsWithStandaloneViewSupport:T,extractEventData:function(e){return e&&e.ext?{requestId:e.requestID,opportunityId:e.ext.opportunityID,bannerId:m(e),creativeId:h(e),campaignType:S(e,e.ext),rvPlayMethod:e.displayMode,displayStrategy:e.displayStrategy,dynamicDemandSource:e.ext.dynamicDemandSource,auctionId:e.ext.auctionId,adunitVersion:e.adunitVersion,adunitbn:e.adunitbn,isBiddingInstance:e.isInAppBidding,productType:e.productType,demandSourceName:e.originalDemandSourceName,sessionDepth:e.settings&&e.settings.sessionDepth,strategyId:e.settings&&e.settings.strategyId,landingId:e.settings&&e.settings.landingId,adSource:e.settings&&e.settings.adSource}:{}},mraidWaitForVisible:function(e,t){var n;if(e&&e[L.sspProductNames[t]]&&o.Utils.isDefined(null===(n=e[L.sspProductNames[t]])||void 0===n?void 0:n.mraidReadyOnlyInVisible))return e[L.sspProductNames[t]].mraidReadyOnlyInVisible}}}},{"../types":180,"./Constants":14}],6:[function(e,t,n){t.exports=function(i,r,a){return{decideOnAdvertisingId:function(e,t){var n;r.isIOS()&&(-1===i.Utils.versionCompare(e.deviceOSVersion,"10")||(n=e)["deviceIds[IFA]"]&&n["deviceIds[IFA]"]!==a.advertisingId.invalidAdvertisingId)&&(void 0===t.sid||t.sid||(e["deviceIds[IDFV]"]=null))}}}},{}],7:[function(t,e,n){e.exports=function(n,i,e){var r="AndroidLifeCycleEventHandlers | ",a=t("./NativeLifeCycleEventsConstants.js"),o=i.jQuery(),s={};function d(e){var t={};e&&(t.eventParams=e),n.PubSub.publish(a.serviceCallback+"."+a.AndroidEvents.onDestroy,[t])}function l(e){}function c(e){}function u(e){}function f(e,t){var n;return n="_isEventSupported: "+e+" supportedEvents: "+t,i.log(r+n),e&&-1<o.inArray(e,t)}return{publishEvent:function(e,t){s[a.AndroidEvents.onDestroy]=d,s[a.AndroidEvents.onStop]=l,s[a.AndroidEvents.onStart]=c,s[a.AndroidEvents.onResume]=u,f(e,Object.keys(s))&&s[e](t)}}}},{"./NativeLifeCycleEventsConstants.js":38}],8:[function(e,t,n){t.exports={eventicsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],9:[function(e,t,n){t.exports=function(r){var a,o=e("./AndroidNomediaFileConstants.js"),s=o.noMediaFileUrl;return{init:function(e){a=e},updateNomediaFileToCache:function(){var e,t=r.getConfig(),n=r.Cache.getRootCacheStructure(),i=(e=t).mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+s;n&&-1!==r.Cache.getFileIndexInCache(n.cache,i)?r.log(o.logMessage.tag+o.logMessage.fileInCache):(r.log(o.logMessage.tag+o.logMessage.saveFileToCache),r.saveFileToCache("./",i).then(function(){a.trackEvent(o.eventicsCategories.nomediaFileDownloadSuccess)},function(e){e!==o.errorMessage.fileAlreadyExist&&a.trackEvent(o.eventicsCategories.nomediaFileDownloadFail,{generalMessage:e})}))}}}},{"./AndroidNomediaFileConstants.js":8}],10:[function(e,t,n){t.exports={NativeAPI:{getAUIDFailed:"getAUIDFailed",getAUIDSuccess:"getAUIDSuccess",setAUIDFailed:"setAUIDFailed",setAUIDSuccess:"setAUIDSuccess"}}},{}],11:[function(e,t,n){t.exports=function(u,f,p){var n,l,g="AppUserIdService | ",c=!1,t=e("../modules/SDKController/EventCategories")(),v=e("./AppUserIdConstants");function m(e){var t,n,i,r,a,o,s,d,l,c=new jQuery.Deferred;return(t=e)&&!jQuery.isEmptyObject(t)&&"{}"!==t?c.resolve(e):(n=u.Utils.generateIdentifier(1),i=c,s=[],d=v.NativeAPI.setAUIDSuccess,l=v.NativeAPI.setAUIDFailed,n&&i&&(s.push(u.PubSub.subscribe(p.CB+"."+d,function(e){if(clearTimeout(o),!(r=f.isIOS()?e&&e.key&&e.key===S()&&e.value&&decodeURIComponent(e.value):e&&e[S()]&&decodeURIComponent(e[S()]))||jQuery.isEmptyObject(r)||"{}"===r)return i.reject("Invalid set AUID response."),void u.PubSub.clearHandlers(s);f.log(g+"_setAUIDKeyInNative succeeded, response: "+r,f.LogLevels.info),i.resolve(r),u.PubSub.clearHandlers(s)})),s.push(u.PubSub.subscribe(p.CB+"."+l,function(e){clearTimeout(o),a=e&&!f.checkRequiredCallbackParams(["errMsg"],e,l).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,l).errMsg:e&&e.errMsg,f.log(g+"_setAUIDKeyInNative failed, errorMsg: "+a,f.LogLevels.info),i.reject(l+": "+a),u.PubSub.clearHandlers(s)})),o=setTimeout(function(){f.log(g+"_setAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),i.reject(l+": timeout"),u.PubSub.clearHandlers(s)},4e3),f.callSDKFunction("setUserData",{key:S(),value:n},d,l))),c.promise()}function h(e,t){n=e,u.Eventics.updateBaseData({auid:n}),t||f.getTokenService().updateToken({auid:n})}function b(e){l.trackEvent(t.auidFail,{},{callfailreason:e})}function S(){var e=f.SupplyConfigurations.getNetworkConfigValueByKey("auid_key");return e||"auid"}return{init:function(e){var t,n,i,r,a,o,s,d;c||(l=e,(t=f.SupplyConfigurations.getValueByKey("auid"))?h(t,!0):(a=[],o=new jQuery.Deferred,s=v.NativeAPI.getAUIDSuccess,d=v.NativeAPI.getAUIDFailed,a.push(u.PubSub.subscribe(p.CB+"."+s,function(e){if(clearTimeout(r),!(n=e&&e[S()]&&decodeURIComponent(e[S()])))return o.reject("Invalid get AUID response"),void u.PubSub.clearHandlers(a);f.log(g+"_getAUIDFromNative succeeded, response: "+n,f.LogLevels.info),o.resolve(n),u.PubSub.clearHandlers(a)})),a.push(u.PubSub.subscribe(p.CB+"."+d,function(e){clearTimeout(r),i=e&&!f.checkRequiredCallbackParams(["errMsg"],e,d).didSucceed?f.checkRequiredCallbackParams(["errMsg"],e,d).errMsg:e&&e.errMsg,f.log(g+"_getAUIDFromNative failed, errorMsg: "+i,f.LogLevels.info),o.reject(d+": "+i),u.PubSub.clearHandlers(a)})),r=setTimeout(function(){f.log(g+"_getAUIDFromNative failed, errorMsg: timeout",f.LogLevels.info),o.reject(d+": timeout"),u.PubSub.clearHandlers(a)},4e3),f.callSDKFunction("getUserData",{key:S()},s,d),o.promise()).then(m).then(h).fail(b),c=!0)},getAUID:function(){return n}}}},{"../modules/SDKController/EventCategories":147,"./AppUserIdConstants":10}],12:[function(e,t,n){t.exports=function(t){var r={},n=!1;function a(e,t){var n=r[e],i=[];return n&&n[t]?i=n[t]:n[t]=i,i}return{init:function(e){n||(r[t.RV]={},r[t.IS]={},r[t.BN]={},n=!0)},addToBlacklistedCampaigns:function(e,t,n){if(e&&t&&n){var i=a(e,t);i&&-1===i.indexOf(n)&&i.push(n)}},getBlacklistedCampaigns:function(e,t){var n=[];return e&&t&&(n=a(e,t)),n},isEmpty:function(e,t){var n=a(e,t);return!n||0===n.length}}}},{}],13:[function(e,t,n){t.exports=function(l,u,c){var n,f,p="FilterCampaigns | ",i={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},g=1500,v=l.Utils,a={};function o(e){var t,n,i,r=new jQuery.Deferred,a="checkInstalledAppsSuccess",o="checkInstalledAppsFailed",s={appIds:e,requestId:Date.now().toString()},d=function(){l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n)};return t=l.PubSub.subscribe(c.CB+"."+a,function(e){e.requestId===s.requestId&&(clearTimeout(i),d(),u.log(p+"successfully check apps installed "+JSON.stringify(e.result)),r.resolve(e.result))}),n=l.PubSub.subscribe(c.CB+"."+o,function(e){clearTimeout(i),d(),u.log(p+"failed to check apps installed"+JSON.stringify(e)),r.reject()}),i=setTimeout(function(){d(),r.reject("SDK check apps installed timeout request")},g),u.callSDKFunction("checkInstalledApps",s,a,o),r.promise()}function s(e){var a={deviceId:"ios"===(n=u.getApiData(i)).deviceOs?n["deviceIds[IFA]"]:n["deviceIds[AID]"],os:n.deviceOs,campaignIds:{}},t=f.urlPaths&&f.urlPaths.campaignsStatus;t?(jQuery.each(e,function(e,t){var n,i,r;a.campaignIds[t.campaignId]=(n=t.isInstalled,r=n?(i=50,100):(i=0,50),Math.floor(Math.random()*(r-i))+i)}),jQuery.ajax({url:t,data:a,type:"GET",dataType:"jsonp",success:function(e){u.log("Success update campaigns status to server",u.LogLevels.verbose)},error:function(e,t){u.log("Success update campaigns status to server: response:"+e+".status: "+t,u.LogLevels.verbose)}})):u.log("No url in settings to update server on campaigns status",u.LogLevels.verbose)}function m(e,t){var n=!0;return e||(u.log("filter apps installed flag is false",u.LogLevels.verbose),n=!1),t&&0!==t.length||(u.log("get 0 campaigns to filter",u.LogLevels.verbose),n=!1),u.isLegacy({ios:"5.14",android:"5.16"})&&(u.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",u.LogLevels.verbose),n=!1),n}function h(e,t,n){var i,r=new jQuery.Deferred;return jQuery.isEmptyObject(t)?r.resolve():(i=n,u.isAppsInstalledInfoRestricted()?l.Utils.returnResolvedPromise(a):o(i)).then(function(e,i,t,n){jQuery.each(n,function(e,t){var n=i[e];n&&(t.bannerIds=n)});var o,r,s,a=(o=e,r=n,s=[],jQuery.each(r,function(e,t){if(t.isInstalled){for(var n=[],i=0;i<o.length;i++){var r=u.AdUtils.getAdId(o[i]);t.bannerIds&&-1===t.bannerIds.indexOf(r)?n.push(o[i]):s.push(o[i])}for(var a=o.length=0;a<n.length;a++)o.push(n[a])}}),u.log(p+"after ads filtering"),{newCampaigns:o,installedCampaigns:s});return e=a.newCampaigns,t.resolve(a.installedCampaigns),n}.bind(null,e,t,r)).then(s).fail(function(e){u.log("failed filter campaigns by app installed. "+e,u.LogLevels.verbose),r.resolve()}),r.promise()}return{filterByAppInstalled:function(e,t,n){if(n=n||[],!m((f=t).filterAppsInstalled,e))return v.returnResolvedPromise();for(var i={},r=e.length,a=[],o=0;o<r;o++){var s=e[o],d=u.AdUtils.getAdId(s),l=s&&s.ext,c=l&&l.appData;l&&c&&c.appId&&(0===n.length||-1===n.indexOf(l.type))&&(i[c.appId]||(i[c.appId]=[]),i[c.appId].push(d),-1===a.indexOf(c.appId)&&a.push(c.appId))}return h(e,i,a)},filterByAppInstalledOW:function(e,t){if(f=t,!m(!0,e))return v.returnResolvedPromise();for(var n={},i=e.length,r=[],a=0;a<i;a++){var o=e[a],s=u.AdUtils.getAdId(o),d=o.appData;d&&d.filterIfInstalled&&d.appId&&(n[d.appId]||(n[d.appId]=[]),n[d.appId].push(s),-1===r.indexOf(d.appId)&&r.push(d.appId))}return h(e,n,r)},checkIfAppInstallOnDevice:o}}},{}],14:[function(e,t,n){var i=e("../constants/featureCompatibilityMap");t.exports={CB:"NativeCallback",WebControls:"WebControls",RV:"RewardedVideo",OW:"OfferWall",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",fakeOWLoader:"fakeOWLoader",timeunit:6e4,closeAndBackDisabledTimer:1e4,closeAndBackDisabledTimerOW:8e3,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage",onAdVisibleFailed:"onAdVisible failed",screenVisibleTimeout:"Screen visible timeout",userClosedBeforeAdVisible:"userClosedBeforeAdVisible"},noFill:"We did not receive any campaigns in inventory"},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore",closeBanner:"closeBanner"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed",displayWebviewSuccess:"onDisplayWebviewSuccess",displayWebviewFailed:"onDisplayWebviewFailed:"},offerWallSetting:{immersive:"immersive",OLXD:"OLXD",OWVersion:"OWVersion",defaultOWVersion:"1.12.183"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",OfferWall:"offerWall",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{normal:0},baseDataKeys:["bannerId","creativeId","campaignType","opportunityId","requestId","adSource"],keysToResetOnAdClosed:["rvPlayMethod","dynamicDemandSource","sessionDepth","adunitbn","adunitVersion","origin","feedCampaignOrder","feedSize","strategyId"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone13,1","iPhone13,2","iPhone13,3","iPhone13,4","iPhone14,2","iPhone14,3","iPhone14,4","iPhone14,5"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896},type3:{width:390,height:844},type4:{width:428,height:926}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey","applicationUserId"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType","skd"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},xCodeVersion:"xCodeVersion",abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner",OfferWall:"offerwall"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{RewardedVideo:"application",Interstitial:"application",OfferWall:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{RewardedVideo:{android:/^10/,ios:/^7/},OfferWall:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^7|8|9/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//rv-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-rv-gateway.sonic-us.supersonicads.com/gateway/sdk/request"},IS:{production:"//is-gateway.supersonicads.com/gateway/sdk/request/",staging:"//staging-is-gateway.sonic-us.supersonicads.com/gateway/sdk/request/"},OW:{production:"//ow-gateway.supersonicads.com/gateway/offerwall/request",staging:"//staging-ow-gateway.sonic-us.supersonicads.com/gateway/offerwall/request"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},appExtConfigPath:"/users/microjob/sdkconfig.json",appExtConfigPathStaging:"/users/microjob/sdkconfig_staging.json",requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},adViewIdString:"adViewId",bannerAdViewId:"Banner.SupersonicAds",DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0,adTypes:{CPVI:"CPVI",customEndCard:"customEndCard",imageInterstitial:"imageInterstitial",MRAID:"MRAID",playableAd:"playableAd"},extraOffers:{minimalAndroidApiLevel:21,fetchTimeout:1e4,minimumAdsForExtraOffersInventory:2},viewableChangeReasons:{storeKitOpen:"storeKitOpen",storeKitClose:"storeKitClose"},storeKit:{minimalSupportedOSVersion:11,loadFailuresToPreventRetry:["Invalid Parameters","Unsupported Orientation"],loadingTimeoutMessage:"StoreKit load timeout"},authorizationStatus:"att",advertisingId:{invalidAdvertisingId:"00000000-0000-0000-0000-000000000000"},advertiserIdParamsToUpdate:["deviceIds[IFA]","deviceIds[IDFV]","isLimitAdTrackingEnabled","att","idfa","idfv","lat"],adPlayerDirectory:"ad-player",cacheAdsDirectory:"ads",numOfBannersToInitSuccess:"numOfBannersToInitSuccess",numOfBannersToCache:"numOfBannersToCache",cacheConfiguration:"cacheConfig",defaultTimeoutForCachingAds:3e4,isBNAutoRemove:"isBNAutoRemove",bnAutoDestroy:"bnAutoDestroy"}},{"../constants/featureCompatibilityMap":94}],15:[function(e,t,n){t.exports=function(i,r,t){function n(e){return!(e&&e.productType)}function a(e,t){return t=t||{},e&&e.demandSourceName&&(t.demandSourceName=e.demandSourceName,t.demandSourceId=e.demandSourceId,t.isInAppBidding=e.isInAppBidding),t}return{isLegacy:n,extendCallbackParamsWithDemandConfig:a,extendCallbackParamsWithProductConfig:function(e,t){return t=a(e,t),e&&e.productType&&(t.productType=e.productType),t},extendCallbackParamsWithParentProductConfig:function(e,t){if(t=a(e,t),e&&e.productType){var n=r[e.productType];n&&(t.productType=i.Utils.isFunction(n.getProductType)?n.getProductType():e.productType)}return t},shouldReceiveMessage:function(e,t){return!(!e||!t)&&!(!e.productType||!e.demandSourceName)&&t.productType===e.productType&&(n(e)||t.demandSourceName===e.demandSourceName)},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===t.RV&&(e.productType=t.IS),e}}}},{}],16:[function(e,t,n){t.exports={CB:"NativeCallback",deviceDataNativeFunction:"deviceDataAPI",getDeviceData:"getDeviceData",failCallback:"handleDeviceDataFailed",successCallback:"handleDeviceDataSuccess",sdkNotSupportedErrMsg:"DeviceDataService | module not supported by SDK",notInitiatedErrMsg:"DeviceDataService | module not initiated or not supported by SDK",alreadyInitiatedErrMsg:"DeviceDataService | init | module is already initiated",intervalAlreadySet:"DeviceDataService | _startPullingDataWithInterval | interval already set",notValidInterval:"DeviceDataService | _startPullingDataWithInterval | interval is not valid, must be higher than 15 seconds",minimumIntervalAllow:5}},{}],17:[function(e,t,n){t.exports=function(n,i){var r,a,o=e("./DeviceDataConstants"),s=e("../constants/featureCompatibilityMap"),d=!1,t={},l=!1;function c(){i.callSDKFunction(o.deviceDataNativeFunction,{deviceDataFunction:o.getDeviceData},o.successCallback,o.failCallback)}function u(e){var t=e&&e.errMsg?e.errMsg:"";i.log("DeviceDataService |  getDeviceData fail, params : "+JSON.stringify(e)+"with errorMessage: "+t)}function f(e){i.log("DeviceDataService |  getDeviceData success, params :"+JSON.stringify(e)),e&&(t=e)}function p(){d?(clearInterval(r),r=void 0):i.log(o.notInitiatedErrMsg)}function g(e){if(i.log("DeviceDataService | _startPullingDataWithInterval | interval:"+e),d){var t=(n=parseInt(e),isNaN(n)?-1:n);t<o.minimumIntervalAllow?i.log(o.notValidInterval):r?i.log(o.intervalAlreadySet):r=setInterval(c,1e3*(a=t))}else i.log(o.notInitiatedErrMsg);var n}return{init:function(e){if(i.isLegacy(s.pullingNativeDeviceData))i.log(o.sdkNotSupportedErrMsg);else if(d)i.log(o.alreadyInitiatedErrMsg);else{var t=i.SupplyConfigurations.getNetworkConfigValueByKey("pullingDeviceDataInterval")||i.getConfig().controllerConfig.pullingDeviceDataInterval||-1;n.PubSub.subscribe(o.CB+"."+o.successCallback,f),n.PubSub.subscribe(o.CB+"."+o.failCallback,u),n.PubSub.subscribe(o.CB+".enterBackground",function(e){i.log("DeviceDataService | entered BG | should pause interval"),p()}),n.PubSub.subscribe(o.CB+".enterForeground",function(e){i.log("DeviceDataService | entered FG | should resume interval"),g(a)}),c(),d=!0,g(t)}},getDeviceData:function(){return d||i.log(o.notInitiatedErrMsg),t},pullData:c,startPullingDataWithInterval:g,stopPullingData:p,setPullDataOnLoadAd:function(e){e&&!l&&(l=!0)},shouldPullDataOnLoadAd:function(){return l}}}},{"../constants/featureCompatibilityMap":94,"./DeviceDataConstants":16}],18:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.AdUtils,a=null;return{set:function(e){e&&e.productType===i.BN&&a&&a.productType!==i.BN?t.trackEvent(n.setAdDisplayAlreadyAdShown,{},{productType:e.productType,generalMessage:a.productType+" | "+e.productType}):a=e},get:function(){return a||null},reset:function(){a=null},getDisplayedAdType:function(){return a?a.productType:null},getDisplayedAdDemandName:function(){return a?a.demandSourceName:null},getDisplayedAdSettings:function(){return a?a.settings:null},isDisplayed:function(){return null!==a},isAdDisplayed:function(e){return a&&e&&r.getAdId(a)===r.getAdId(e)}}}},{}],19:[function(e,t,n){t.exports=function(n){return{isEventDisabled:function(e){if(n.SupplyConfigurations.isNetworkConfigEmpty())return"noFill"===e.name;var t=n.SupplyConfigurations.getNetworkConfigValueByKey("events");return!(!t||!t.disabledEvents)&&-1!==t.disabledEvents.indexOf(e.name)}}}},{}],20:[function(e,t,n){e("../types").Ad;t.exports=function(){var a={};return{getABTestConfiguration:function(e,t){var n=a[e]&&a[e].abtest&&a[e].abtest.default,i=a[e]&&a[e].abtest&&a[e].abtest[n]||{},r=a[e]&&a[e].abtest&&a[e].abtest[t]||{};return jQuery.extend(!0,{},i,r)},setConfig:function(e){a=e||{}}}}},{"../types":180}],21:[function(require,module,exports){function ExtraOffers(constants,fetcherService,environmentConfiguration){var minimumAdsForExtraOffersInventory=constants.extraOffers.minimumAdsForExtraOffersInventory,supportedProductTypes=[constants.RV,constants.IS],supportedAdTypes=[constants.adTypes.CPVI,constants.adTypes.customEndCard,constants.adTypes.imageInterstitial];function _isEnabled(e){return!!(e&&e.extraOffers&&e.extraOffers.enabled)}function _isProductTypeSupported(e){return-1!==supportedProductTypes.indexOf(e)}function _isAdTypeSupported(e){return-1!==supportedAdTypes.indexOf(e)}function _isSupported(e,t,n,i){return!(e===constants.deviceOs.android&&t<constants.extraOffers.minimalAndroidApiLevel)&&(_isEnabled(i)&&_isProductTypeSupported(n.productType)&&_isAdTypeSupported(n.ext.type))}function _fetchExtraOffersInventory(e,t,n,i,r){var a=_buildRequiredDataForExtraOffersRequest(t,n,i,r);e=jQuery.extend(!0,{},e,a);var o=new jQuery.Deferred;return fetcherService.fetchFeed(environmentConfiguration().getConfig().schema+constants.gatewayDestinationMap.BN.production,e,constants.extraOffers.fetchTimeout).done(function(e){if(_isInvalidExtraOffersResponse(e))o.reject(e.errorCode.toString());else if(_isInventoryEligible(e))o.resolve(e);else{var t="Invalid extra offers inventory, length: "+e.seatbid.bid.length;o.reject(t)}}).fail(function(e,t){o.reject(t)}),o.promise()}function _isInvalidExtraOffersResponse(e){return!(!e||!e.hasOwnProperty("errorCode"))}function _buildRequiredDataForExtraOffersRequest(e,t,n,i){return{extraOffers:!0,currProductType:e||"",blacklistedCampaigns:t||"",currReqId:n||"",currOppId:i||""}}function _isInventoryEligible(e){return!!(e&&e.seatbid&&e.seatbid.bid&&e.seatbid.bid.length>=minimumAdsForExtraOffersInventory)}function _test(){var re=/(\(\))$/,args=[].slice.call(arguments),name=args.shift(),is_method=re.test(name),target;return name=name.replace(re,""),target=eval(name),is_method?target.apply(this,args):target}return{isSupported:_isSupported,fetchExtraOffersInventory:_fetchExtraOffersInventory,test:_test}}module.exports=ExtraOffers},{}],22:[function(e,t,n){t.exports=function(n){return{isFeatureSupportedInNativeSDK:function(e){var t=!1;return e&&n&&n.nativeFeatures&&(t=Array.isArray(n.nativeFeatures)&&-1<n.nativeFeatures.indexOf(e)),t}}}},{}],23:[function(e,t,n){t.exports=function(e,i,t){var r,a=e||"",o=t||6e4,s="Invalid API response",d=function(t){var n=!0;return jQuery.each(i,function(e){n=n&&void 0!==t[e]}),n};return{getInventory:function(e,t,n){r=new jQuery.Deferred;var i=t||a;return jQuery.ajax({url:i,data:e,type:"GET",dataType:n||"jsonp",timeout:o}).then(function(e){e&&e.errorCode&&e.errorMessage?r.reject({errorMessage:e.errorMessage,errorCode:e.errorCode}):d(e)?r.resolve(e):r.reject({errorMessage:s})},function(e,t,n){var i={errorMessage:"Error fetching inventory. Error data: "+t};r.reject(i)}),r.promise()},isValidResponseStructure:d}}},{}],24:[function(e,t,n){t.exports=function(o,s){var d,i={hit:1,miss:2,eventResult:"eventResult",resultReason:"resultReason"};function t(e){function a(e,t){var n;return e&&e.url&&(n={url:function(e,t){if(!e)return"";if(t)for(var n=t.length,i=0;i<n;i++)e=e.replace("{{"+t[i].key+"}}",encodeURIComponent(t[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}(e.url,t),type:e.type}),n}function n(e,t){var n,i,r=d[e];"object"==typeof r&&(0<r.length&&(r=r[0]),(n=a(r,t))&&(i=n,s.firePixel(i),o.log("Callback: "+JSON.stringify(i),o.LogLevels.info)))}return d=e,{track:function(e){var t;if(e&&d)switch(e.trackingType){case"request":n("requestTracking",null);break;case"responseHit":n("responseTracking",[{key:i.eventResult,value:i.hit}]);break;case"responseMiss":t=e.data,n("responseTracking",[{key:i.eventResult,value:i.miss},{key:i.resultReason,value:t}])}}}}return{init:function(e){return new t(e)}}}},{}],25:[function(e,t,n){t.exports=function(){var t=[];return{addToFilteredListCampaigns:function(e){e&&-1===t.indexOf(e)&&t.push(e)},getFilteredListCampaigns:function(){return t}}}},{}],26:[function(e,t,n){t.exports=function(i,t){function n(){var e=t("#displayedFrame");return e&&0<e.length?e:null}return{getDisplayedAdFrame:n,isFrameDisplayed:function(e){var t=n();return e&&t&&e[0]===t[0]},getAdUnitClassObj:function(e){var t="ssaAdUnit",n={class:t+" ",selector:"."+t};return e&&e.productType?(n.class+=e.productType+" ",n.selector+="."+e.productType,e.demandSourceName&&(n.class+=e.demandSourceName+" ",n.selector+="."+e.demandSourceName)):i.log("In getAdUnitClass with no ad",i.LogLevels.error),n},hideFrame:function(){var e=n();e&&e.addClass("hidden")},displayFrame:function(){var e=n();e&&e.removeClass("hidden")}}}},{}],27:[function(e,t,n){t.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],28:[function(s,e,t){e.exports=function(e,t,n){var i=s("./GDPRConstants.js"),r=!1,a=n.CB;function o(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(t.getConfig().applicationSettings.consent=e)}return{init:function(){r||(e.PubSub.subscribe(a+i.NativeAPI.updateConsentInfo,function(e){if(e&&e.gdprConsentStatus)return t.log("updateConsentInfo | controller | params: "+JSON.stringify(e),t.LogLevels.info),void o(e.gdprConsentStatus);t.log("updateConsentInfo | controller | without params or gdprConsentStatus key",t.LogLevels.info)}),r=!0)},setConsent:o,getConsent:function(){return t.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":27}],29:[function(e,t,n){function i(r,o){var e="NativeCallback",t=!1,a=[],n={GET:"GET",POST:"POST"},s={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function i(){r.PubSub.subscribe(e+".httpRequestStatusChanged",function(e){o.checkRequiredCallbackParams(["identifier","status"],e,"httpRequestStatusChanged").didSucceed&&d(e)})}function d(e){o.log("HTTPService - request status changed",o.LogLevels.verbose);var t=p(e.identifier,a);if(t)if(e.status===s.requestStarted)l(t);else if(e.status===s.responseReceived){var n={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0},i=e.data;e.data&&(i=decodeURIComponent(i)),c(t,i,n)}else u(t,e.errMsg)}function l(e){o.log("onRequestStarted "+e.identifier,o.LogLevels.verbose),r.Utils.isFunction(e.onRequestStarted)&&e.onRequestStarted()}function c(e,t,n){o.log("_onResponseReceived "+e.identifier,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onResponseReceived)&&e.onResponseReceived(t,n)}function u(e,t){o.log("onRequestError "+t,o.LogLevels.verbose),f(e),r.Utils.isFunction(e.onRequestError)&&e.onRequestError(t)}function f(e){if(e){var t=a.indexOf(e);-1<t&&a.splice(t,1)}}function p(t,e){var n=jQuery.grep(e,function(e){return e.identifier===t});return 1!==n.length?null:n[0]}function g(){return+new Date+""+Math.random()}function v(e){return(!r.Utils.isDefined(e.allowNative)||e.allowNative)&&t}function m(e,t){return jQuery.extend(t,{url:e},{identifier:g()}),r.Utils.isDefined(t.background)||(t.background=!1),t}function h(e){o.log("_sendNativeEngineRequest",o.LogLevels.verbose);var i={};jQuery.each(e,function(e,t){if(!r.Utils.isFunction(t)){var n={};n[e]=t,jQuery.extend(i,n)}}),o.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function b(i){var r;o.log("_sendWebEngineRequest",o.LogLevels.verbose);var e=i;l(i);var a=function(e,t){var n={headers:e.getAllResponseHeaders(),statusCode:e.status,ranOnNative:!1};c(i,t,n)},t=jQuery.ajax(e);t.done(function(e,t,n){var i=n.responseText;a(n,i)}),t.fail(function(e,t,n){r=n,0===e.status?u(i,r&&""!==r?r:"unknown error"):a(e)})}function S(e){a.push(e),v(e)?h(e):b(e)}function y(e,t){t||(t={}),t.type=n.GET,S(m(e,t))}function A(e,t){t||(t={}),t.type=n.POST,S(m(e,t))}function C(){return a}function D(){return t}function I(){t=!0,i()}var w={GETRequest:y,POSTRequest:A,getPendingRequests:C,getIsNativeEngineExist:D,init:I};return w}t.exports=i},{}],30:[function(e,t,n){var S=e("./containers/ContainerCreationStateHandler");t.exports=function(a,o,s,d){var l="IframeManager | ",c=a.jQuery(),u=a.AdUtils;function f(e,t,n,i){u.extendAdObjectWithConfig(t,e,n,i),a.getNotchService().onSetConfig(e)&&(b("Extend ad object isTransparentLayout=true"),e.settings.isTransparentLayout=!0),a.RingerSwitchService.isInitiated()&&(b("Extend ad object ringerMuteOnStart=true"),e.settings.ringerMuteOnStart=!0)}function p(e){var t,n=e.adViewId,i=null;return t=s.getAdUnitClassObj(e).selector,c.each(c(t),function(){return c(this).data("id")!=n||(i=c(this),!1)}),i}function g(e,t,n,i){var r,a;b("createAndLoadAdFrame"),f(e,t,n,i),a=(r=e).productType===o.OW?u.getAdId(r):u.generateUniqueAdId(r),r.adViewId=a,p(e)||function(e,t){var n=e.adViewId;b("loading ad to frame: "+n+" "+e.productType);var i=s.getAdUnitClassObj(e).class;t&&(i+="hidden "),c("<iframe />",{class:i,src:e.url}).data("id",n).data("close",!0).appendTo("body")}(e,i.preload)}function r(e){var t=!!p(e);return b("isContainerLoaded: "+t),t}function v(e){var t=c(".loaderOW");t.addClass("loaderOWFadeOut"),setTimeout(function(){b("hideLoader - enter timeOut"),c(".loaderOW").addClass("hidden"),t[0].offsetWidth=t[0].offsetWidth},600),c("#ssaLoaderWrap").addClass("hidden")}function m(e,t,n,i){v(),n(!1),d.set(t),e.removeClass("hidden").attr("id","displayedFrame"),i()}function h(e,t){e===o.OW?c(".loaderOW").removeClass("loaderOWFadeOut hidden"):c("#ssaLoaderWrap").removeClass("hidden")}function n(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}function b(e){a.log(l+e)}return{createAndLoadAdFrame:g,updateAdUnitUrl:function(e,t,n,i){var r;f(e,t,n,i),(r=p(e))?(b("updated iframe url for product "+n.productType),r[0].src=e.url):i.forceCreation?(b("cannot find iframe to update, creating new one"),g(e,t,n,i)):a.log(l+"cannot find iframe to update url")},displayAdView:function(t,e,n,i){var r=p(t);r.data("loaded")?(b("display frame"),c.when(i(t,!1)).done(function(){m(r,t,e,n)}).fail(function(e){t.showAdCallbacks&&t.showAdCallbacks.onShowFailed(e)})):(b("display frame with loader"),d.set(t),c.when(i(t,!0)).done(function(){!function(e,t,n,i){if(e.data("loaded"))return m(e,t,n,i);n(!0),a.log(l+"display with loader, frame "+e.data("id")),t&&t.productType&&(h(t.productType),e.attr("id","displayedFrame"))}(r,t,e,n)}).fail(function(e){t.showAdCallbacks&&t.showAdCallbacks.onShowFailed(e)}))},handleScreenVisible:function(e,t){e&&h(t.productType);var n=s.getDisplayedAdFrame();n&&(b("ad unit open error"),n.addClass("hidden").attr("id",""))},unloadAdView:function(n){var i=n.adViewId;b("unloading ad from frame | id:"+i+" pt: "+n.productType),c.each(c(s.getAdUnitClassObj(n).selector),function(e,t){return c(t).data("id")!==i||(n.engaged&&t.removeAttribute("id"),n.productType===o.OW?setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0):t&&t.parentNode&&t.parentNode.removeChild(t),!1)})},displayLoader:h,hideLoader:v,hideView:s.hideFrame,displayView:s.displayFrame,isContainerLoaded:r,onAdUnitLoaded:function(e,t,n){var i=p(e);if(i)if(i.data("loaded"))b("already received the loaded event for frame");else{i.data("loaded",!0);var r=s.isFrameDisplayed(i);b("ad loaded: "+a.AdUtils.getAdId(e)+" | "+r?"frame Displayed: true":"frame Displayed: false|"+s.getAdUnitClassObj(e).selector),r&&m(i,e,t,n)}},getAdViewByAd:p,sendMessageToDisplayedAdView:function(e){var t=s.getDisplayedAdFrame();t&&n(JSON.stringify(e),"*",t[0].contentWindow)},sendMessageToAllAdViews:function(e){c.each(c(".ssaAdUnit"),function(){n(JSON.stringify(e),"*",this.contentWindow)})},getDisplayedAdView:s.getDisplayedAdFrame,isViewDisplayed:s.isFrameDisplayed,getContainerID:function(){return"1"},getContainerCreationHandler:function(e){b("_getContainerCreationHandler: ");var t=new S(c,a.log),n=t.getCreationStates(),i=r(e)?n.createdSuccessfully:n.notCreated;return t.setState(i),t}}}},{"./containers/ContainerCreationStateHandler":72}],31:[function(e,t,n){t.exports=function(r){var e=[];function a(t){return function(e){return e.demandSourceName===s(t)&&e.productType===t.productType}}function n(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].counter;return t}function o(e){var t;return n(d().filter((t=e,function(e){return e&&e.productType===t})))}function t(e){var t;return n(d().filter((t=e,function(e){return e&&e.productType===t&&!0===e.isBiddingInstance})))}function s(e){return e.originalDemandSourceName||e.demandSourceName}function i(e){var t,n,i=d().filter(a(e));return 0<i.length?i[0]:(n={demandSourceName:s(t=e),productType:t.productType,isBiddingInstance:t.isInAppBidding,counter:0},d().push(n),n)}function d(){return e}return{getCountersByProduct:function(e){return{bidding:t(e),totalSessionImpressions:o(e)}},getTokenCounters:function(){return{biddingRVImpressions:t(r.RV),biddingISImpressions:t(r.IS),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)}},getPayloadCounters:function(e){return{instanceImpressions:(t=e,n=0,i=d().filter(a(t)),0<i.length&&(n=i[0].counter),n),totalRVSessionImpressions:o(r.RV),totalISSessionImpressions:o(r.IS)};var t,n,i},setInstanceImpressionsCounter:function(e){var t=i(e);t&&t.counter++}}}},{}],32:[function(e,t,n){function i(e){var t=e,r=[],i=-1;function a(){return r.length}function n(){return r}function o(e){Array.isArray(e)&&(i=0,r=e)}function s(){return r[i]}function d(e){var t,n=u(e);return-1<n&&(t=r.splice(n,1)[0])&&(p()?i=-1:i<n?i=(i+1)%a():n<i&&i--),t}function l(e){var t=u(e);if(-1<t)return r[t]}function c(e,t){var n=u(t);if(-1<n)return r[n]=e,r[n]}function u(e){if(void 0===e)return-1;for(var t=0,n=a(),i=e.toString();t<n&&e;t++)if(r[t].id===i)return t;return-1}function f(){return!p()&&(i+1)%a()!==i}function p(){return 0===a()}function g(){r=[],i=-1}var v={getOffers:n,getCurrentOffer:s,getOfferById:l,setOffers:o,removeOfferById:d,replaceOfferById:c,isNextOfferAvailable:f,isEmpty:p,size:a,reset:g};return v}t.exports=i},{}],33:[function(e,t,n){t.exports=function(e,t){var i,r;function a(e){return r&&e===t.IS}return{setLastDisplayedAdCampaignId:function(e,t,n){r=n&&n.sendLastCampaignId,a(t)&&(i=e)},getLastDisplayedAdCampaignId:function(){return i},shouldAddLastDisplayedAdCampaignIdToPayload:a}}},{}],34:[function(e,t,n){function i(a){var o,s,d,l,c,u,r={none:0,error:1,info:2,verbose:3},f={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function p(e,t){var n=a.isDefined(e)?e:"Controller",i=a.isDefined(t)?f[t]:f[d];return d?"SupersonicAds "+n+" ["+i+"] :":""}return{init:function(e,t,n,i){c=window.console||{},o=e,l=t,u=i,(d=n)?(s=c.log,c.log=function(e){this.log(e,r.verbose)}):c.log=function(){}},log:function(e,t,n){var i,r;(window.productionDebug&&u&&u({url:"http://iron-debug-controller.com?log="+e,type:"pixel"}),t&&d<t)||(a.isString(e)||(e=JSON.stringify(e)),a.isFunction(s)&&"android"===o?s.call(c,p(n,t)+e):"android"!==o&&(i=p(n,t)+e,(r={eventName:"log",prefix:"logmessage"}).parameters={message:i,acknowledgeWith:"acknowledgeMessage",declineWith:"errorTest"},l&&l.postMessage(r)))},debugMsg:p,LogLevels:r,DebugLevels:f}}var r;t.exports=function(e){return r||(r=new i(e)),r}},{}],35:[function(e,t,n){function i(){var e,t={init:function(t,n,e){return this.receiveMessage(function(e){n.call(t,e)},e),this},postMessage:function(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(t,n){t&&(e=function(e){"string"==typeof n&&e.origin!==n||"[object Function]"===Object.prototype.toString.call(n)&&!1===n(e.origin)||("function"!=typeof n||n(e.data))&&t(e)}),window.addEventListener?window[t?"addEventListener":"removeEventListener"]("message",e,!1):window[t?"attachEvent":"detachEvent"]("onmessage",e)}};return t}t.exports=i},{}],36:[function(O,e,t){function n(){var e=O("./Inventory.js"),r={},t=[],n,i;function a(){i=4}function o(){if(C())return Math.max(1,n-1)}function s(){if(0!==Object.keys(r).length)return r[o()]}function d(e){return C()&&D()?e?r[e].size():r[o()].size():0}function l(e){return C()&&D()?e?r[e].getOffers():r[o()].getOffers():[]}function c(){Array.isArray(t)&&t.length>i&&delete r[t.shift()]}function u(e,t){if(Array.isArray(e)&&0!==e.length){var n=void 0!==t?t:A();void 0===r[n]&&(n=A());for(var i=0;i<e.length;i++)e[i].inventoryId=n;return r[n].setOffers(e),n}}function f(e){if(C()&&D())return e?r[e].getCurrentOffer():r[o()].getCurrentOffer()}function p(e,t){if(C()&&D())return t?r[t].removeOfferById(e):r[o()].removeOfferById(e)}function g(e,t){if(C()&&D())return t?r[t].getOfferById(e):r[o()].getOfferById(e)}function v(e,t,n){if(C()&&D())return n?r[n].replaceOfferById(e,t):r[o()].replaceOfferById(e,t)}function m(e){return!(!C()||!D())&&(e?r[e].isNextOfferAvailable():r[o()].isNextOfferAvailable())}function h(e){return!C()||!D()||(e?r[e].isEmpty():r[o()].isEmpty())}function b(){t=[],r={},n=void 0}function S(e){var t=void 0!==e?e:o();t&&r[t]&&delete r[t]}function y(){return r}function A(){return r[n=n||1]=new e(n),t.push(n),n++,c(),n-1}function C(){return 0!==t.length&&void 0!==n}function D(){return void 0!==r[o()]}function I(){return i}function w(){return n}a();var P={getOffers:l,getCurrentOffer:f,getOfferById:g,setOffers:u,removeOfferById:p,replaceOfferById:v,isNextOfferAvailable:m,isEmpty:h,size:d,reset:b,getActiveInventoryId:o,getActiveInventory:s,removeInventory:S,getInventories:y,getAmountOfInventoriesAllowed:I,getAvailableInventoryId:w};return P}e.exports=n},{"./Inventory.js":32}],37:[function(e,t,n){t.exports=function(l,c,u,f){var p={successCallbackPrefix:"scallback_",failureCallbackPrefix:"fcallback_",ssaSchemePrefix:"supersonicads",acknowledgeMessage:"acknowledgeMessage",CB:"NativeCallback"};function d(e,t,n,i){if(c.Utils.isString(e)&&""!==e&&l){l.DemandUtils&&l.RewardedVideo&&t&&(t=l.DemandUtils.setManualRewardedVideoTypeForNative(t));var r=c.Utils.isDefined(n)&&c.Utils.isString(n)?n:"",a=c.Utils.isDefined(i)&&c.Utils.isString(i)?i:"";(o={eventName:e,parameters:f.extend({success:r,fail:a},t)}).prefix=p.ssaSchemePrefix,c.Utils.isDefined(o.parameters)||(o.parameters={}),f.extend(o.parameters,{acknowledgeWith:c.Utils.isDefined(s)?s:p.acknowledgeMessage,declineWith:c.Utils.isDefined(d)?d:"errorTest"}),u.postMessage(o)}var o,s,d}function g(){return Date.now()+""+Math.random()}return{callSDKFunction:d,callSDKService:function(e,t,n,i,r){n&&(n.functionName=t),d(e,n,i,r)},callSDKFunctionWithCallback:function(t,e,n,i){if(l.log("NativeAPIAdapter | _callSDKFunctionWithCallback | Native API: "+t),c.Utils.isFunction(n)||c.Utils.isFunction(i)){var r=p.successCallbackPrefix+g(),a=p.failureCallbackPrefix+g(),o=c.PubSub.subscribe(p.CB+"."+r,function(e){c.PubSub.unsubscribe(o),c.PubSub.unsubscribe(s),n(e)}),s=c.PubSub.subscribe(p.CB+"."+a,function(e){l.log("NativeAPIAdapter | callSDKFunctionWithCallback | received failure callback for function: "+a),e&&e.errMsg&&l.log("Error calling "+t,l.LogLevels.error),c.PubSub.unsubscribe(s),c.PubSub.unsubscribe(o),i(e)});d(t,e,r,a)}else l.log("NativeAPIAdapter | failed to call sdk function - no callbacks parameters")},acknowledgeMessage:function(e){u.acknowledgeMessage(e)}}}},{}],38:[function(e,t,n){t.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onResume:"onResume",onPause:"onPause",onStop:"onStop",onDestroy:"onDestroy"}}},{}],39:[function(c,e,t){e.exports=function(e,i,t){var r="LifeCycleEventsService | ",n=c("./NativeLifeCycleEventsConstants.js"),a=i.jQuery(),o=[],s=new(c("./AndroidLifeCycleEventHandlers.js"))(e,i,t);function d(){e.PubSub.subscribe(n.CB+"."+n.NativeAPI.onNativeLifeCycleEvent,function(e){var t,n;i.log(r+"received new event: "+JSON.stringify(e)),e&&(t=e.lifeCycleEvent,n=e,l(t)&&s.publishEvent(t,n))})}function l(e){return e&&-1<a.inArray(e,o)}return{init:function(){d()},startNotify:function(e){i.log(r+"startNotify | event: "+e),l(e)||o.push(e)},stopNotify:function(e){i.log(r+"stopNotify | event: "+e),l(e)&&o.splice(a.inArray(e,o),1)}}}},{"./AndroidLifeCycleEventHandlers.js":7,"./NativeLifeCycleEventsConstants.js":38}],40:[function(r,e,t){e.exports=function(n,i){return{create:function(e){var t=e.deviceOs;return t===i.deviceOs.ios&&null===e.safeAreaInsets?new(r("../patches/PatchesIphoneX.js"))(n,e,i):new(r("./NotchService.js"))(n,e.safeAreaInsets,i,t)}}}},{"../patches/PatchesIphoneX.js":175,"./NotchService.js":41}],41:[function(e,t,n){t.exports=function(e,t,n,i){var r=!1;function a(){return i!==n.deviceOs.android&&r}return function(){if(i!==n.deviceOs.android){var e=n.notchSettings.safeAreaInsetsMin;r=t.top>e||t.bottom>e||t.right>e||t.left>e}}(),{hasNotch:a,onEngageEnd:function(){i!==n.deviceOs.android&&a()},onSetConfig:function(e){return i!==n.deviceOs.android&&a()&&(t=e).settings&&t.settings.standaloneView;var t},className:"NotchService"}}},{}],42:[function(e,t,n){t.exports={omidControllerFunction:"omidAPIController",omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",getOmidDataSuccessKey:"omidGetDataSuccess",getOmidDataFailKey:"omidGetDataFail",startSession:"startSession",finishSession:"finishSession",impressionOccurred:"impressionOccurred",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidAdIdNotFound:" omidParams no contain adViewId. ",omidPromiseIsPending:"promise is still pending",omidStartSessionAlreadyStarted:"omid ad session is already started",omidSessionNotStarted:"session not started",omidProductTypeNotSupported:" omidParams container unsupported product type = ",omidproductTypeNotFound:" omidParams no contain product type. ",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0","1.3.12-Ironsrc":"1.3.12",default:"1.0.0"},omidVersionRequiresWebviewPerAd:{"1.2.22-Ironsrc":!1,"1.3.12-Ironsrc":!0,default:!1},omidVersionIsControllerDownloadOMSDK:{"1.2.22-Ironsrc":!0,"1.3.12-Ironsrc":!1,default:!1}}},{}],43:[function(T,e,t){T("./OMIDConstants");e.exports=function(d,l,c){var r,e=T("./OmidHelper"),u=T("./OmidAdSession"),f=new e(d,l,c),a=T("./Constants.js"),p=T("./OMIDConstants"),g=!1,v="",o=a.omidPartnerVersion,s="",t=null,m=null,i=null,h={};function n(){if(!g){if(m&&"pending"===m.state())return m;m=new c.Deferred,l.log("OMIDService - activate",l.LogLevels.verbose);var n=d.PubSub.subscribe(a.CB+"."+p.activateSuccessKey,function(e){var t;v=e&&e.omidVersion?e.omidVersion:"",o=e&&e.omidPartnerVersion?e.omidPartnerVersion:a.omidPartnerVersion,g=!0,d.PubSub.clearHandlers([n,i]),d.PubSub.subscribe("SDKController.OMIDStartSession",function(e){!f.isSupportingMultipleAdSession()&&e.adViewId&&(e.webViewid=e.adViewId),function(e){f.fireNonFailureEvent("SDKController.onOmidStartSessionRequired",e,v);var t=new c.Deferred,n=f.isActivated(A(),g,p.startSession,v);if(!n.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[n.reason]),t.reject(n.reason);var i=f.validateStartSessionParams(e,v);if(!i.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason);var r=f.validateAdViewId(e,p.impressionOccurred,v);if(!r.result)return this.core.PubSub.publish("SDKController.onOmidServiceFailure",[r.reason]),t.reject(r.reason);var a=e&&e.adViewId,o=h[a],s="";o&&"pending"===o.getStartPromise().state()?(s=f.getErrorMsgPromiseIsPending(p.startSession,v,e),d.PubSub.publish("SDKController.onOmidServiceFailure",[s]),o.getStartPromise()):o&&o.isSessionStarted()?(s=f.getErrorStartSessionAlreadyStarted(p.startSession,v,e),d.PubSub.publish("SDKController.onOmidServiceFailure",[s]),d.Utils.returnRejectedPromise(s)):function(e,t,n,i){l.log("OMIDService - startSession",l.LogLevels.verbose);var r=new u(d,l,c,t,e);!f.isSupportingMultipleAdSession()&&i.webViewid&&(r.setWebViewId(i.webViewid),i.adViewId=r.webViewId),(h[e]=r).setStartPromise(n),l.callSDKFunction(p.omidNativeFunction,{omidFunction:p.startSession,omidParams:i},p.startSessionSuccessKey,p.startSessionFailKey),r.getStartPromise()}(a,e.productType,t,e)}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe("SDKController.OMIDImpressionOccurred",function(e){!function(e){var t=new c.Deferred,n=f.isActivated(A(),g,p.impressionOccurred,v);if(!n.result)return t.reject(n.reason);var i=S(e,p.impressionOccurred,v);if(!i.adSession)return d.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason);var r=i.adSession;if(r.getImpressionPromise()&&"pending"===r.getImpressionPromise().state()){var a=f.getErrorMsgPromiseIsPending(p.impressionOccurred,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[a]),r.getImpressionPromise()}r.setImpressionPromise(t),l.callSDKFunction(p.omidNativeFunction,{omidFunction:p.impressionOccurred,omidParams:e},p.impressionOccurredSuccessKey,p.impressionOccurredFailKey),r.getImpressionPromise()}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe("SDKController.OMIDFinishSession",function(e){b(e=f.setAdViewIdForOldOmidVersions(e,v))}),t=C(v),s=r.getExternalLibrariesUrl()+p.omidServiceName+"/"+t+"/"+p.omidServiceName+p.omidBundleFileType,l.log(p.omidNativeFunction+" activate success: "+JSON.stringify(e),l.LogLevels.verbose),m.resolve()}),i=d.PubSub.subscribe(a.CB+"."+p.activateFailKey,function(e){d.PubSub.clearHandlers([n,i]);var t=e&&e.errMsg?e.errMsg:"";l.log(p.omidNativeFunction+" activate session fail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.publish("SDKController.onOmidServiceFailure",[t]),m.reject()});return l.callSDKFunction(p.omidNativeFunction,{omidFunction:"activate",omidParams:{}},p.activateSuccessKey,p.activateFailKey),m.promise()}l.log("OMIDService - activate OMID is already initialized",l.LogLevels.verbose)}function b(e){f.fireNonFailureEvent("SDKController.onOmidFinishSessionRequired",e,v),l.log("OMIDService - finishSession",l.LogLevels.verbose);var t=new c.Deferred,n=f.isActivated(A(),g,p.finishSession,v);if(!n.result)return t.reject(n.reason),t;var i=S(e,p.finishSession,v);if(!i.adSession)return d.PubSub.publish("SDKController.onOmidServiceFailure",[i.reason]),t.reject(i.reason),t;var r=i.adSession;if(!r.isSessionStarted()){var a=f.getErrorMsgSessionNotStarted(p.finishSession,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[a]),t.reject(a),t}if(r.getFinishPromise()&&"pending"===r.getFinishPromise().state()){var o=f.getErrorMsgPromiseIsPending(p.finishSession,v,e);return d.PubSub.publish("SDKController.onOmidServiceFailure",[o]),r.getFinishPromise()}return r.setFinishPromise(t),l.callSDKFunction(p.omidNativeFunction,{omidFunction:p.finishSession,omidParams:e},p.finishSessionSuccessKey,p.finishSessionFailKey),r.getFinishPromise()}function S(e,t,n){var i=f.validateAdViewId(e,p.impressionOccurred,n);if(!i.result)return{reason:i.reason};var r=e.adViewId,a=h[r];return a?{adSession:a,reason:null}:{reason:"adSession not found for adViewId = "+r}}function y(){return p.omidVersionIsControllerDownloadOMSDK[v]?p.omidVersionIsControllerDownloadOMSDK[v]:p.omidVersionIsControllerDownloadOMSDK[p.omidBundleDefaultVersionKey]}function A(){return!y()||window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function C(e){var t=p.omidVersionMapping[e];return t||(t=p.omidVersionMapping[p.omidBundleDefaultVersionKey],l.log("OMID.Service.Warnnig: version from mapping not found .choose.default - "+t)),t}function D(){return g?s:""}function I(){d.PubSub.subscribe(a.CB+"."+p.startSessionSuccessKey,function(e){!function(e){if(h[e.adViewId]){var t=h[e.adViewId];t.getStartPromise().resolve(),l.log(p.omidNativeFunction+" Start session success | adViewId = "+t.adViewId,l.LogLevels.verbose),f.fireNonFailureEvent("SDKController.onOmidStartSessionSuccess",t.getDescription(),v)}else l.log("Error: missing adViewId in start session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+p.startSessionFailKey,function(e){!function(e){if(e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=e&&e.errMsg?e.errMsg:"";h[e.adViewId].getStartPromise().reject(t),O(),l.log(p.omidNativeFunction+" Start session fail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.publish("SDKController.onOmidServiceFailure",[t])}else l.log("Error: missing adViewId in start session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+p.impressionOccurredSuccessKey,function(e){var t;e=f.setAdViewIdForOldOmidVersions(e,v),t=e,l.log(p.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(t),l.LogLevels.verbose),t.adViewId||(t.adViewId="1"),h[t.adViewId]?h[t.adViewId].getImpressionPromise().resolve():l.log("Error: missing adViewId in impression Occurred success session callback")}),d.PubSub.subscribe(a.CB+"."+p.impressionOccurredFailKey,function(e){!function(e){l.log(p.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),l.LogLevels.verbose);var t=e&&e.errMsg?e.errMsg:"";d.PubSub.publish("SDKController.onOmidServiceFailure",[t]),e.adViewId||(e.adViewId="1"),h[e.adViewId]?h[e.adViewId].getImpressionPromise().reject():l.log("Error: missing adViewId in impression Occurred fail session callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+p.finishSessionSuccessKey,function(e){!function(e){if(l.log(p.omidNativeFunction+" Finish session success: "+JSON.stringify(e),l.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=h[e.adViewId];t.getFinishPromise().resolve(),f.fireNonFailureEvent("SDKController.onOmidFinishSessionSuccess",t.getDescription(),v),delete h[t.adViewId]}else l.log("Error: missing adViewId in finish session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))}),d.PubSub.subscribe(a.CB+"."+p.finishSessionFailKey,function(e){!function(e){if(l.log(p.omidNativeFunction+" Finish session fail: "+JSON.stringify(e),l.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=h[e.adViewId];O();var n=e&&e.errMsg?e.errMsg:"";d.PubSub.publish("SDKController.onOmidServiceFailure",[n]),t.getFinishPromise().reject(n),delete h[t.adViewId]}else l.log("Error: missing adViewId in finish session success callback")}(e=f.setAdViewIdForOldOmidVersions(e,v))})}function w(){l.log("SDKController.onLoadSuccessOmidBundle"),window.OmidDaemon&&window.OmidDaemon.start({partnerName:p.omidPartnerName,partnerVersion:o})}function P(){l.log("SDKController.onLoadFailureOmidBundle"),d.PubSub.publish("SDKController.onOmidServiceFailure",[p.omidFailedToLoadBundleMessage])}function O(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,t){return(n=e)&&n.omidEnabled;var n},isNativeServiceActivated:function(){return g},getVersionData:function(){return{omidVersion:v,omidPartnerVersion:o}},finishSession:function(e){e=f.setAdViewIdForOldOmidVersions(e,v);var t=c.Deferred();return h[e.adViewId]?b(e).then(function(){t.resolve(!0)}).fail(t.reject):t.resolve(!1),t.promise()},isAdOmidSupported:function(e,t){return!!((n=e)&&n.ext&&n.ext.ivt&&n.ext.ivt.omid)&&f.isProductSupported(e.productType||t);var n},downloadOmidJsBundle:function(){if(!g)return d.Utils.returnResolvedPromise();if(y()&&A())return d.Utils.returnResolvedPromise();if(t&&"rejected"!==t.state())return t;t=new c.Deferred;var e=D();return l.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(p.omidServiceName,e,C(v)).then(l.libsManager.manageDownloadLibsFileByFiletype.bind(null,p.omidServiceName)).then(function(){!function(){var e=r.getCacheLibsPath()+p.omidServiceName+p.omidBundleFileType,t=y();if(A()||!o||!t)return d.Utils.returnResolvedPromise();d.Utils.getScript(e,w,P)}(),t.resolve()},function(){d.PubSub.publish("SDKController.onOmidServiceFailure",[p.omidFailedToDownloadMessage]),t.reject()}),d.Utils.returnResolvedPromise()},init:function(e){r=e,I(),n()},getOmidBundleUrl:D,getOmidData:function(){if(i=new c.Deferred,!g)return l.log("cannot get omid data beacuse omid service not activated"),i.reject(),i;var t=d.PubSub.subscribe(a.CB+"."+p.getOmidDataSuccessKey,function(e){d.PubSub.clearHandlers([t,n]),i.resolve(e)}),n=d.PubSub.subscribe(a.CB+"."+p.getOmidDataFailKey,function(e){l.log("_onGetOmidDataFail: "+JSON.stringify(e),l.LogLevels.verbose),d.PubSub.clearHandlers([t,n]),i.reject()});return l.callSDKFunction(p.omidNativeFunction,{omidFunction:"getOmidData",omidParams:{}},p.getOmidDataSuccessKey,p.getOmidDataFailKey),i.promise()}}}},{"./Constants.js":14,"./OMIDConstants":42,"./OmidAdSession":45,"./OmidHelper":46}],44:[function(e,t,n){t.exports=function(){var i,r={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},a={};return{init:function(e,t){if((a=jQuery.extend(r,e)).adData&&""!==a.adData){var n=a.src.replace("{{url}}",a.url);(i=jQuery("<iframe />",{id:a.id,class:a.templateClass,src:n,scrolling:a.scrolling,frameborder:a.frameBorder}).css(a.style)).on("load",function(){t(i)}),document.documentElement.appendChild(i[0])}},removeIframe:function(e){if(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}}}},{}],45:[function(e,t,n){var i=function(){function e(e,t,n,i,r){void 0===i&&(i=""),void 0===r&&(r="1"),this.core=e,this.controller=t,this.jQuery=n,this.productType=i,this.adViewId=r,this.startPromise=null,this.finishPromise=null,this.impressionPromise=null,this.webViewId=""}return e.prototype.setWebViewId=function(e){this.webViewId=e},e.prototype.setStartPromise=function(e){this.startPromise=e},e.prototype.setImpressionPromise=function(e){this.impressionPromise=e},e.prototype.setFinishPromise=function(e){this.finishPromise=e},e.prototype.getImpressionPromise=function(){return this.impressionPromise},e.prototype.getFinishPromise=function(){return this.finishPromise},e.prototype.isSessionStarted=function(){return this.startPromise&&"resolved"===this.startPromise.state()},e.prototype.isSessionFinished=function(){return this.finishPromise&&"resolved"===this.finishPromise.state()},e.prototype.getStartPromise=function(){return this.startPromise},e.prototype.getDescription=function(){return{productType:this.productType,adViewId:this.adViewId}},e}();t.exports=i},{}],46:[function(e,t,n){var i=e("./Constants.js"),a=e("./OMIDConstants"),r=e("../constants/SDKFeatureNames"),o=function(){function e(e,t,n){this.core=e,this.controller=t,this.jQuery=n}return e.prototype.validateStartSessionParams=function(e,t){var n={result:!0};return e.adType||(n={result:!1,reason:a.omidControllerFunction+" | "+a.omidFailureInStartSession+" | "+a.omidproductTypeNotFound+" | omidVersion= "+t}),this.isProductSupported(e.adType)||(n={result:!1,reason:a.omidControllerFunction+" | "+a.omidFailureInStartSession+" | "+a.omidProductTypeNotSupported+e.adType+" | omidVersion= "+t}),n},e.prototype.setAdViewIdForOldOmidVersions=function(e,t){return this.isSupportingMultipleAdSession()||((e=e||{}).adViewId="1"),e},e.prototype.isSupportingMultipleAdSession=function(){return this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(r.bannersOpenMeasurement)},e.prototype.validateAdViewId=function(e,t,n){var i={result:!0};if(!e||!e.adViewId){var r=this.getFlowMsg(t);i={result:!1,reason:a.omidControllerFunction+" | "+r+" | "+a.omidAdIdNotFound+" | omidVersion= "+n}}return i},e.prototype.getFlowMsg=function(e){var t,n=((t={})[a.startSession]=a.omidFailureInStartSession,t[a.finishSession]=a.omidFailureInFinishSession,t[a.impressionOccurred]=a.omidFailureInImpressionOccurred,t.default="unknown flow: ",t);return n[e]||n.default+e},e.prototype.getErrorStartSessionAlreadyStarted=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidStartSessionAlreadyStarted+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.getErrorMsgPromiseIsPending=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidPromiseIsPending+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.getErrorMsgSessionNotStarted=function(e,t,n){return a.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+a.omidSessionNotStarted+" | omidVersion= "+t+" | productType= "+n.productType||""},e.prototype.isActivated=function(e,t,n,i){var r={result:!0};e&&t||(r={result:!1,reason:a.omidControllerFunction+" | "+this.getFlowMsg(n)+" |  didLoadOMSDKService "+e+" omidServiceActivated "+t+" | omidVersion= "+i});return r},e.prototype.fireNonFailureEvent=function(e,t,n){var i="adViewId= "+(a.omidVersionRequiresWebviewPerAd[n]?"1":t.adViewId||"")+" | productType= "+(t.productType||"");this.core.PubSub.publish(e,[i])},e.prototype.isProductSupported=function(e){return!!e&&(e!==i.BN||this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(r.bannersOpenMeasurement))},e}();t.exports=o},{"../constants/SDKFeatureNames":93,"./Constants.js":14,"./OMIDConstants":42}],47:[function(e,t,n){t.exports=function(o){var s=e("./Constants.js");return{open:function(e){if(e&&e.type){if("openUrl"!==e.type)return!1;var t,n=e.callback;e.method||(o.getApiData({deviceOs:1}).deviceOs===s.deviceOs.ios?e.appId?e.method=s.openUrlMethods.storeKit:e.method=s.openUrlMethods.external_browser:e.method=s.openUrlMethods.store);var i=(r=e,(a={default:{}})[s.openUrlMethods.storeKit]={appId:r.appId,viewUniqueId:o.StoreKitService.getViewUniqueId(r)},a[s.openUrlMethods.external_browser]={},a[s.openUrlMethods.store]={},a[s.openUrlMethods.webview]={controls:!0},a[r.method]||a.default);return t=jQuery.extend({url:e.url,method:e.method},i),o.openUrl(t,n),!0}var r,a;return!1},openForOW:function(e){if(e&&e.type&&"openUrl"===e.type){var t={},n=e.callback;return t=e.externalBrowser?{url:e.url,controls:!0,method:"external_browser"}:e.method===s.openUrlMethods.external_browser?{url:e.url,method:"external_browser"}:e.install?"ios"===o.getApiData({deviceOs:1}).deviceOs?{url:e.url,controls:!0,method:"external_browser"}:{url:e.url,controls:!0,method:"store"}:{url:e.url,controls:!0,method:"webview"},o.openUrl(t,n),!0}return!1}}}},{"./Constants.js":14}],48:[function(e,t,n){t.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},eventicsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],49:[function(e,t,n){t.exports=function(a,t,o){var n,s=e("./OrientationConstants.js"),i=!1,d=o.CB;function r(e){t.log("_setAppOrientation | send orientation: "+e,t.LogLevels.info),t.callSDKFunction(s.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e){i||(a.PubSub.subscribe(d+"."+s.NativeAPI.successCallback,function(e){n.trackEvent(s.eventicsCategories.successCallback),e||(t.log("getAppOrientationData | Orientation data structure not exist.",t.LogLevels.info),n.trackEvent(s.eventicsCategories.failCallback))}),a.PubSub.subscribe(d+"."+s.NativeAPI.failCallback,function(e){t.log("getAppOrientationData failed, errorMsg:"+e.errMsg,t.LogLevels.info),n.trackEvent(s.eventicsCategories.failCallback)}),a.PubSub.subscribe("AppOrientationManager.appOrientationChanged",function(e){e&&e.appOrientation&&(t.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,t.LogLevels.info),r(e.appOrientation))}),n=e,i=!0)},getAppOrientationData:function(){t.callSDKFunction(s.ControllerNativeAPI.getAppOrientationData,{},s.NativeAPI.successCallback,s.NativeAPI.failCallback)},setOrientation:function(e){t.callSDKFunction(s.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var n=new jQuery.Deferred,i=a.PubSub.subscribe(d+"."+s.NativeAPI.oldApiSuccessCallback,function(e){if(a.PubSub.unsubscribe(i),"resolved"!==n.state()){clearTimeout(r);var t=e&&e.orientation||o.appInfo.orientation.portrait;n.resolve(t)}}),r=setTimeout(function(){n.resolve(o.appInfo.orientation.portrait)},2e3);return t.callSDKFunction(s.ControllerNativeAPI.oldGetOrientation,null,s.NativeAPI.oldApiSuccessCallback,s.NativeAPI.oldApiSuccessCallback),n.promise()},setAppOrientation:r}}},{"./OrientationConstants.js":48}],50:[function(e,t,n){t.exports=function(){var a=e("./OrientationConstants.js");function o(e){var t=parseInt(e.replace(/^"|"$/g,"")),n=[],i=t.toString(2);if(i.length>Object.keys(a.iosOrientations).length+1||"0"!==i.substr(i.length-1,1))return[];for(var r in a.iosOrientations)(t|r)===t&&n.push(a.iosOrientations[r]);return n}var t=function(t,e){return e.some(function(e){return 0<=t.indexOf(e)})};return{convertOrientationsArrayToNumber:function(e){var i=0;return e.forEach(function(e){var t,n;i+=Number((t=a.iosOrientations,n=e,Object.keys(t).filter(function(e){return t[e]===n})))}),i},convertNumberToOrientations:o,isContainPortrait:function(e){return t(o(e),[a.iosOrientations[2],a.iosOrientations[4]])},isContainLandscape:function(e){return t(o(e),[a.iosOrientations[8],a.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,t){var n=o(e),i=o(t),r=n.filter(function(e){return-1<i.indexOf(e)});return r||(r=[]),r}}}},{"./OrientationConstants.js":48}],51:[function(e,t,n){t.exports=function(r,a){var i,o=e("./Constants.js"),s=e("./PermissionsConstants.js"),d=s.nativeFunction,l={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,t=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsSuccess,function(e){a.log(s.handleGetPermissionsSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(t),r.PubSub.unsubscribe(n),i.resolve(e)}),n=r.PubSub.subscribe(o.CB+"."+s.handleGetPermissionsFailure,function(e){a.log(s.handleGetPermissionsFailure+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(t),i.reject(e)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.getPermissions,functionParams:(e=a.getConfig().mobileSDKSettings.deviceOs===o.deviceOs.ios?o.deviceOs.ios:o.deviceOs.android,{permissions:s.supportedPermissions[e]})},s.handleGetPermissionsSuccess,s.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(l[e]&&"pending"===l[e].status)return l[e];l[e]=new jQuery.Deferred;var n=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedSuccess,function(e){if(e&&e.permission){var t=e.permission;l[t]?(a.log(s.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),r.PubSub.unsubscribe(n),r.PubSub.unsubscribe(i),l[t].resolve(e)):a.log("Unrecognised permission name "+t,a.LogLevels.error)}}),i=r.PubSub.subscribe(o.CB+"."+s.handleIsPermissionGrantedFailure,function(e){if(e&&e.permission){a.log(d+s.NativeAPI.isPermissionGranted+JSON.stringify(e),a.LogLevels.verbose);var t=e.permission;l[t]?(r.PubSub.unsubscribe(i),r.PubSub.unsubscribe(n),l[t].reject(e)):a.log("Unrecognised permission name "+t,a.LogLevels.error)}else e&&e.errMsg&&a.log("Error calling isPermissionGranted "+e.errMsg,a.LogLevels.error)});return a.callSDKFunction(s.nativeFunction,{functionName:s.NativeAPI.isPermissionGranted,functionParams:{permission:e}},s.handleIsPermissionGrantedSuccess,s.handleIsPermissionGrantedFailure),l[e].promise()}}}},{"./Constants.js":14,"./PermissionsConstants.js":52}],52:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],53:[function(e,t,n){t.exports=function(n){return{firePixel:function(e){if(void 0!==e.url&&""!==e.url){if("pixel"===e.type){var t=new Image;""===e.at||isNaN(parseInt(e.at))?t.src=e.url:(t.src=e.url,t.time=e.at)}}else n.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),n.LogLevels.info)}}}},{}],54:[function(e,t,n){function i(r){var a={},n,o,e={init:function(){o=jQuery,n=this},publish:function(t,e){o=o||jQuery;try{var n=o.extend(!0,[],a[t]);o.each(n,function(){this.apply(o,e||[])})}catch(e){if(r.Utils.isDefined(e)){r.log({type:"in PubSub "+t,data:e.message,trace:e.stack});var i={name:e.name,message:e.stack};window.onerror(e.name+": "+e.message,null,null,null,i)}}},subscribe:function(e,t){return a[e]||(a[e]=[]),a[e].push(t),[e,t]},unsubscribe:function(t){if(t){var n=t[0];a[n]&&o.each(a[n],function(e){a[n][e]===t[1]&&a[n].splice(e,1)})}},subscribeOnce:function(e,t){var n=this,i=this.subscribe(e,function(){t(),n.unsubscribe(i)})},clearHandlers:function(e){jQuery.each(e,function(e,t){n.unsubscribe(t)})}};return e}t.exports=i},{}],55:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},eventicsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],56:[function(e,t,n){t.exports=function(t,n){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,d=!1,l=1e3,c=!1;function u(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:e})}return{init:function(){var e;d||(t.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,function(e){e&&(s=e.ringerSwitchSilent,c&&!s?r=setTimeout(function(){u(s)},i):(r&&clearTimeout(r),u(s)))}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,function(e){n.log("Ringer | start detecting function performed successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.startListenerFail),e&&n.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,function(e){n.log("Ringer stop detecting successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,function(e){a.trackEvent(o.eventicsCategories.stopListenerFail),e&&n.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,function(e){n.log("Ringer prepare detector successfully.",n.LogLevels.info)}),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,function(e){a.trackEvent(o.eventicsCategories.initFail),e&&n.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)}),n.log("Ringer | calling init native function",n.LogLevels.info),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),e={productChance:(n.getEnv(),1),baseData:{}},a=t.Eventics.createEventic(e,n.EventsManager),d=!0)},startListener:function(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:s}),c=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||l,n.log("Ringer | Set listener config to should delay?"+c+", with delay "+i,n.LogLevels.verbose),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){c=!1,i=l,n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return d}}}},{"./RingerSwitchConstants.js":55}],57:[function(e,t,n){t.exports=function(s,r,d){var a=e("../storeKit/SKANModel")(),l=e("../storeKit/SKANConstants"),o=e("../../constants/SDKFeatureNames");function c(e){if(!r.isIOS())return!1;var t,n=parseFloat(r.getConfig().mobileSDKSettings.deviceOSVersion)>=l.SKAdImpression.minimalSupportedIOSVersion,i=r.CompatibilityService.isFeatureSupportedInNativeSDK(o.SKAdImpression);return!!(n&&i&&(t=e).ext&&t.ext.SKANData&&t.ext.SKANData.VTA)}function u(e,t,n,i){r.callSDKService(l.SKAdImpression.jsInterface,e,{impressionData:a.extractDataForSKAdImpression(t)},n,i)}return{startImpression:function(e,t,n){if(e&&c(e)){var i=e.adViewId||Date.now(),r=l.SKAdImpression.startImpressionSuccess+"."+i,a=l.SKAdImpression.startImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n(e)})),u(l.SKAdImpression.startImpression,e,r,a)}},endImpression:function(e,t,n){if(e&&c(e)){var i=e.adViewId||Date.now(),r=l.SKAdImpression.endImpressionSuccess+"."+i,a=l.SKAdImpression.endImpressionFailed+"."+i,o=[];o.push(s.PubSub.subscribe(d.CB+"."+r,function(){s.PubSub.clearHandlers(o),s.Utils.isFunction(t)&&t()})),o.push(s.PubSub.subscribe(d.CB+"."+a,function(e){s.PubSub.clearHandlers(o),s.Utils.isFunction(n)&&n(e)})),u(l.SKAdImpression.endImpression,e,r,a)}}}}},{"../../constants/SDKFeatureNames":93,"../storeKit/SKANConstants":86,"../storeKit/SKANModel":87}],58:[function(e,t,n){var S=e("./SKOverlayConstants"),y=S.configKeys;t.exports=function(e,t,n,i,r,a,o,s){if(e&&t){var d,l=e,c=t,u=n||S.position.bottom,f=r||{},p=!!i,g=a||((d={})[S.delayConfigKeys.initialDelay]=0,d[S.delayConfigKeys.subsequentDelay]=0,d),v=o||S.flow.presentOnSKClose,m=s||"",h=null,b=null;return{getOverlayId:function(){return l},getAdvertisedAppId:function(){return c},getConfigObjectForSDK:function(){var e={};return e[y.overlayId]=l,e[y.advertisedAppId]=c,e[y.position]=u,e[y.userDismissible]=p,e[y.SKANData]=f,e[y.customProductPage]=m,e},isQualityClickTriggered:function(){return h},setQualityClickTriggered:function(){h=!0},getDismissInitiatedSource:function(){return b},setDismissInitiatedSource:function(e){b=e},getPresentationDelay:function(e){return e?g[S.delayConfigKeys.initialDelay]:g[S.delayConfigKeys.subsequentDelay]},getFlow:function(){return v},getPpid:function(){return m}}}}},{"./SKOverlayConstants":59}],59:[function(e,t,n){var i=e("../../components/Constants");t.exports={minimalSupportedIOSVersion:14,supportedProductTypes:[i.RV,i.IS],configKeys:{overlayId:"overlayId",advertisedAppId:"advertisedAppId",position:"position",userDismissible:"userDismissible",SKANData:"SKANData",customProductPage:"customProductPageIdentifier"},position:{bottom:0,bottomRaised:1},flow:{presentOnSKClose:0,presentOnSKCloseAndQC:1,presentOnAdVisible:2},externalConfigKeys:{enableSKOverlay:"enableSKOverlay",SKOverlayPosition:"SKOverlayPosition",SKOverlayUserDismissible:"SKOverlayUserDismissible",delayInSecToPresentSKOverlay:"delayInSecToPresentSKOverlay",SKOverlayFlow:"SKOverlayFlow"},delayConfigKeys:{initialDelay:"initialDelay",subsequentDelay:"subsequentDelay"},overlayDismissInitiatedType:{user:0,SKOpen:1,adClose:2},messages:{SDK:{incoming:{overlayCreated:"overlayCreated",overlayCreateFailed:"overlayCreateFailed",overlayLoadFailed:"overlayLoadFailed",overlayWillStartPresentation:"overlayWillStartPresentation",overlayDidFinishPresentation:"overlayDidFinishPresentation",overlayWillStartDismissal:"overlayWillStartDismissal",overlayDidFinishDismissal:"overlayDidFinishDismissal",overlayRemoved:"overlayRemoved",overlayDismissFailure:"overlayDismissFailure",overlayRemovalFailure:"overlayRemovalFailure"},outgoing:{jsInterface:"SKOverlayAPI",createOverlay:"createOverlay",presentOverlay:"presentOverlay",dismissOverlay:"dismissOverlay",removeOverlay:"removeOverlay"}},adunit:{outgoing:{overlayCreateCalled:"overlayCreateCalled",overlayCreateSuccess:"overlayCreateSuccess",overlayCreateFailed:"overlayCreateFailed",overlayVisibleCalled:"overlayVisibleCalled",overlayVisibleSuccess:"overlayVisibleSuccess",overlayVisibleFailed:"overlayVisibleFailed",overlayDismissed:"overlayDismissed"}}}}},{"../../components/Constants":14}],60:[function(g,e,t){e.exports=function(e,t,n){var i=null,r=0,a=null,o=null,s=g("./SKOverlayConstants"),d=new(g("../../modules/DemandSource/EventCategories.js"));function l(e){o=window.timerService.startTimer(),i.trackEvent(d.overlayWillStartPresentation_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r})}function c(e){i.trackEvent(d.overlayDidFinishPresentation_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r,custom_c:o?window.timerService.stopTimer(o):-1,timingvalue:a?window.timerService.stopTimer(a):-1}),a=o=null}function u(e){i.trackEvent(d.presentOverlayFailed_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r,callfailreason:e.errMsg,timingvalue:a?window.timerService.stopTimer(a):-1}),a=null}function f(e){i.trackEvent(d.overlayWillStartDismissal_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r})}function p(e){i.trackEvent(d.overlayDidFinishDismissal_c,{},{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:r}),r++}return{init:function(){i=e.Eventics.createEventic({productChance:1,baseData:{}},t.EventsManager),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayWillStartPresentation,l),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayDidFinishPresentation,c),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayLoadFailed,u),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayWillStartDismissal,f),e.PubSub.subscribe(n.CB+"."+s.messages.SDK.incoming.overlayDidFinishDismissal,p)},onPresentOverlay:function(){a&&i.trackEvent(d.presentOverlayDuringPendingPresent,{},{timingvalue:window.timerService.stopTimer(a)}),a=window.timerService.startTimer()}}}},{"../../modules/DemandSource/EventCategories.js":120,"./SKOverlayConstants":59}],61:[function(E,e,t){e.exports=function(p,g,v){var m="SKOverlayManager | ",o=E("./SKOverlayConstants").configKeys,h=E("../../components/SKOverlay/SKOverlay"),b=E("./SKOverlayConstants"),d=E("../../components/storeKit/SKANModel")(),e=E("../../constants/SDKFeatureNames"),s=new(E("../../modules/DemandSource/EventCategories.js")),t=!1,S=[],n=null,l=null,i=null,r=null,c=null,y=null,A=!1,u=!1,a=null;function f(){return g.isIOS()&&g.getConfigurationHelper().getDeviceApiLevel()>=b.minimalSupportedIOSVersion&&g.CompatibilityService.isFeatureSupportedInNativeSDK(e.SKOverlay)}function C(e,t,n,i,r,a,o,s){var d=[],l=e,c=new h(l,t,n,i,r,a,o,s);if(c){var u=b.messages.SDK.incoming.overlayCreated+M(),f=b.messages.SDK.incoming.overlayCreateFailed+M();return d.push(p.PubSub.subscribe(v.CB+"."+u,function(e){var t;g.log(m+"_createOverlay | "+u+"   "+JSON.stringify(e)),function(e){if(!e)return g.log(m+"Failed to add overlay to overlays array");S.push(e)}(c),x(b.messages.adunit.outgoing.overlayCreateSuccess,e),c.getFlow()===b.flow.presentOnSKCloseAndQC&&(t=l,y=p.PubSub.subscribe("SDKController.qcTriggered",function(){var e=T(t);e&&e.setQualityClickTriggered()})),c.getFlow()===b.flow.presentOnAdVisible&&F(c,!0),A=!1,p.PubSub.clearHandlers(d)})),x(b.messages.adunit.outgoing.overlayCreateCalled,c.getConfigObjectForSDK()),L(b.messages.SDK.outgoing.createOverlay,c.getConfigObjectForSDK(),u,f),c}g.log(m+"_createOverlay | Failed to create an overlay - missing overlayId")}function D(n){var i=T(n);i||(g.log(m+"_dismissOverlay | Failed to dismiss an overlay with missing overlay"),c.trackEvent(s.overlayMissing,{},{custom_b:1}));var e=b.messages.SDK.incoming.overlayDismissFailure+M(),r=p.PubSub.subscribe(v.CB+"."+e,function(e){var t={generalmessage:i?i.getAdvertisedAppId():-1,custom_a:n};c.trackEvent(s.overlayDismissFailure,{},t),p.PubSub.unsubscribe(r)});c.trackEvent(s.dismissOverlay_c,{},{generalmessage:i?i.getAdvertisedAppId():-1,custom_a:n,custom_b:0}),L(b.messages.SDK.outgoing.dismissOverlay,{overlayId:n},null,e)}function I(e){return e?T(e.adViewId):null}function w(e){n=e}function P(){return n}function O(){return!!P()}function T(e){if(!e)return c.trackEvent(s.overlayMissing,{},{custom_b:3}),null;for(var t in Object.keys(S))if(S[t].getOverlayId()===e)return S[t];return c.trackEvent(s.overlayMissing,{},{custom_b:4}),null}function F(e,t){var n=e.getPresentationDelay(t);r=setTimeout(function(){!function(t){if(t){var n=[],i=b.messages.SDK.incoming.overlayDidFinishPresentation,r=b.messages.SDK.incoming.overlayLoadFailed;n.push(p.PubSub.subscribe(v.CB+"."+i,function(e){g.log(m+"_presentOverlay |"+i+"   "+JSON.stringify(e)),g.getCurrentDisplayedAd()&&g.getCurrentDisplayedAdType()!==v.BN&&u?(w(t),p.PubSub.clearHandlers(n),x(b.messages.adunit.outgoing.overlayVisibleSuccess,e)):U(e.overlayId)})),n.push(p.PubSub.subscribe(v.CB+"."+r,function(e){g.log(m+"_presentOverlay | "+r+"   "+JSON.stringify(e)),p.PubSub.clearHandlers(n),x(b.messages.adunit.outgoing.overlayVisibleFailed,e)}));var e={advertisedAppId:t.getAdvertisedAppId()};e[o.customProductPage]=t.getPpid(),x(b.messages.adunit.outgoing.overlayVisibleCalled,e),c.trackEvent(s.presentOverlay_c,{},{generalmessage:t.getAdvertisedAppId(),custom_a:t.getOverlayId()});var a={};a[b.configKeys.overlayId]=t.getOverlayId(),g.SKOverlayEventDispatcher.onPresentOverlay(),L(b.messages.SDK.outgoing.presentOverlay,a,i,r)}else g.log(m+"_presentOverlay | Failed to present an overlay")}(e)},1e3*n)}function x(e,t){g.postAdUnitEvent(g.jQuery().extend({name:e},t))}function L(e,t,n,i){var r={};t&&0!==Object.keys(t).length&&(r={functionParams:t}),g.callSDKService(b.messages.SDK.outgoing.jsInterface,e,r,n,i)}function N(){r&&clearTimeout(r),r=void 0}function U(e){D(e),function(n){var i=T(n);i||(g.log(m+"_removeOverlay | Failed to remove an overlay with missing overlay"),c.trackEvent(s.overlayMissing,{},{custom_b:2}));var r=b.messages.SDK.incoming.overlayRemoved+M(),e=b.messages.SDK.incoming.overlayRemovalFailure+M(),a=p.PubSub.subscribe(v.CB+"."+r,function(e){if(g.log(m+"_removeOverlay | "+r+"   "+JSON.stringify(e)),i){var t=S.indexOf(i);-1!==t&&S.splice(t,1)}p.PubSub.unsubscribe(a),p.PubSub.unsubscribe(o)}),o=p.PubSub.subscribe(v.CB+"."+e,function(e){var t={callfailreason:e.errMsg,custom_a:n};c.trackEvent(s.overlayRemovalFailure,{},t),p.PubSub.unsubscribe(a),p.PubSub.unsubscribe(o)}),t={};t[b.configKeys.overlayId]=n,L(b.messages.SDK.outgoing.removeOverlay,t,r,e)}(e)}function V(e){return-1!==[v.RV,v.IS].indexOf(e)}function M(){return(new Date).getTime()+Math.random()}return{init:function(){f()&&!t&&(t=!0,c=p.Eventics.createEventic({productChance:1,baseData:{}},g.EventsManager),g.SKOverlayEventDispatcher.init(),p.PubSub.subscribe("SDKController.AdVisible",function(e){var t;e&&V(e.productType)&&(u=!0),(t=e)&&t.settings&&(!t.productType||-1!==b.supportedProductTypes.indexOf(t.productType))&&t.ext&&t.ext.clickTags&&t.ext.clickTags.storeAppId&&(t.settings.hasOwnProperty(b.externalConfigKeys.enableSKOverlay)?t.settings[b.externalConfigKeys.enableSKOverlay]:!t.ext.features||!t.ext.features.hasOwnProperty(b.externalConfigKeys.enableSKOverlay)||t.ext.features[b.externalConfigKeys.enableSKOverlay])&&(clearTimeout(a),a=void 0,function(e){if(e&&e.settings&&e.ext){var t=e.ext.clickTags&&e.ext.clickTags.storeAppId,n=e.settings[b.externalConfigKeys.SKOverlayPosition],i=!e.settings.hasOwnProperty(b.externalConfigKeys.SKOverlayUserDismissible)||e.settings[b.externalConfigKeys.SKOverlayUserDismissible],r=e.settings[b.externalConfigKeys.delayInSecToPresentSKOverlay],a=e.settings[b.externalConfigKeys.SKOverlayFlow]||0,o=d.extractDataForSKOverlay(e),s=e.ext.appData&&e.ext.appData.ppid||"";g.log(m+"_createOverlay : "+JSON.stringify(o)),C(e.adViewId,t,n,i,o,r,a,s)}}(e),l=e)}),p.PubSub.subscribe("SDKController.adClosed",function(e){e.ad&&V(e.ad.productType)&&(u=!1),t&&function e(t){if(t){var n=t&&t.hasOwnProperty("timeInterval")?t.timeInterval:700,i=t&&t.hasOwnProperty("attempts")?t.attempts:1;i<=0||(a=setTimeout(function(){L(b.messages.SDK.outgoing.dismissOverlay,{},null,null),c.trackEvent(s.dismissOverlay_c,{},{custom_b:1}),e(jQuery.extend(t,{attempts:i-1}))},n))}}(e.ad.settings.dismissOverlayOnAdClose),S&&0!==S.length&&(N(),y&&(p.PubSub.unsubscribe(y),y=null),U(S[0].getOverlayId()))}),p.PubSub.subscribe(v.CB+"."+b.messages.SDK.incoming.overlayDidFinishDismissal,function(e){g.log(m+b.messages.SDK.incoming.overlayDidFinishDismissal+"   "+JSON.stringify(e));var t,n,i,r,a=g.getCurrentDisplayedAd();a?(t=e,n=I(a),t.dismissInitiatedSource=n&&n.getDismissInitiatedSource()||b.overlayDismissInitiatedType.user,x(b.messages.adunit.outgoing.overlayDismissed,t),n&&n.setDismissInitiatedSource(null)):(i=e,r=g.AdUtils.extractEventData(l),i&&(r.generalmessage=i.advertisedAppId,r.custom_b=i.userDismissible,r.custom_a=i.overlayId),r.custom_c=b.overlayDismissInitiatedType.adClose,c.trackEvent(s.overlayDismissed,{},r)),w(null)}),p.PubSub.subscribe(v.CB+"."+b.messages.SDK.incoming.overlayCreateFailed,function(e){g.log(m+b.messages.SDK.incoming.overlayCreateFailed+"   "+JSON.stringify(e));var t={};if(e&&e.overlayId){var n=T(e.overlayId);t=n&&n.getConfigObjectForSDK()}x(b.messages.adunit.outgoing.overlayCreateFailed,t)}),p.PubSub.subscribe("SDKController.aecskTriggered",function(e){A=!0}))},isSKOverlaySupported:f,onSKClose:function(){if(f()&&!A){var e=I(l);if(e){if(i)return F(i,!1),void(i=null);e.getFlow()===b.flow.presentOnAdVisible&&F(e,!1),e.getFlow()===b.flow.presentOnSKClose&&F(e,!0),e.getFlow()===b.flow.presentOnSKCloseAndQC&&e.isQualityClickTriggered()&&F(e,!0)}}else A=!1},onSKOpen:function(){f()&&(O()?((i=P()).setDismissInitiatedSource(b.overlayDismissInitiatedType.SKOpen),D(i.getOverlayId())):N())},isSKOverlayVisible:function(){return O()}}}},{"../../components/SKOverlay/SKOverlay":58,"../../components/storeKit/SKANModel":87,"../../constants/SDKFeatureNames":93,"../../modules/DemandSource/EventCategories.js":120,"./SKOverlayConstants":59}],62:[function(e,t,n){t.exports=function(i,r,a){function o(e){var t=i.getConfig().controllerConfig;return(t&&t.networkConfig||{})[e]}var s={getInventoryOnInit:!1,refreshInterval:30,precache:!0};function d(e){return null!=e&&("boolean"==typeof e||"true"===e||"false"===e)}return{shouldFetchNewFeedOnAdCloseFlag:function(e){var t=i.getConfig().controllerConfig;return(t&&t[r.sspProductNames[e]]||{}).shouldFetchNewFeedOnAdClose},getValueByKey:function(e){return(i.getConfig().controllerConfig||{})[e]},getValueByKeyAndProductType:function(e,t){var n=i.getConfig().controllerConfig;return(n&&n[r.sspProductNames[t]]||{})[e]},getNetworkConfigValueByKey:o,getFeaturesConfigByAdSource:function(e){var t=o("features"),n=a.extend(!0,{},t);delete n.MP;var i=e&&t&&t[e]||{};return a.extend(!0,{},n,i)},getOfferWallConfig:function(){var e,t=i.getConfig().controllerConfig,n={precache:d(t.precacheMobileOfferWall)?t.precacheMobileOfferWall:s.precache,getInventoryOnInit:d(t.getInventoryOnInit)?t.getInventoryOnInit:s.getInventoryOnInit,refreshInterval:(e=t.owRefreshInterval,null==e||isNaN(parseInt(e))||0===t.owRefreshInterval?s.refreshInterval:t.owRefreshInterval)};return a.extend(!0,s,n)},isNetworkConfigEmpty:function(){var e=i.getConfig().controllerConfig;return!e||!e.networkConfig}}}},{}],63:[function(e,t,n){function i(o,r,s,d){function i(e,t){return e[0]&&t[0]?(e=new Date(e[0]))<(t=new Date(t[0]))?-1:t<e?1:0:0}function e(e,t){return void 0===e&&(e=1),e=parseInt(e),t=parseInt(t),isNaN(e)||isNaN(t)?-1:e===t?0:t<e?1:-1}function t(e){try{return e()}catch(e){return!1}}function n(e){return"object"==typeof e&&e.hasOwnProperty("length")?Array.prototype.slice.call(e):[]}function a(e){if(c())return f(l(),e)}function l(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function c(){return crypto&&crypto.getRandomValues&&"function"==typeof crypto.getRandomValues&&Array.isArray(crypto.getRandomValues(new Uint8Array(1)))}function u(e,t){if(e.length<=t||t<=0)return"";for(var n=0,i=0;i<e.length;i++){n+=e.charCodeAt(i)}return n%Math.pow(16,t).toString(16)}function f(e,t){if(e.length<=t||t<=0)return e;var n=e.slice(0,-t);return n+u(n,t)}var p={extend:function(e,t){jQuery.extend(e,t)},getScript:function(e,t,n){var i=s.createElement("script");i.src=e;var r=s.getElementsByTagName("head")[0],a=!1;i.onload=i.onreadystatechange=function(e){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,t(e),i.onload=i.onreadystatechange=null,r.removeChild(i))},i.onerror=function(e){o.log(["script load error",e]),n&&n()},r.appendChild(i)},getQueryString:function(e,t,n){n=this.isDefined(n)?n:r.location.href,null===t&&(t=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n);return null===i?t:i[1]},getUrlInfo:function(e){var t=s.createElement("a");return t.href=e,{host:t.hostname,port:t.port,path:t.pathname,protocol:t.protocol}},changeUrlProtocol:function(e,t){var n=s.createElement("a");return n.href=e,n.protocol=t,n.href},serialize:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},isDefined:function(e){return typeof e!==d},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){var t={};if(!this.isString(e))return null;try{t=jQuery.parseJSON(e)}catch(e){}return t},getParams:function(e){var t,n=[],i=e.split("/"),r=i.length;if(-1===e.indexOf("JSON:")){if(2<=r&&r%2==0)for(t=0;t<r;t+=2)n[i[t]]=i.length>=t+1?decodeURIComponent(i[t+1]):null}else{var a=e.split("JSON:");typeof a[1]!==d&&(n=jQuery.parseJSON(a[1]))}return n},decodeValues:function(t){jQuery.each(t,function(e){t.hasOwnProperty(e)&&("string"==typeof t[e]&&(t[e]=decodeURIComponent(t[e])),"object"==typeof t[e]&&t[e]&&o.Utils.decodeValues(t[e]))})},renderTemplate:function(i,e){return e&&jQuery.each(e,function(e,t){var n=new RegExp("{{"+e+"}}","g");i=i.replace(n,t)}),i},isVisible:function(e){return"none"!==e.css("display")&&"hidden"!==e.css("visibility")},versionCompare:function(e,t){var n=function(e){1===e.length&&e.push("0"),2===e.length&&e.push("0")},i=function(t){jQuery.each(t,function(e){t[e]=parseInt(t[e])})};"5.02"===e&&(e="5.0.2");var r=e.split("."),a=t.split(".");n(r),n(a);try{i(r),i(a)}catch(e){throw"parse error"}return r[0]===a[0]?r[1]===a[1]?r[2]===a[2]?0:r[2]>a[2]?1:-1:r[1]>a[1]?1:-1:r[0]>a[0]?1:-1},returnResolvedPromise:function(){var e,t=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),t.resolve.apply(t.resolve,e),t.promise()},returnRejectedPromise:function(){var e,t=new jQuery.Deferred;return 0<arguments.length&&(e=[].slice.call(arguments)),t.reject.apply(t.reject,e),t.promise()},replacePlaceHolder:function(e,t){var n;for(var i in t){n=t[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof n?n():n)}return e},fileArrayIncludes:function(e,t){if(e||0===e.length)return!1;for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},sortDataByDateKey:function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t.sort(i)},apiVersionCompareTo:e,isNestedObjectExists:t,convertArrayLikeObjectToArray:n,generateIdentifier:a,replaceEndingWithCheckSum:f};return p}t.exports=i},{}],64:[function(e,t,n){t.exports=function(p,l){var g=e("../components/PixelTrackingService.js")(l),v=e("../components/FillRateTrackingService.js")(l,g),m=e("../components/ObfuscationService.js")(),h=e("../modules/DemandSource/EventCategories")(),b=e("./Constants"),S=l.DemandUtils;return{parseVast:function(e,t,n){var i,r,a=new jQuery.Deferred;if(r="prod"!==l.getEnv()?(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.js"):(i=e.settings.urltocdn+"/common/sdk/1.0.9/vastObfuscator.4f4eb4fb.min.html",e.settings.urltocdn+"/common/sdk/1.0.9/vast-vmap.4f4eb4fb.min.js"),!(e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse))return a.reject({errMsg:"unsupported vast format"});var o=e.ext.vastData.xmlResponse,s={adData:o,style:"height:100%;",adUnitData:e,vastParserUrl:r},d={adData:o,url:i,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(n,t,e){var i,r;if("[object Array]"===Object.prototype.toString.call(n.ext.callbacks)){var a=n.controllerSpace&&n.controllerSpace.viewCount||0;i=n.ext.callbacks[a]}else i=n.ext.callbacks;var o=v.init(i),s=n.vastIframeId,d=p.PubSub.subscribe("SDKController.VastRequest",function(e){e.vastIframeId&&e.vastIframeId===s&&(o.track({trackingType:"request"}),p.PubSub.unsubscribe(d))}),l=p.PubSub.subscribe("SDKController.VastResponse",function(e){e.vastIframeId&&e.vastIframeId===s&&(clearTimeout(r),"hit"===e.result?(o.track({trackingType:"responseHit"}),m.removeIframe(s),p.PubSub.unsubscribe(l),t.resolve(e.data)):(o.track({trackingType:"responseMiss",data:e.data}),m.removeIframe(s),p.PubSub.unsubscribe(l),t.reject({errMsg:e.data})))}),c=e&&e>b.vastMinimumResponseTimeout?e:b.vastResponseTimeout;r=setTimeout(function(){p.PubSub.unsubscribe(l),p.PubSub.unsubscribe(d),p.PubSub.unsubscribe(u),clearTimeout(r),t.reject({isTimeLimitReached:!0,errMsg:"timeout"})},c);var u=p.PubSub.subscribe("SDKController.VastErrorPixel",function(e){e.vastIframeId&&e.vastIframeId===s&&(g.firePixel(e),m.removeIframe(s),p.PubSub.unsubscribe(u))}),f=p.PubSub.subscribe("SDKController.parseVastInfo",function(e){if(e.vastIframeId&&e.vastIframeId===s){p.PubSub.unsubscribe(f);var t=S.extendCallbackParamsWithParentProductConfig(n,{action:"fireEvent",eventParam:{eName:h.parseVastInfo,label:{},data:{generalMessage:e.data}}});p.PubSub.publish("SDKController.Analytics",[t])}})}(e,a,n.vastTimeOut),m.init(d,function(e){p.Msg.postMessage("$$JSON:"+JSON.stringify(s),i,e[0].contentWindow)}),a.promise()},removeIframe:function(e){m.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":24,"../components/ObfuscationService.js":44,"../components/PixelTrackingService.js":53,"../modules/DemandSource/EventCategories":120,"./Constants":14}],65:[function(t,e,n){e.exports=function(e){var i,r,a,o=t("../components/Constants.js"),s=null;return{init:function(e,t){var n;s=new jQuery.Deferred,i=(n=e).settings&&n.settings.standaloneView,o.viewsStates.normal,r=e.ext&&e.ext.viewUniqueId||"",a={standaloneView:i,viewUniqueId:r,adViewId:t},s.resolve({})},waitForAllViews:function(){return s.promise()},getDisplayWebViewParams:function(e){return a=jQuery.extend(a,{display:e})}}}},{"../components/Constants.js":14}],66:[function(e,t,n){"use strict";n.__esModule=!0,t.exports=function(e){var i=[],t=e.controller;function n(t){var e=i.filter(function(e){return e.getContainerID()===t});return 0<e.length?e[0]:void 0}return{add:function(e){e&&i.push(e)},getAdViewById:n,isExist:function(e){return void 0!==n(e)},removeAdViewById:function(t){var n={};return i=i.filter(function(e){return e.getContainerID()!==t||(n=e,!1)}),n},toArray:function(){return i.slice()},size:function(){return i.length},printAll:function(){i.forEach(function(e){t.log("container  "+e.getContainerID())})}}}},{}],67:[function(e,t,n){t.exports=function(f,p,g,n,i){var v="AdViewsManager | ";function r(e){return f.log(v+"_getAdViewByAd"),a(e).getAdViewByAd(e)}function a(e){if(m("_getManager"),e)return e.isWPAD?g:p;m("_getManager without ad")}function m(e){f.log(v+e)}return{createAndLoadView:function(e,t,n,i){var r,a,o,s,d,l,c,u;e.isWPAD?(d=e,l=t,c=n,u=i,m("_createAndLoadAdWebView"),g.loadAdUnitUrlToView(d,l,c,u)):(r=e,a=t,o=n,s=i,f.log(v+"_createAndLoadFrameView"),p.createAndLoadAdFrame(r,a,o,s))},displayAdView:function(e,t,n,i){f.log(v+"_displayAdView"),a(e).displayAdView(e,t,n,i)},unloadAdView:function(e){m("_unloadAdView"),e?a(e).unloadAdView(e):m("_unloadAdView | no ad")},updateFrameUrl:function(e,t,n,i){m("_updateFrameUrl"),a(e).updateAdUnitUrl(e,t,n,i)},getContainerState:function(){return m("_getContainerState"),n.getState()},displayContainer:function(e){if(m("_displayContainer"),a(e)===p)return n.display(e);var t=r(e).getContainerID();return n.display(e,t)},hideContainer:function(e){m("_hideContainer"),n.hide(e)},setContainerVisibility:function(e){m("_setContainerVisibility"),n.setVisibility(e)},unloadProductFromContainer:function(){m("_unloadProductFromContainer"),n.unloadProduct()},setContainerBGColorTransparent:function(){m("_setContainerBGColorTransparent"),n.setWebviewBGColorTransparent()},handleScreenVisible:function(e,t){m("_handleScreenVisible"),a(t).handleScreenVisible(e,t)},displayLoader:function(e){if(m("_displayLoader"),i.isDisplayed()){var t=i.get();a(t).displayLoader(e,t)}else p.displayLoader(e)},hideLoader:function(){if(m("_hideLoader"),i.isDisplayed()){var e=i.get();a(e).hideLoader(e)}else p.hideLoader()},isContainerLoaded:function(e){return m("_isContainerLoaded"),a(e).isContainerLoaded(e)},getContainerCreationHandler:function(e){return m("_getContainerCreationHandler"),a(e).getContainerCreationHandler(e)},onAdUnitLoaded:function(e,t,n){f.log(v+"_onAdUnitLoaded"),a(e).onAdUnitLoaded(e,t,n)},getAdViewByAd:r,triggerRedraw:function(){m("_triggerRedraw"),n.redraw()},sendMessageToAdView:function(e,t){return m("_sendMessageToAdView"),t?a(t).sendMessageToDisplayedAdView(e):(m("_sendMessage | ad undefined"),!1)},sendMessageToAllAdViews:function(e){m("_sendMessageToAllAdViews"),g.sendMessageToAllAdViews(e),p.sendMessageToAllAdViews(e)},getDisplayedAdView:function(e){return m("_getDisplayedAdView"),a(e).getDisplayedAdView(e)},hideView:function(){var e=i.get();a(e).hideView(e)},displayView:function(){var e=i.get();a(e).displayView(e)},isViewDisplayed:function(e,t){a(t).isViewDisplayed(e)}}}},{}],68:[function(e,t,n){t.exports=function(n,t,e){var i=n.jQuery(),r=e.style.backgroundColors;return{setSDKWebviewBGColor:function(e,t){e&&(n.log("ContainerManager | setSDKWebviewBGColor | color: "+e),n.callSDKFunction("setWebviewBackgroundColor",i.extend(t||{},{color:e})))},setControllerBGColor:function(e){e&&(n.log("ContainerManager | setControllerBGColor | color: "+e),i("body").css("background",e))},getSDKWebviewBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return r.transparent;case t.OW:case t.RV:default:return r.black}},getControllerBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return r.transparent;case t.OW:case t.RV:default:return r.darkGrey}},backgroundColors:r}}},{}],69:[function(e,t,n){t.exports=function(l,c,u,t){var i,r,n,a="BannerExternalAdViewService | ",f=e("./ExternalAdViewConstants.js"),o=e("./WPADUtils")(c),s=[],d=[],p=f.nativeFunction,g=c.jQuery();function v(){var e=t.get();e&&e.productType&&e.productType===u.BN&&t.reset()}function m(e){return!!e&&e.isViewVisible}function h(e){return e&&e.adViewId}function b(e){var t,n;return n=e,t=!(C()!==f.nativeFunction||h(n)&&!o.isBannerAdViewId(n.adViewId))||h(e)&&function(e){c.log("BannerExternalAdViewService | isIdentifierExistInIdsCollection | "+e);for(var t=!1,n=0;!t&&n<d.length;n++)d[n].id===e&&(t=!0);return t}(e.adViewId),c.log("BannerExternalAdViewService | "+C()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function S(e){D("sendMessage | "+JSON.stringify(e));var t,n,i,r,a,o,s=l.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(n=d,i={},r=(t=e).substr(n+2),a=r.indexOf("="),o=r.substr(0,a),i.name=t.substr(0,n),i[o]=r.substr(a+1),e=i)}c.callSDKFunction(C(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var y=function(e,t){S(e)};function A(){n=!(d=[])}function C(){return p}function D(e){c.log(a+e)}return{init:function(e){var t;n=!0,D("_setNativeServiceApi | "+(t=e)),t&&(D("_setNativeServiceApi | "+t),p=t),c.log("rony BannerExternalAdViewService | _init nativeservice : "+p),s.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){b(e)?!e.configs&&e.configs.productType&&e.configs.visibilityParams||(c.log("rony BannerExternalAdViewService | handeling isVisible"),c.log("BannerExternalAdViewService | "+f.handleContainerIsVisible),m(e.configs.visibilityParams)&&l.PubSub.publish(e.configs.productType+".isVisible",[e.configs])):c.log("rony BannerExternalAdViewService | not handeling isVisible")})),s.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){if(b(e)){c.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved,c.LogLevels.error);for(var t=!1,n=0;!t&&n<d.length;n++)d[n].id===e.configs.externalAdViewId&&(t=!0,d.splice(n,1));t||c.log("BannerExternalAdViewService | "+f.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",c.LogLevels.error),v(),l.PubSub.publish(e.configs.productType+".reset",[e.configs])}})),s.push(l.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){b(e)&&(c.log("BannerExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&l.Utils.decodeValues(e),l.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),s.push(l.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){b(e)&&function(t){try{var e=t.adViewId?t.adViewId:void 0,n=(i=t.id,r=e,function(e){var t={data:e,id:i};r&&g.extend(t,{adViewId:r}),y(t,!0)});c.isAndroid()||l.Utils.decodeValues(t.arguments),e&&g.extend(t.arguments,{adViewId:e}),g.extend(t.arguments,{callback:n}),l.PubSub.publish("SDKController."+t.method,[t.arguments])}catch(e){c.log("BannerExternalAdViewService | unable to parse message: "+t,c.LogLevels.error)}var i,r}(e)}))},destroy:function(){l.PubSub.clearHandlers(s)},loadWithUrl:function(t,n,e,i,r){D("_loadWithUrl | "+t),c.AdUtils.extendAdObjectWithConfig(t,n,e,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){b(e)&&(c.isAdDisplayed(n)?D("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(c.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+t,c.LogLevels.error),v(),l.PubSub.publish("SDKController.AdLoadError",[e])),l.PubSub.unsubscribe(a),r&&r(!1)))}),o=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){b(e)&&(r&&r(!0),D(f.handleLoadWithUrlSuccess),l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(o))});c.callSDKFunction(C(),{functionName:f.NativeAPI.loadWithUrl,functionParams:g.extend({urlForWebView:t},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,t,n,i){c.log("BannerExternalAdViewService | _updateAd | "+JSON.stringify(t));var r={name:"updateAd",param:t};c.AdUtils.extendAdObjectWithConfig(e,t,n,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(a))});c.callSDKFunction(C(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:S,isContainerVisible:m,isExternalAdViewInitiated:function(){if(c.log("BannerExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new g.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){b(e)&&(c.log("BannerExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),i.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),i.reject(e))});return c.callSDKFunction(C(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},addExternalAdViewIdAndSetStatus:function(e){D("_addExternalAdViewIdAndSetStatus");for(var t=e.externalAdViewId,n=e.isInReload,i=!1,r=0;r<d.length;r++){var a=d[r];a.id===t&&(i=!0,D("_addExternalAdViewIdAndSetStatus | changed isInReload to "+(a.isInReload=n)))}i?c.log("BannerExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+t+" has been previously added",c.LogLevels.error):(0!==d.length&&(d=[]),d.push({id:t,isInReload:n}))},getViewVisibility:function(){if(D("_getViewVisibility | banner"),r&&"pending"===r.status)return r;r=new g.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){b(e)&&(D(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),r.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){b(e)&&(e&&e.errMsg&&c.log("BannerExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),r.reject(e))});return c.callSDKFunction(C(),{functionName:f.NativeAPI.getViewVisibility},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()},resetExternalAdViewsIdentifiers:A,removeExternalAdView:function(e,t,n){A(),c.callSDKFunctionWithCallback(C(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,n)},getIsServiceInitiated:function(){return D("rony _getIsServiceInitiated: "+n),n}}}},{"./ExternalAdViewConstants.js":73,"./WPADUtils":77}],70:[function(b,e,t){e.exports=function(t,n,r,e){var i="BannerExternalContainer | ",a=b("./WPADUtils")(n),o=!1,s=!1,d=!1,l=!1,c=e,u=[];function f(e){s=e}function p(e){h("_setAdIsVisibleInContainer = "+e),o=e}function g(){return o}function v(){h("_resetReportAdVisibilityFlags"),f(!1),p(!1)}function m(){return h("_shouldReportAdVisible | containerID: "+c+" isAdLoadedInContainer: "+s+" | isAdVisibleInContainer "+o),s&&!o}function h(e){n.log(i+e)}return{setAdIsVisibleInContainer:p,resetReportAdVisibilityFlags:v,shouldReportAdVisibleForBanners:m,checkStatusOfAdView:function(){if(r.getIsServiceInitiated)return r.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,t,n,i){h("_createAdUrlInAdView "+t.productType),v(),l=!0,r.getIsServiceInitiated&&r.loadWithUrl(e,t,n,i,function(e){d=e,l=!1})},updateAdInAdView:function(e,t,n,i){h("_updateAdInAdView "+t.productType),v(),r.getIsServiceInitiated&&r.updateAd(e,t,n,i)},sendMessageToExternalAdView:function(e){e&&c&&(e.adViewId||(e.adViewId=c)),r.getIsServiceInitiated&&r.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){r.getIsServiceInitiated&&r.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(){h("_onExternalViewLoaded isAdVisibleInContainer="+g()),f(!0)},isAdInExternalViewLoaded:function(){return h("isAdInExternalViewLoaded "+s),s},onBannerViewLoaded:function(t,n){f(!0),r.getIsServiceInitiated&&r.getViewVisibility().then(function(e){r&&r.isContainerVisible(e)&&(t(),m()&&n())})},resetExternalAdViewsIdentifiers:function(){r.getIsServiceInitiated&&r.resetExternalAdViewsIdentifiers()},getContainerID:function(){return h("_getContainerID: "+c),c},removeContainer:function(e,t){r.getIsServiceInitiated&&r.removeExternalAdView(c,e,t)},isVisible:g,isContainerLoaded:function(e){return!0===l&&t.PubSub.publish("BannerExternalContainer.duringCreation",[e]),d},init:function(){u.push(t.PubSub.subscribe("SDKController.AdVisible",function(e){var t;h("inside adVisibleHandler"),h("_shouldRecieveMessage containerID: "+c+" adViewId: "+(t=e).adViewId),(a.isBannerAd(t)&&a.isBannerAdViewId(c)||t.adViewId===c)&&(h("got SDKController.AdVisible | setting visibility to true"),p(!0))}))},clean:function(){h("_clean"),t.PubSub.clearHandlers(u),r.getIsServiceInitiated&&r.destroy(),r=null}}}},{"./WPADUtils":77}],71:[function(f,e,t){e.exports=function(n,i,r,a,e){f("./ExternalAdViewConstants.js");var t="BannerHandlerDelegate | ",o=e,s=r.BN,d=[],l="";function c(e){e.productType=s,e.demandSourceName=o}function u(e){i.log(t+e)}return{assignAdViewAndStartHandle:function(e){u("_assignAdViewAndStartHandle: "+e),e&&(l=e,d.push(n.PubSub.subscribe("removed."+l,function(e){var t;c(e),u("handle banner removed with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(t=a.get())&&t.productType&&t.productType===r.BN&&a.reset()})),d.push(n.PubSub.subscribe("isVisible."+l,function(e){var t;c(e),!e.configs&&e.configs.productType&&e.configs.visibilityParams||(u("handle banner visible with id: "+e.adViewId+"for instance id: "+e.demandSourceId),(t=e.configs.visibilityParams)&&t.isViewVisible&&e.productType===r.BN&&n.PubSub.publish("Banner.isVisible",[e]))})),d.push(n.PubSub.subscribe("destroy."+l,function(t){var e;c(t),u("handle banner destroy with id: "+t.adViewId+"for instance id: "+t.demandSourceId),t.isBNAutoRemove?(c(e=t),e[r.isBNAutoRemove]&&!1===i.getSDKDataByKey(r.bnAutoDestroy)||(u("handle banner replace with id: "+e.adViewId+"for instance id: "+e.demandSourceId),i.unloadAdViewsByProductExceptDisplayedView({productType:e.productType}))):i.OMIDService.finishSession(t).always(function(){var e;e=t,n.PubSub.publish("Banner.reset",[e]),a.getDisplayedAdType()===r.BN&&n.PubSub.publish("SDKController.AdClose",[e])})})))},stopHandle:function(){u("stopHandle: "+l),n.PubSub.clearHandlers(d)}}}},{"./ExternalAdViewConstants.js":73}],72:[function(e,t,n){t.exports=function(e,t){var n,i={notCreated:0,duringCreation:1,createdSuccessfully:2,failedToCreate:3},r=i.notCreated,a=new e.Deferred,o="failed to create native webview";function s(e){e!==r?(d("setState - new state: "+e),function(e){if(d("updatePromiseOnStateChange: "+e),"pending"!==a.state())return d("updatePromiseOnStateChange - not in pending state - ignoring");e===i.createdSuccessfully?a.resolve():e===i.failedToCreate&&a.reject(o)}(r=e)):d("setState - already in state: "+e)}function d(e){t("ContainerCreationStateHandler | "+e)}return{getState:function(){return r},setState:s,getCreationStates:function(){return i},getCreationResultPromise:function(){return a.promise()},creationStarted:function(e){d("creationStarted"),s(i.duringCreation),n=setTimeout(function(){d("creation ended because of timeout"),s(i.failedToCreate)},e||3e3)},creationEnded:function(e){d("creationEnded with result: "+e),clearTimeout(n),s(e?i.createdSuccessfully:i.failedToCreate)}}}},{}],73:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility",removeAdView:"removeAdView",linkActivation:"linkActivation"},nativeFunction:"bannerViewAPI",nativeFunctionAdViewAPI:"adViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",performDestroyDisplayBanner:"performDestroyDisplayBanner",destroyBanner:"destroyBanner",cleanUpNonDisplayBanners:"cleanUpNonDisplayBanners",isBNAutoRemove:"isBNAutoRemove",bnAutoDestroy:"bnAutoDestroy",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],74:[function(P,e,t){e.exports=function(l,c,u,t){var i,r,a,n="ExternalAdViewService | ",e=P("../../constants/SDKFeatureNames"),f=P("./ExternalAdViewConstants.js"),o=P("./bannerLoadWhileShowHandler"),s=P("./WPADUtils")(c),d=[],p=f.nativeFunction,g=c.jQuery();function v(){var e=t.get();e&&e.productType&&e.productType===u.BN&&t.reset()}function m(e){return!!e&&e.isViewVisible}function h(e){return e&&e.adViewId}var b={handleVisible:function(e){var t;!(t=e.configs)&&t.productType&&t.visibilityParams||(c.log("ExternalAdViewService | "+f.handleContainerIsVisible),m(t.visibilityParams)&&t.productType===u.BN&&l.PubSub.publish(t.productType+".isVisible",[t]))},handleRemoved:function(e){c.log("ExternalAdViewService | bannerSingleInstancesHandler | "+f.handleContainerWasRemoved,c.LogLevels.error),v(),l.PubSub.publish(e.configs.productType+".reset",[e.configs])},handlePerformDestroy:function(e){c.log("ExternalAdViewService | bannerSingleInstancesHandler | handlePerformDestroy")}};function S(){return c.CompatibilityService.isFeatureSupportedInNativeSDK(e.bannerMultipleInstances)?o(l,c):b}function y(e){if(t=e,D()===f.nativeFunction&&(!h(t)||s.isBannerAdViewId(t.adViewId)))return!0;var t,n=h(e)&&I()===e.adViewId;return c.log("ExternalAdViewService | "+D()+" | handling message? "+n+"  message:"+JSON.stringify(e)),n}function A(e){w("sendMessage | "+JSON.stringify(e));var t,n,i,r,a,o,s=l.PubSub.subscribe(u.CB+"."+f.handleSendMessageFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleSendMessageFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(s))});if("string"==typeof e){var d=e.indexOf("$$");-1!==d&&(n=d,i={},r=(t=e).substr(n+2),a=r.indexOf("="),o=r.substr(0,a),i.name=t.substr(0,n),i[o]=r.substr(a+1),e=i)}c.callSDKFunction(D(),{functionName:f.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},f.handleSendMessageSuccess,f.handleSendMessageFailure)}var C=function(e,t){A(e)};function D(){return p}function I(){return a}function w(e){c.log(n+e)}return{init:function(e,t){var n,i;w("_setNativeServiceApi | "+(i=e)),i&&(p=i),w("_setAdViewId | "+(n=t)),n&&(a=n),d.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerIsVisible,function(e){y(e)&&S().handleVisible(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.handleContainerWasRemoved,function(e){y(e)&&S().handleRemoved(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.destroyBanner,function(e){y(e)&&S().handlePerformDestroy(e)})),d.push(l.PubSub.subscribe(u.CB+"."+f.NativeAPI.linkActivation,function(e){y(e)&&(c.log("ExternalAdViewService |  "+f.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&l.Utils.decodeValues(e),l.PubSub.publish(u.CB+".linkActivationOnAd",[e]))})),d.push(l.PubSub.subscribe(u.CB+"."+f.handleMessage,function(e){y(e)&&function(t){try{var e=t.adViewId?t.adViewId:void 0,n=(i=t.id,r=e,function(e){var t={data:e,id:i};r&&g.extend(t,{adViewId:r}),C(t,!0)});c.isAndroid()||l.Utils.decodeValues(t.arguments),g.extend(t.arguments,{callback:n}),e&&g.extend(t.arguments,{adViewId:e}),l.PubSub.publish("SDKController."+t.method,[t.arguments])}catch(e){c.log("ExternalAdViewService | unable to parse message: "+t,c.LogLevels.error)}var i,r}(e)}))},destroy:function(){l.PubSub.clearHandlers(d)},loadWithUrl:function(t,n,e,i,r){w("_loadWithUrl | "+t),c.AdUtils.extendAdObjectWithConfig(t,n,e,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlFailure,function(e){y(e)&&(c.isAdDisplayed(n)?w("_loadWithUrl | isAdDisplayed=true"):(e&&e.errMsg&&(c.log("Error calling "+f.handleLoadWithUrlFailure+" with error "+e.errMsg+" url "+t,c.LogLevels.error),v(),l.PubSub.publish("SDKController.AdLoadError",[e])),l.PubSub.unsubscribe(a),r&&r(!1)))}),o=l.PubSub.subscribe(u.CB+"."+f.handleLoadWithUrlSuccess,function(e){y(e)&&(r&&r(!0),w(f.handleLoadWithUrlSuccess),l.PubSub.unsubscribe(a),l.PubSub.unsubscribe(o))});c.callSDKFunction(D(),{functionName:f.NativeAPI.loadWithUrl,functionParams:g.extend({urlForWebView:t},i)},f.handleLoadWithUrlSuccess,f.handleLoadWithUrlFailure)},updateAd:function(e,t,n,i){c.log("ExternalAdViewService | _updateAd | "+JSON.stringify(t));var r={name:"updateAd",param:t};c.AdUtils.extendAdObjectWithConfig(e,t,n,i);var a=l.PubSub.subscribe(u.CB+"."+f.handleUpdateAdFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleUpdateAdFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(a))});c.callSDKFunction(D(),{functionName:f.NativeAPI.updateAd,functionParams:{params:JSON.stringify(r)}},f.handleUpdateAdSuccess,f.handleUpdateAdFailure)},sendMessage:A,isContainerVisible:m,isExternalAdViewInitiated:function(){if(c.log("ExternalAdViewService | isExternalAdViewInitiated |"),i&&"pending"===i.status)return i;i=new g.Deferred;var t=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiated,function(e){y(e)&&(c.log("ExternalAdViewService | "+f.handleIsInitiated+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),i.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleIsInitiatedFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("Error calling "+f.handleIsInitiatedFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),i.reject(e))});return c.callSDKFunction(D(),{functionName:f.NativeAPI.isExternalAdViewInitiated},f.handleIsInitiated,f.handleIsInitiatedFailure),i.promise()},getViewVisibility:function(){if(w("_getViewVisibility | external container"),r&&"pending"===r.status)return r;if(r=new g.Deferred,I()){var t=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilitySuccess,function(e){y(e)&&(w(f.handleGetViewVisibilitySuccess+" "+JSON.stringify(e)),l.PubSub.unsubscribe(t),l.PubSub.unsubscribe(n),r.resolve(e))}),n=l.PubSub.subscribe(u.CB+"."+f.handleGetViewVisibilityFailure,function(e){y(e)&&(e&&e.errMsg&&c.log("ExternalAdViewService | Error calling "+f.handleGetViewVisibilityFailure+" with error "+e.errMsg,c.LogLevels.error),l.PubSub.unsubscribe(n),l.PubSub.unsubscribe(t),r.reject(e))});return c.callSDKFunction(D(),{functionName:f.NativeAPI.getViewVisibility,functionParams:{adViewId:I()}},f.handleGetViewVisibilitySuccess,f.handleGetViewVisibilityFailure),r.promise()}r.reject({errMsg:"adViewId is missing"})},removeExternalAdView:function(e,t,n){c.callSDKFunctionWithCallback(D(),{functionName:f.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,n)},setBannerHandlerDelegate:function(e){}}}},{"../../constants/SDKFeatureNames":93,"./ExternalAdViewConstants.js":73,"./WPADUtils":77,"./bannerLoadWhileShowHandler":80}],75:[function(e,t,n){var b=e("./ContainerCreationStateHandler"),S=e("./WPADUtils");t.exports=function(o,t,s,e){var n="ExternalContainer | ",i=new S(t),d=new b(t.jQuery(),t.log),r=!1,a=!1,l=e,c=null,u=[];function f(e){a=e}function p(e){h("_setAdIsVisibleInContainer = "+e),r=e}function g(){return r}function v(){h("_resetReportAdVisibilityFlags"),f(!1),p(!1)}function m(){return h("_getContainerID: "+l),l}function h(e){t.log(n+e)}return u.push(o.PubSub.subscribe("SDKController.AdVisible",function(e){var t;h("inside adVisibleHandler"),h("_shouldReceiveMessage containerID: "+l+" adViewId: "+(t=e).adViewId),(i.isBannerAd(t)&&i.isBannerAdViewId(l)||t.adViewId===l)&&(h("got SDKController.AdVisible | setting visibility to true"),p(!0))})),{setAdIsVisibleInContainer:p,resetReportAdVisibilityFlags:v,createAdUrlInAdView:function(e,t,n,i){var r,a;h("_createAdUrlInAdView "+t.productType),v(),(r=i).shouldCreateContainer=(a=r,!!o.Utils.isDefined(a.adSize)&&!(!o.Utils.isDefined(a.adSize.width)||!o.Utils.isDefined(a.adSize.height))&&0<a.adSize.width&&0<a.adSize.height),c&&c.assignAdViewAndStartHandle(m()),function(e){if(e||!e.productType)var t=o.PubSub.subscribe(e.productType+".GetConfig",function(e){e.adViewId&&e.adViewId===l&&(o.PubSub.unsubscribe(t),d.creationEnded(!0))})}(t),d.creationStarted(),s.loadWithUrl(e,t,n,i,function(){h("native reported on webview creation")})},sendMessageToExternalAdView:function(e){e&&l&&(e.adViewId||(e.adViewId=l)),s.sendMessage(e)},onExternalViewLoaded:function(e,t,n){f(!0),h("_onExternalViewLoaded"),e.displayOnAdReady&&s.getViewVisibility().then(function(e){s&&s.isContainerVisible(e)&&(g()||n())})},isAdInExternalViewLoaded:function(){return h("isAdInExternalViewLoaded "+a),a},getContainerID:m,removeContainer:function(e,t){s.removeExternalAdView(l,e,t)},isVisible:g,isContainerLoaded:function(){return d.getState()===d.getCreationStates().createdSuccessfully},clean:function(){h("_clean"),o.PubSub.clearHandlers(u),c&&(c.stopHandle(),c=null),s.destroy(),s=null},getContainerCreationHandler:function(){return d},shouldReportAdVisible:function(){return a&&!r},setAdInstanceHandler:function(e){c=e}}}},{"./ContainerCreationStateHandler":72,"./WPADUtils":77}],76:[function(e,t,n){t.exports=function(l,c,u){var f=l.jQuery(),p={none:0,device:1,controller:2};function g(e,t,n,i){l.isIOS()&&f("body").css("height",t.scrollHeight),u.setBackgroundColorByMode("Neutral",n),c.displayView(),l.callSDKFunction("setBackButtonState",{state:p.controller}),e(!1,!1,null),i(),f("#ssaNavigator").removeClass("webNavigation").addClass("defaultNavigation"),l.isIOS()&&setTimeout(function(){l.callSDKFunction("navigationModeChange",{state:!1})},70)}return{changeToNavigationMode:function(e,t,n,i,r){var a,o,s,d;f("body").css("height",""),u.setBackgroundColorByMode("Navigation","WebControls"),c.hideView(),c.hideLoader(),l.callSDKFunction("setBackButtonState",{state:p.device}),e(!1,null),a=e,o=n,s=i,d=r,t.unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),f("#ssaNavigatorBackButton").unbind("touchend"),l.callSDKFunction("controlSecondaryWebView",{action:"close"}),l.callSDKFunction("removeCloseEventHandler"),g(a,o,s,d)}),f("#ssaNavigatorBackButton").unbind("touchend").bind("touchend",function(e){e.stopPropagation(),e.preventDefault(),l.callSDKFunction("removeCloseEventHandler"),l.callSDKFunction("controlSecondaryWebView",{action:"back"})}),f("#ssaNavigator").removeClass("defaultNavigation").addClass("webNavigation"),l.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:g}}},{}],77:[function(e,t,n){t.exports=function(a){var o=e("../../constants/SDKFeatureNames"),t=e("../../components/Constants.js"),s=e("../../components/OMIDConstants"),n="bannerAdView";function d(e){return e.productType===t.BN}return{generateAdViewId:function(e){return a.isBannerNoneLWS(e.productType)?n:a.AdUtils.generateUniqueAdId(e)},generateBannerAdViewId:function(){return t.bannerAdViewId},isBannerAdViewId:function(e){return-1!==e.indexOf(t.bannerAdViewId)},shouldDisplayAdOnExternalWebView:function(e,t){if(a.log("_shouldDisplayAdOnExternalWebView"),d(e))return!0;if(a.OMIDService.isAdOmidSupported(e)){var n=(i=a.OMIDService.getVersionData().omidVersion)&&s.omidVersionRequiresWebviewPerAd[i];return a.log("_shouldDisplayAdOnExternalWebView - OMID Ad - requires WPAD: "+n),n}var i,r;return(r=t)&&!0===r.webviewPerAd?a.CompatibilityService.isFeatureSupportedInNativeSDK(o.webviewPerAdV1)?!t||0!==t.numOfBannersToInitSuccess||0!==t.numOfBannersToCache||(a.log("_shouldDisplayAdOnExternalWebView - numOfBannersToInitSuccess 0 , numOfBannersToCache 0"),!1):(a.log("_shouldDisplayAdOnExternalWebView - not supported for sdk version"),!1):(a.log("_shouldDisplayAdOnExternalWebView - wpad flag is off"),!1)},isBannerAd:d,getBannerAdViewId:function(){return n}}}},{"../../components/Constants.js":14,"../../components/OMIDConstants":42,"../../constants/SDKFeatureNames":93}],78:[function(e,t,n){t.exports=function(i,d,e,l,c,u){var t="Webview | ",f=!1,p=!1,g=!1,r=null,a={on:!1,productConfig:null},v=d.jQuery();function m(){S("state- open: "+f+", viewable: "+p+"engaged "+g+" , productConfig: "+JSON.stringify(r))}function n(e,t){if(S("received event: "+e+" sendCloseRequest: "+JSON.stringify(a)),"close"===e&&o(t)){var n=d.DemandUtils.extendCallbackParamsWithParentProductConfig(t);i.PubSub.publish("SDKController.onAdWindowsClosed",[n]),d.callSDKFunction("onAdWindowsClosed",n)}}function h(){d.callSDKFunction("setForceClose",e.disable)}function o(e){return a.on&&a.productConfig===e?(a.on=!1,a.productConfig=null,m(),!0):(m(),!1)}function b(e){r=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,{}),g=!0,m()}function S(e){d.log(t+e)}return{setBackgroundColorByMode:function(e,t){"Navigation"===e?(c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(t)),c.setControllerBGColor(c.getControllerBGColorByProductType(t))):"Neutral"===e&&(c.setControllerBGColor(c.getControllerBGColorByProductType(t)),c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(t)))},display:function(e,t){if(e){if(d.isAndroid()||!f&&!p){var n=u.getAdDisplayOrientation(d.getConfig(),d.getApplicationExternalConfig(),e);d.OrientationService.setOrientation(n)}else S("avoiding setOrientation for new displayed ad");if(f||p)return S("be might here because of next offer, engaged is "+g),void(g=!0);var i,r;r={adViewId:t},(i=e)&&i.productType?d.getNotchService().onSetConfig(i)?(c.setSDKWebviewBGColor(c.backgroundColors.semiTransparent,r),c.setControllerBGColor(c.backgroundColors.semiTransparent)):i.settings.setContainerBGColorBlack?c.setControllerBGColor(c.backgroundColors.black):(c.setSDKWebviewBGColor(c.getSDKWebviewBGColorByProductType(i.productType),r),c.setControllerBGColor(c.getControllerBGColorByProductType(i.productType))):c.setControllerBGColor(c.backgroundColors.darkGrey),h(),b(e),d.ViewsManager.init(e,t);var a=d.DemandUtils.extendCallbackParamsWithParentProductConfig(e,d.ViewsManager.getDisplayWebViewParams(!0)),o=function(e){var t={};if(d.isAndroid()){var n=e.settings&&e.settings.immersive;v.extend(t,{immersive:n}),t.activityThemeTranslucent=!!e.settings.translucentView,t.removeViewOnDestroy=!0,e.settings.sambsfix&&(S("ctrWVPauseResume=true"),t.ctrWVPauseResume=!0)}return d.isIOS()&&v.extend(t,{appOrientation:d.AppOrientationManager.getOrientation(),ModalPresentationStyle:l.iOS_UIModalPresentationFullScreen}),t}(e);S("display platformParams: "+JSON.stringify(o)),S("display displayParams: "+JSON.stringify(a));var s=v.extend(o,a,{});d.callSDKFunction(l.nativeInterfaceMethod.displayWebView,s),f=!0,m()}},hide:function(){f&&function(){var e,t=new v.Deferred;d.log("webview | hide | "+JSON.stringify(r),d.LogLevels.verbose);var n=d.DemandUtils.extendCallbackParamsWithParentProductConfig(r,d.ViewsManager.getDisplayWebViewParams(!1));return e=i.PubSub.subscribe(l.CB+"."+l.nativeCallBacks.hideSuccess,function(){i.PubSub.unsubscribe(e),t.resolve()}),d.callSDKFunction(l.nativeInterfaceMethod.displayWebView,n,l.nativeCallBacks.hideSuccess,l.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),t.promise()}().then(function(){f=!1,a.productConfig=r,a.on=!0,m(),g||n("close",r)})},setVisibility:function(e){p=e,m()},shouldNotifyClose:o,loadProduct:b,unloadProduct:function(){g=!1,m(),a.on&&n("close",r)},disableForceClose:h,setWebviewBGColorTransparent:function(){c.setControllerBGColor(c.backgroundColors.transparent)},setControllerBGColor:function(e){c.setControllerBGColor(c.getControllerBGColorByProductType(e))},getState:function(){return{engaged:g,opened:f,productConfig:r,viewable:p,standalone:!1}},redraw:function(){d.isAndroid()&&20<=d.getConfigurationHelper().getDeviceApiLevel()&&(c.setSDKWebviewBGColor(c.backgroundColors.black),c.setSDKWebviewBGColor(c.backgroundColors.transparent))}}}},{}],79:[function(e,t,n){var O=e("./ExternalContainer"),T=e("./ExternalAdViewService"),F=e("./ExternalAdViewConstants"),i=e("./AdViewsCollections"),x=(e("../../constants/SDKFeatureNames"),e("./BannerHandlerDelegate"));t.exports=function(b,S,y,A){var C="WebViewManager | ",D=e("./WPADUtils")(S),I=S.jQuery(),w=new i({controller:S});function r(e){if(e)return P("_getAdViewByAd "+e.adViewId),w.getAdViewById(e.adViewId)}function P(e){S.log(C+e)}return{loadAdUnitUrlToView:function(e,t,n,i){var r,a,o,s,d;if(r=e,b.PubSub.subscribe(r.productType+".reset",function(e){P("webViewManager | reset"),w.toArray().forEach(function(e){e.getContainerID()===D.getBannerAdViewId()&&(w.removeAdViewById(e.getContainerID()),e.clean())})}),S.log(C+"_loadAdUnitUrlToView"),t&&e){var l,c,u=(s=e,d=new T(b,S,y,A),s.adViewId=D.generateAdViewId(s),S.isBannerNoneLWS(s.productType)?d.init(F.nativeFunction,s.adViewId):d.init(F.nativeFunctionAdViewAPI,s.adViewId),new O(b,S,d,s.adViewId));l=e,c=u.getContainerID(),e=I.extend(l,{adViewId:c}),w.add(u);var f,p,g=(f=i,p=u.getContainerID(),I.extend(f,{adViewId:p}));a=g,g=(o=e).adSize?I.extend(a,{adSize:o.adSize}):a;var v,m,h=(v=t,m=u.getContainerID(),v+"&"+y.adViewIdString+"="+m);!function(e,t,n){if(P("assignAdInstanceHandlerToExternalContainer | id: "+n.getContainerID()),n&&S.isBannerAndLoadWhileShowSupported(e)){var i=new x(b,S,y,A,t);n.setAdInstanceHandler(i)}}(e.productType,e.demandSourceId,u),u.createAdUrlInAdView(h,e,n,g)}else P("_loadAdUnitUrlToView without ad/url")},updateAdUnitUrl:function(e,t,n,i){},displayAdView:function(t,e,n,i){P("_displayAdView"),A.set(t),I.when(i(t)).then(function(){P("_displayView after adunitOpenCallback"),e(!1),n()}).fail(function(e){t.showAdCallbacks&&t.showAdCallbacks.onShowFailed(e)})},handleScreenVisible:function(e,t){P("_handleScreenVisible");var n=r(t);n.sendMessageToExternalAdView({message:"handleScreenVisible",adViewId:n.getContainerID()})},unloadAdView:function(e){P("_unloadAdView "+e.adViewId);var n=r(e);n?n.removeContainer(function(e){if(e&&e.adViewId===n.getContainerID()){P("_unloadAdView | successCallback | removed id"+e.adViewId);var t=w.removeAdViewById(n.getContainerID());b.Utils.isEmptyObject(t)||t.clean()}},function(e){if(e&&e.adViewId===n.getContainerID()){b.PubSub.publish("SDKController.removeContainerError",[e]),P("_unloadAdView | failCallback | id"+e.adViewId);var t=w.removeAdViewById(n.getContainerID());b.Utils.isEmptyObject(t)||t.clean()}}):P("_unloadAdView | ad is not engaged / no external container")},displayLoader:function(e){P("_displayLoader");var t=r(e);t&&t.sendMessageToExternalAdView({message:"displayLoader",adViewId:t.getContainerID()})},hideLoader:function(e){P("_hideLoader");var t=r(e);t&&t.sendMessageToExternalAdView({message:"hideLoader",adViewId:t.getContainerID()})},hideView:function(e){P("_hideView ad: "+JSON.stringify(e));var t=r(e);t&&t.sendMessageToExternalAdView({message:"hideFrame",adViewId:t.getContainerID()})},displayView:function(e){P("_displayView ad: "+JSON.stringify(e));var t=r(e);t&&t.sendMessageToExternalAdView({message:"displayFrame",adViewId:t.getContainerID()})},isContainerLoaded:function(e){var t=r(e),n=!!t&&t.isContainerLoaded();return P("_isContainerLoaded: "+n),n},onAdUnitLoaded:function(e,t,n){P("_onAdUnitLoaded");var i=r(e);i&&(i.isAdInExternalViewLoaded()?P("already received the loaded event for container"):(i.onExternalViewLoaded(e,t,n),P("ad loaded:"+e.id)))},isAdViewExistForAd:function(e){return P("_isAdViewExistForAd"),!!e&&w.isExist(e.adViewId)},getAdViewByAd:r,sendMessageToDisplayedAdView:function(e){P("_sendMessageToDisplayedAdView");var t=r(A.get());t&&t.sendMessageToExternalAdView(e)},sendMessageToAllAdViews:function(t){P("_sendMessageToAllAdViews"),w.toArray().forEach(function(e){e.sendMessageToExternalAdView(t)})},getDisplayedAdView:function(e){P("_getDisplayedAdView ad: "+JSON.stringify(e));var t=r(e);return t&&(P("external container visible="+t.isVisible()),t.isVisible())?t:null},isViewDisplayed:function(e){return e.isVisible()},getContainerCreationHandler:function(e){var t=r(e);return t?t.getContainerCreationHandler():null}}}},{"../../constants/SDKFeatureNames":93,"./AdViewsCollections":66,"./BannerHandlerDelegate":71,"./ExternalAdViewConstants":73,"./ExternalAdViewService":74,"./ExternalContainer":75,"./WPADUtils":77}],80:[function(e,t,n){var i=e("./ExternalAdViewConstants.js");t.exports=function(t,n){return{handleVisible:function(e){e.adViewId&&(n.log("ExternalAdViewService | bannerMultipleInstancesHandler| handleVisible: isVisible."+e.adViewId,n.LogLevels.error),t.PubSub.publish("Banner.isVisible",[e]),t.PubSub.publish("isVisible."+e.adViewId,[e]))},handleRemoved:function(e){e.adViewId&&(n.log(" ExternalAdViewService | bannerMultipleInstancesHandler | "+i.handleContainerWasRemoved,n.LogLevels.error),t.PubSub.publish("removed."+e.adViewId,[e]))},handlePerformDestroy:function(e){e.adViewId&&(n.log(" ExternalAdViewService | bannerMultipleInstancesHandler | handlePerformDestroy params.adViewId="+e.adViewId),t.PubSub.publish("destroy."+e.adViewId,[e]))}}}},{"./ExternalAdViewConstants.js":73}],81:[function(n,e,t){e.exports=function(i,e,t){var r,a,s=n("../OrientationUtils.js")(),o=t.appInfo.orientation.none,d=!1,l={free:t.appInfo.orientation.none,portrait:t.appInfo.orientation.portrait,landscape:t.appInfo.orientation.landscape};function c(e,t,n){d=!1;var i=l[(e||"").toLowerCase()];if(i)return d=!0,i;if(!n)return t;var r,a=s.sharedOrientationBetweenOrientations(n.viewControllerToPresentFrom||n.topMostViewControllerOrientation,n.windowOrientation),o=(r=(a&&0<a.length?s.convertOrientationsArrayToNumber(a):n.windowOrientation).toString(),s.isContainPortrait(r)&&s.isContainLandscape(r)?l.free:s.isContainPortrait(r)?l.portrait:l.landscape);return o!==t&&(d=!0),o}return{init:function(e,t){r=e,a=t.appOrientation,o=c(r,a,t.orientationRestriction)},getOrientation:function(){return o},isAppOrientation:function(e){return o===e},isChangedExternally:function(){return d},updateAppOrientationByNewRestriction:function(e){if(e){var t,n=o;o=c(r,a,e),n!==(t=o)&&i.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:t}])}}}}},{"../OrientationUtils.js":50}],82:[function(e,t,n){function i(r,a,e){var o=e||{},t,s,d=!1,l=a.Cache,c={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},n=!1,i=!1,u=a.jQuery();function f(e){n=e}function p(e,t,n){return l.cacheAds(o,e,t,n)}function g(e,t,n){return setTimeout(function(){!0,a.log("Time out in update cache. Fallback to non-precache.",a.LogLevels.error),r.PubSub.publish("PrecacheManager.fallbackToNonPrecache",[{demandSourceName:o.demandSourceName,productType:o.productType}]),v(!1),r.PubSub.publish("Cache.StopCacheUpdate",[{demandSourceName:o.demandSourceName,productType:o.productType}]),f(!1),l.clearCacheByType(o,[]).then(function(){t()}).fail(function(){var e="Error deleting globals in fallback to NPC";a.log(e,a.LogLevels.error),n(e)})},o.nonPrecacheFallback)}function v(e){t=e}function m(i){s=g(d,i.cacheTimeoutSuccessCallback,i.cacheTimeoutFailCallback),f(!0),p(i.applicationKey,i.newAdsToEnterCache,i.adAssetsCacheConfig).then(function(){a.log("PM | success",a.LogLevels.verbose),clearTimeout(s),d||(a.log("cache update completed",a.LogLevels.verbose),f(!1),r.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[o]))},function(e,t,n){if(clearTimeout(s),!d){f(!1),r.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedOffers:t,deletedAdsData:n,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:e,inventoryId:i.inventoryId}])}})}function h(e){a.log("PrecacheManager | updateConfig"),u.extend(o,e)}function b(e){var t=e.numOfCampaigns||0,n=e.settings||{};return h({settings:n}),0<=n.numOfBannersToInitSuccess&&0<t&&0<n.numOfBannersToCache?(n.numOfBannersToCache<n.numOfBannersToInitSuccess&&(n.numOfBannersToInitSuccess=n.numOfBannersToCache),t<n.numOfBannersToInitSuccess&&(n.numOfBannersToInitSuccess=t),t<n.numOfBannersToCache&&(n.numOfBannersToCache=t),v(!0),n.maxCachedCampaigns=o.maxCachedCampaigns,l.setSettings(o,n)):(n.numOfBannersToInitSuccess=n.numOfBannersToCache=0,v(!1)),r.Utils.returnResolvedPromise()}function S(e){return e&&e.cacheBase===o.cacheBase}function y(){r.PubSub.subscribe("Cache.cacheUpdated",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignDeleted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDeletedCallback",[e]))}),r.PubSub.subscribe("Cache.campaignSaved",function(e){if(S(e)){var t=u.extend(!0,{},e,o);r.PubSub.publish("PrecacheManager.campaignSavedCallback",[t])}}),r.PubSub.subscribe("Cache.campaignDownloadStarted",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[e]))}),r.PubSub.subscribe("Cache.preProcessingFailed",function(e){S(e)&&(u.extend(e,o),r.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[e]))})}function A(){return t}function C(){var e,t,n=new u.Deferred,i=A();function r(e){n.resolve(e)}return o.settings.purgeCacheOnInit?(t="purge cache on init (settings)",e=!0):i||(t="purge cache on non-precache",e=!0),e?(a.log("handleCacheClear purge reason: "+t,a.LogLevels.verbose),l.clearCacheByType(o,[]).then(r.bind(null,c.campaignsOnly),function(){n.reject("Error in clearing cache")})):r(),n.promise()}function D(e){A()&&(f(!0),l.cacheNext(o,e).always(function(){f(!1)}).fail(function(e,t,n){a.log("line[451]: failed updating cache on cache next with deletedAds: "+t,a.LogLevels.verbose),t&&0<t.length&&r.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:o.productType,demandSourceName:o.demandSourceName,deletedAds:t,deletedAdsData:n,inventoryId:t[0].inventoryId}])}))}function I(){return c}function w(){return l.getNextAvailableAd(o)}function P(e){return l.clearCacheByType(o,e)}function O(e,t){return t=r.Utils.isDefined(t)?t:o.settings.numOfBannersToCache,l.mergeCampaigns(e,t,o.settings.maxCachedCampaigns,o)}function T(e,t){return l.areCampaignsAvailable(e,t,o)}function F(){return l.getCacheSizeByType(o)}function x(){return l.incrementNextCampaign(o)}function L(e){return l.getCurrentAd(o,e)}function N(e){return l.isNextAvailable(o,e)}function U(){return l.cacheNext(o)}function V(e,t){return l.setAdInventoryIndex(o,e,t)}function M(e){return l.isAdInCache(o,e)}function E(e){return l.setSettings(o,e)}function k(){i||(i=!0,y(),l.initCacheBase(o.cacheBase))}function K(e){return l.getAdStatusInQueue(o,e)}function B(e){return l.deleteCachedCampaign(o,e)}function R(e,t){return l.cacheSingleAd(o,e,t)}var j={updateConfig:h,init:k,decidePrecacheStatus:b,isPrecache:A,handleCacheClear:C,mergeCampaigns:O,handleCacheAds:m,updateCache:D,clearCacheByType:P,areCampaignsAvailable:T,getCacheSizeByType:F,setAdInventoryIndex:V,incrementNextCampaign:x,getCurrentAd:L,isAdInCache:M,getAdStatusInQueue:K,setCacheSettings:E,getNextAvailableAd:w,isNextAvailable:N,getCacheClearMessages:I,cachingStatus:l.cachingStatus,deleteCachedCampaign:B,cacheSingleAd:R,getConfig:function(){return o}};return j}t.exports=i},{}],83:[function(e,t,n){t.exports=function(n){var i=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var t=e.SupplyConfigurations.getNetworkConfigValueByKey(i.flags.showStandaloneViewInAdobe);return null!==t&&n.isDefined(t)||(t=!0),e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+t),t}}}},{"./SDKPluginTypeConstants.js":84}],84:[function(e,t,n){t.exports={supportedPluginNames:{adobeAir:"AdobeAir"},flags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],85:[function(o,e,t){e.exports=function(n,i){var r=o("./SDKPluginTypeConstants.js");function a(e){return(t=e).applicationSettings&&t.applicationSettings.SDKPluginType&&t.applicationSettings.SDKPluginType===r.supportedPluginNames.adobeAir?(n.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(o("./AdobeAirPluginHandler.js"))(i)):(n.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var t}return{shouldShowInStandAloneView:function(e){n.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var t=a(e);return t&&"function"==typeof t.shouldShowInStandAloneView?t.shouldShowInStandAloneView(n):(n.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(t?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":83,"./SDKPluginTypeConstants.js":84}],86:[function(e,t,n){t.exports={versions:{SKAN1:1,SKAN2:2},applicationSettingsKeys:{skd:"skd",skanv:"skanv",atid:"atid",providers:"providers",skanIds:"skanIds"},controllerConfigKeys:{SKANData:"SKANData",version:"version",sourceAppTrackID:"sourceAppTrackID",adNetworkIDs:"adNetworkIDs"},nativeParamsKeys:{adNetworkId:"adNetworkId",adNetworkCampaignId:"adNetworkCampaignId",id:"id",adNetworkNonce:"adNetworkNonce",adNetworkImpressionTimestamp:"adNetworkImpressionTimestamp",adNetworkAttributionSignature:"adNetworkAttributionSignature",adNetworkPayloadVersion:"adNetworkPayloadVersion",adNetworkSourceAppStoreIdentifier:"adNetworkSourceAppStoreIdentifier"},SKAdImpression:{minimalSupportedIOSVersion:14.5,jsInterface:"SKAdImpressionAPI",startImpression:"startImpression",startImpressionSuccess:"startImpressionSuccess",startImpressionFailed:"startImpressionFailed",endImpression:"endImpression",endImpressionSuccess:"endImpressionSuccess",endImpressionFailed:"endImpressionFailed"}}},{}],87:[function(e,t,n){t.exports=function(){var c=e("./SKANConstants");function u(e,t,n){var i={};return e&&(i.SKANVersion=e),t&&(i.SKANSourceAppTrackID=t),n&&Array.isArray(n)&&0<n.length&&(i.SKANAdNetworkIDs=n.toString()),i}function i(e){if(!e)return{};var t=parseFloat(e.version);return t?t<c.versions.SKAN2?r(e):a(e):n(e)}function n(e){var t={};return t[c.nativeParamsKeys.id]=e.advertisedAppTrackID||e.appId,t}function r(e){var t=n(e);return t[c.nativeParamsKeys.adNetworkId]=e.adNetworkID,t[c.nativeParamsKeys.adNetworkImpressionTimestamp]=e.timestamp,t[c.nativeParamsKeys.adNetworkNonce]=e.nonce&&e.nonce.toLowerCase(),t[c.nativeParamsKeys.adNetworkAttributionSignature]=e.signature,t[c.nativeParamsKeys.adNetworkCampaignId]=e.SKANCampaignID,t}function a(e){var t=r(e);return t[c.nativeParamsKeys.adNetworkPayloadVersion]=e.version,t[c.nativeParamsKeys.adNetworkSourceAppStoreIdentifier]=e.sourceAppTrackID,t}function t(e,t){return jQuery.extend({},e.settings&&e.settings.SKANData,e.ext&&e.ext.SKANData,e.ext&&e.ext.SKANData&&e.ext.SKANData[t])}return{extractDataForPayload:function(e,t){var n=function(e){var t=!!e&&e[c.applicationSettingsKeys.skd];if(!t)return{};var n=t[c.applicationSettingsKeys.skanv],i=t[c.applicationSettingsKeys.atid],r=t[c.applicationSettingsKeys.providers],a=[];if(r)for(var o=0,s=Object.keys(r);o<s.length;o++){var d=s[o];if(r[d]){var l=r[d][c.applicationSettingsKeys.skanIds];l&&Array.isArray(l)&&0<l.length&&(a=a.concat(l))}}return u(n,i,a)}(t);return 0===Object.keys(n).length&&(n=function(e){if(!e)return{};var t=e[c.controllerConfigKeys.SKANData];if(!t)return{};var n=t[c.controllerConfigKeys.version],i=t[c.controllerConfigKeys.sourceAppTrackID],r=t[c.controllerConfigKeys.adNetworkIDs];return u(n,i,r)}(e)),n},extractDataForSKAdImpression:function(e){return a(t(e,"VTA"))},buildStoreKitLoadDataForSDK:function(e,t){if(!e)return{};var n={appId:e.appId,viewUniqueId:t,storeKitLoadParams:i(e)};return e.ppid&&(n.storeKitLoadParams.ppid=e.ppid),n},extractDataForSKOverlay:function(e){return e?i(t(e,"StoreKit")):{}}}}},{"./SKANConstants":86}],88:[function(e,t,n){t.exports=function(e,t,n,i){var r=parseInt(e),a=0,o=function(e){return!!r&&(-1!==n.storeKit.loadFailuresToPreventRetry.indexOf(e)?(i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | stop executing retries for reason: "+e),!1):(r<=a&&i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | All retries attempts exhausted"),a<r))};return{shouldPerformRetry:o,performRetry:function(){a++,"function"==typeof t&&(i("StoreKitLoadingRetryExecutor | _performRetry | Performing retry attempt #"+a),t())},getCurrentAttempt:function(){return a},cancelAdditionalRetryAttempts:function(){o=function(){return!1}}}}},{}],89:[function(i,e,t){e.exports=function(b,S,y){var t=i("../../patches/PatchStoreKitOsVersion"),A=i("./SKANModel")(),C=i("../../constants/SDKFeatureNames"),D=i("./StoreKitLoadingRetryExecutor"),I=i("./storeKitObject").DisplayStatus,w="NativeCallback",P={};function O(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function n(e){b.PubSub.publish("StoreKit.storeKitCoolDown",["cool down time out is over "+e])}function T(e,t){var n={isViewable:e,changeReason:t};b.PubSub.publish(w+".viewableChange",[n])}function F(){return!S.CompatibilityService.isFeatureSupportedInNativeSDK(C.loadStoreKitOncePerAd)||!x()}function x(){return parseFloat(S.getConfigurationHelper().getDeviceOsVersion())<15.5}function L(e){if(N()){if(!e)return;S.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function N(e){if(!S.isIOS())return!1;try{if(parseInt(S.getConfig().mobileSDKSettings.deviceApiLevel)<y.storeKit.minimalSupportedOSVersion)return!1}catch(e){S.log("StoreKitService | isStoreKitSupported | failed to parse deviceApiLevel as integer")}return!(t(b.Utils,S.CompatibilityService).shouldBlock(S.getApiData({deviceOSVersion:1}).deviceOSVersion)||e&&!0===e.standaloneView)}return b.PubSub.subscribe("SDKController.PreloadAppInstallPage",function(e){S.log("SDKController.PreloadAppInstallPage"),S.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?function e(n,t){var i,r,a=O(n),o=(r=n).productType&&r.storeKitLoadingTimeout||3e4,s=t||D(n.loadRetryAttempts,h,y,S.log);if(N(n)){var d=A.buildStoreKitLoadDataForSDK(n,a);jQuery.extend(d,{useCustomRootView:!0}),S.callSDKFunction("preLoadAppPage",d,"preloadAppInstallPageSuccess","preloadAppInstallPageFailure");var l=b.PubSub.subscribe(w+".appStoreInsideLoaded",function(e){if(e&&"object"==typeof e&&e.viewUniqueId&&e.viewUniqueId===a){clearTimeout(i),b.PubSub.unsubscribe(l),n.callback&&(e.isLoaded||(e.currentLoadRetryAttempt=s.getCurrentAttempt()),n.callback.call(null,e));var t=e.errMsg&&decodeURIComponent(e.errMsg);!e.isLoaded&&s.shouldPerformRetry(t)&&s.performRetry()}}),c=b.PubSub.subscribe(w+".appStoreFailedToDisplayStoreKit",function(e){S.log("appStoreFailedToDisplayStoreKit error",S.LogLevels.verbose);var t,n=decodeURIComponent(e.error);e.viewUniqueId=O(e),e.viewUniqueId!==a&&S.log("appStoreFailedToDisplayStoreKit params.viewUniqueId= "+e.viewUniqueId+" viewUniqueId= "+a,S.LogLevels.verbose),t=n,b.PubSub.publish("StoreKit.storeKitDisplayFailed",[t]),P[e.viewUniqueId]&&P[e.viewUniqueId].setShowingState(I.NON_VISIBLE,!1)}),u=b.PubSub.subscribe(w+".appStoreInsideDisplayStoreKit",function(e){if(e.viewUniqueId=O(e),S.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,S.LogLevels.verbose),e.viewUniqueId===a){P[e.viewUniqueId]&&P[e.viewUniqueId].setShowingState(I.SHOW,!1);var t=jQuery.extend({name:"appStoreInsideVisible",shouldPreloadStoreKitOnStoreKitClose:F()},e);S.postAdUnitEvent(t),T(!1,"storeKitOpen"),S.SKOverlayManager.onSKOpen()}}),f=b.PubSub.subscribe(w+".appStoreInsideClosed",function(e){e.viewUniqueId===a&&(!1!==e.didStoreKitPresent&&!1!==e.isClosed?(v(e),S.SKOverlayManager.onSKClose()):g(e))}),p=b.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId===a&&(S.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?(b.PubSub.unsubscribe(p),m()):S.log("error calling clear App install page with "+JSON.stringify(e),S.LogLevels.error))}),g=function(e){s.cancelAdditionalRetryAttempts(),S.CompatibilityService.isFeatureSupportedInNativeSDK(C.loadStoreKitOncePerAd)&&x()&&L(e.viewUniqueId),S.log("storeKit Failed to Load ",S.LogLevels.verbose),m()},v=function(e){P[e.viewUniqueId]&&P[e.viewUniqueId].setShowingState(I.NON_VISIBLE,!1);var t=jQuery.extend({name:"appStoreInsideClosed",shouldPreloadStoreKitOnStoreKitClose:F()},e);S.postAdUnitEvent(t),T(!0,"storeKitClose"),F()&&(b.PubSub.unsubscribe(u),b.PubSub.unsubscribe(f))},m=function(){b.PubSub.unsubscribe(l),b.PubSub.unsubscribe(f),b.PubSub.unsubscribe(u),b.PubSub.unsubscribe(c)};i=setTimeout(function(){S.log("reach appstoreinside loading timeout",S.LogLevels.verbose),S.postAdUnitEvent({name:"appStoreLoadingTimeout",viewUniqueId:a,currentLoadRetryAttempt:s.getCurrentAttempt(),errMsg:y.storeKit.loadingTimeoutMessage},!0),s.shouldPerformRetry(y.storeKit.loadingTimeoutMessage)?s.performRetry():(m(),L(a))},o)}function h(){clearTimeout(i),L(a),e(n,s)}}(e,null):S.log("error calling preload App install page with "+JSON.stringify(e),S.LogLevels.error)}),b.PubSub.subscribe("SDKController.ClearAppPage",function(e){e.viewUniqueId=O(e),S.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&L(e.viewUniqueId):S.log("error calling clear App install page with "+JSON.stringify(e),S.LogLevels.error)}),{updateAdWithStoreAppId:function(e,t){if(e&&e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId&&!N(t)&&delete e.ext.clickTags.storeAppId,t&&(void 0===(i=t.extractAppIdForStoreKit)||i)&&N(t)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var n=S.AdUtils.getStoreAppId(e);n&&(e.ext.clickTags.storeAppId=n)}var i;return e},getViewUniqueId:O,isStoreKitVisible:function(){for(var e=Object.keys(P),t=0;t<e.length;t++)if(P[e[t]].getIsShowing())return!0;return!1},canPresentStoreKitObj:function(e){return e&&e.getIsNonVisible()},setStoreKitObjectPresentingProgress:function(e){e&&e.setShowingState(I.IN_PROGRESS,!0)},getStoreObject:function(e){return P[e]||(P[e]=new(i("./storeKitObject").StoreKitObject)(e,1500,n)),P[e]}}}},{"../../constants/SDKFeatureNames":93,"../../patches/PatchStoreKitOsVersion":174,"./SKANModel":87,"./StoreKitLoadingRetryExecutor":88,"./storeKitObject":90}],90:[function(e,t,n){var i,r;(r=i||(i={}))[r.NON_VISIBLE=0]="NON_VISIBLE",r[r.IN_PROGRESS=1]="IN_PROGRESS",r[r.SHOW=2]="SHOW";var a=function(){function e(e,t,n){this.viewUniqueId=e,this.coolDownTimeout=t,this.sendEventCoolDown=n,this.showState=i.NON_VISIBLE}return e.prototype.getUniqueId=function(){return this.getUniqueId()},e.prototype.getIsNonVisible=function(){return this.showState===i.NON_VISIBLE},e.prototype.getIsShowing=function(){return this.showState===i.SHOW},e.prototype.setShowingState=function(e,t){var n=this;this.showState=e,t&&setTimeout(function(){n.showState===i.IN_PROGRESS&&(n.showState=i.NON_VISIBLE,n.sendEventCoolDown(n.viewUniqueId))},this.coolDownTimeout)},e}();t.exports={StoreKitObject:a,DisplayStatus:i}},{}],91:[function(e,t,n){t.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},tokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0,auid:!0},android:{gpi:!0,blacklistedCampaigns:!0},ios:{}}}},{}],92:[function(o,e,t){e.exports=function(e,r,t,n,i){var a=o("./TokenConstants");return e.PubSub.subscribe(t.CB+"."+a.NativeAPI.failCallback,function(e){r.log("TokenService | updateTokenFail: "+JSON.stringify(e));var t=e.errMsg?e.errMsg:"unknown";n.trackEvent(i.updateTokenFail,{generalMessage:t})}),{updateToken:function(e){var t=function(e){if(!e)return{};var t={},n=a.payloadKeys.common;for(var i in jQuery.extend(n,a.payloadKeys[r.getConfig().mobileSDKSettings.deviceOs]),n)n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(e);r.log("TokenService | _updateNativeToken | data: "+JSON.stringify(t)),0!==Object.keys(t).length&&r.callSDKFunction(a.tokenAPI,{functionName:a.ControllerNativeAPI.updateToken,functionParams:t},null,a.NativeAPI.failCallback)}}}},{"./TokenConstants":91}],93:[function(e,t,n){t.exports={bannerMultipleInstances:"bannerMultipleInstances",storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback",limitAppFiltering:"disableCheckInstalledAppsJSInterface",noPackagesInstallationPolling:"noPackagesInstallationPolling",webviewPerAdV1:"webviewperad-v1",loadStoreKitOncePerAd:"loadStoreKitOncePerAd",SKAdImpression:"SKAdImpression",SKOverlay:"SKOverlay",bannersOpenMeasurement:"bannersOpenMeasurement"}},{}],94:[function(e,t,n){t.exports={pullingNativeDeviceData:{ios:"5.76",android:"5.81"},mutableAdvertingTrackingData:{ios:"5.79",android:"99"}}},{}],95:[function(e,t,n){var p={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},g={ext:{videoData:{videoSource:{vast:""}}}},v={ext:{vastData:{xmlResponse:""}}},m={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},h={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},b={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},S={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},y={ext:{videoData:{videoSource:{html:""}}}},A={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},C={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}};t.exports=function(){var r=new(e("../patches/PatchCacheFileEncoding")),a=function(e,t){return t+e.split("/").pop()},d=function(e,t,n){var i=e.split("/").pop();return t+(i=r.getCachedFileName(i,n))},o=function(e,t){for(var a=[],n=Object.keys(t),i=0;i<n.length;i++)e[n[i]]&&o(t[n[i]],e[n[i]]);function o(e,t){var n,i;if("string"==typeof e)a.push(t);else if(e instanceof Array&&0===e.length)a=a.concat(t);else if(e instanceof Array&&0<e.length&&t instanceof Array&&0<t.length)for(n=0;n<t.length;n++)for(i=0;i<e.length;i++)o(e[i],t[n]);else{var r=Object.keys(e);for(n=0;n<r.length;n++)t[r[n]]&&o(e[r[n]],t[r[n]])}}return a};function s(e){return!!e.src&&e.src}function l(e){var t,n=o(e,f(e)),i=0<n.length&&n[0];return!!i&&((t=document.createElement("div")).innerHTML=i,t.firstChild)}function c(e){return e.ext&&e.ext.ableToCache}function u(e){return e&&e.type&&"playableAd"===e.type}function i(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function f(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?i(e)?C:h:b:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?m:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?S:u((n=e).ext)&&n.ext.videoData&&n.ext.videoData.videoSource&&n.ext.videoData.videoSource.html?y:i(t=e)&&t.ext.appData&&t.ext.appData.appIcon&&!t.ext.appData.appImages?A:p;var t,n}return{extractStaticFiles:function(e,t){return e.ext&&u(e.ext)?function(e,t){var n=[];if(t&&c(e)){var i=l(e);if(!i)return n;var r=s(i);if(r){n.push(r);var a=function(e){var t,n=[];if(t=e.getAttribute("data-assets"))try{n=(n=JSON.parse(t))&&n.assets?n.assets:[]}catch(e){}return n}(i);a&&0<a.length&&(n=n.concat(a))}}return n}(e,t):o(e,f(e))},extractVastSource:function(e){var t=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?v:g;return o(e,t)},updateAdunitPrecachePath:function(e,t,n,i){return e.ext&&u(e.ext)?function(e,t){var n=l(e),i=s(n);if(c(e)&&i&&n){var r=a(i,t);n.src=r,e.ext.videoData.videoSource.html=n.outerHTML}}(e,t):function(e,a,t,o){for(var n=Object.keys(t),i=0;i<n.length;i++)e[n[i]]&&(e[n[i]]=s(t[n[i]],e[n[i]]));function s(e,t){var n,i;if("string"==typeof e||"string"==typeof t)t=d(t,a,o);else if(e instanceof Array&&0===e.length)for(n=0;n<t.length;n++)t[n]=d(t[n],a,o);else if(e instanceof Array&&0<e.length&&t instanceof Array&&0<t.length)for(n=0;n<t.length;n++)for(i=0;i<e.length;i++)t[n]=s(e[i],t[n]);else{var r=Object.keys(e);for(n=0;n<r.length;n++)t[r[n]]&&(t[r[n]]=s(e[r[n]],t[r[n]]))}return t}return e}(e,t,f(e),i)},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:c}}},{"../patches/PatchCacheFileEncoding":172}],96:[function(e,t,n){"use strict";var i;n.__esModule=!0;var r,a,f=e("../../types"),o="adPlayerVersion";(a=r||(r={})).AppJs="appJs",a.ChunkVendorsJs="chunkVendorsJs",a.Html="html";var s=((i={})[r.AppJs]="app.js",i[r.ChunkVendorsJs]="chunk-vendors.js",i[r.Html]="index.html",i),d=function(){function t(e,t,n,i,r,a,o,s){this.protocol=f.Protocol.Https;var d=t.ext,l=t.debug,c=t.domain,u=t.scdn;this.version=d.adPlayerVersion,this.assetsFolder=e,this.env=n,this.adPlayerUrl=i,this.cache=r,this.cacheRootFolder=a,this.debug=l,this.domain=c,this.securedCdnBaseUrl=u,this.core=o,this.jQuery=s}return t.prototype.setProtocol=function(e){this.protocol=e},t.prototype.prepareAdPlayerAssets=function(t){var n=this;return this.adPlayerUrl.setRemoteUrl(""+this.buildAdPlayerAssetsBaseUrl()+s[r.Html]),this.isAdPlayerAssetsPromisePendingOrResolved()?this.adPlayerAssetsPromise.promise():(this.adPlayerAssetsPromise=this.jQuery.Deferred(),this.shouldUpdateAdPlayerFiles().then(function(e){return e?n.updateAdPlayerFiles(t):(n.adPlayerUrl.setLocalUrl(""+n.getLocalAdPlayerFolder()+s[r.Html]),n.adPlayerAssetsPromise.resolve(),n.adPlayerAssetsPromise.promise())}))},t.prototype.updateAdPlayerFiles=function(e){var t=this;return this.clearAdPlayerCache().then(function(){return t.precacheAdPlayerAssets(e)})},t.prototype.isAdPlayerAssetsPromisePendingOrResolved=function(){return!!this.adPlayerAssetsPromise&&-1!==["pending","resolved"].indexOf(this.adPlayerAssetsPromise.state())},t.prototype.getAdPlayerCache=function(){var e,t=this.cache.getCacheByType({cacheBase:""+this.assetsFolder});return null!==(e=null==t?void 0:t.cache)&&void 0!==e?e:[]},t.prototype.getLocalAdPlayerFolder=function(){return"../"+this.cacheRootFolder+"/"+this.assetsFolder+"/"},t.prototype.clearAdPlayerCache=function(){return this.cache.clearCacheByType({cacheBase:this.assetsFolder},[])},t.isAdPlayerDirContainAllAssets=function(e){for(var t in s)if(s.hasOwnProperty(t)){var n=t;if(-1===e.indexOf(s[n]))return!1}return!0},t.prototype.shouldUpdateAdPlayerFiles=function(){if(this.env===f.Environment.Develop)return this.core.Utils.returnResolvedPromise(!0);var e=this.getAdPlayerCache();return 0!==e.length&&t.isAdPlayerDirContainAllAssets(e)?this.shouldFetchNewAdPlayerVersion():this.core.Utils.returnResolvedPromise(!0)},t.prototype.buildAdPlayerAssetsBaseUrl=function(){if(0<this.debug&&"www.supersonicads.com"!==this.domain){var e=this.domain.split(".")[0];return this.protocol+"//"+this.domain+"/users/staging/"+e+"/"+this.assetsFolder+"/"+this.version+"/dev/"}return this.protocol+"//"+this.securedCdnBaseUrl+"/"+this.assetsFolder+"/"+this.version+"/"},t.prototype.precacheAdPlayerAssets=function(e){var t=this,n=this.assetsToCache(s,this.buildAdPlayerAssetsBaseUrl());return this.cache.cacheFilesByFolder(this.assetsFolder,n,e).then(function(){return t.adPlayerUrl.setLocalUrl(""+t.getLocalAdPlayerFolder()+s[r.Html])},function(){return"Failed to cache ad player files"}).then(function(){return t.updateAppDataWithVersion()})},t.prototype.assetsToCache=function(s,d){var l=[];return Object.keys(s).forEach(function(e){var t=s[e],n=/(\.\.\/)/g,i=t.match(n),r=(null==i?void 0:i.length)||0,a=t.replace(n,"");if(0<r){var o=d.split("/");o.splice(o.length-1-r,r),l.push(o.join("/")+a)}else l.push(d+a)}),l},t.prototype.updateAppDataWithVersion=function(){var t=this;return this.cache.getAppData().then(function(e){return t.setAppDataWithCurrentVersion(e)}).always(function(){return t.adPlayerAssetsPromise.resolve(),t.adPlayerAssetsPromise.promise()})},t.prototype.setAppDataWithCurrentVersion=function(e){var t=e||{};return t[o]=this.version,this.cache.setAppData(t)},t.prototype.shouldFetchNewAdPlayerVersion=function(){var t=this;return this.cache.getAppData().then(function(e){return t.shouldReplaceCachedAdPlayerBuild((null!=e?e:{})[o])},function(){return!0})},t.prototype.shouldReplaceCachedAdPlayerBuild=function(e){return e!==this.version},t}();t.exports=d},{"../../types":180}],97:[function(e,t,n){"use strict";n.__esModule=!0;var c=e("tslib"),i=function(){function e(e){this.remoteUrl=null,this.localUrl=null,this.utils=e}return e.prototype.setRemoteUrl=function(e){this.remoteUrl=e},e.prototype.setLocalUrl=function(e){this.localUrl=e},e.prototype.getAdPlayerUrl=function(e,t,n,i){var r,a=e&&null!==(r=this.localUrl)&&void 0!==r?r:this.remoteUrl,o=n.productType,s=n.demandSourceName,d=i.shouldBuildAdUnitUrlForExternal?{mode:"native",viewType:"external"}:{},l=c.__assign({productType:o,demandSourceName:s,deviceOs:t},d);return a+"?"+this.utils.serialize(l)},e}();t.exports=i},{tslib:1}],98:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("../../types"),r=function(){function e(){}return e.shouldUseAdPlayer=function(e,t,n){return e&&t===i.DeviceOs.Android&&n.ext.type===i.AdType.CPVI},e}();t.exports=r},{"../../types":180}],99:[function(e,t,n){t.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},owFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],100:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=e||{},o=t||{},s=n&&n.debug,d=n&&n.domain,l=n&&n.scdn,c=n&&n.protocol,u=n&&n.adunitConfig,f=i,p=r||{};function g(){return c+"//"+function(){if(s&&0<parseInt(s)&&"www.supersonicads.com"!==d){var e=d.split(".")[0];return d+"/users/staging/"+e}return l}()+"/adunit/dist/adunitAssets.json"}function v(){return o.ajax({dataType:"json",url:g(),timeout:p.apiResponseTimeout}).then(function(e,t,n){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=o.Deferred();return i.reject(p.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()},function(e,t,n){return p.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson})}function m(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return f===p.environment.develop?v():m(u)?a.Utils.returnResolvedPromise(u):v().then(function(e){return m(e)?a.Utils.returnResolvedPromise(e):a.Utils.returnRejectedPromise(p.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)})},setProtocol:function(e){c=e}}}},{}],101:[function(K,e,t){function n(n){var c,u,f,p,g,v,m,h,b,S,y,A,C,r,a,o,s,d,l,D,I,w,P=K("./AdUnitConst.js");function O(){var e=f+"//",t="/adunit/dist",n=s?"/versions/"+s:"";if(c&&0<parseInt(c)&&"www.supersonicads.com"!==u){var i=u.split(".")[0],r="/stage/";("local"===i||1<parseInt(i))&&(r="/dev/"),e=e+u+("/users/staging/"+i)+t+n+r}else e=e+p+t+n+"/prod/";return e}function T(){var e=b.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function F(e,t){return b.cacheGlobalAssets(e,t)}function x(){return"../"+S+"/globals/"}function L(){return b.getAppData().then(function(e){return(e=e||{})[P.adunitVersionKey]=s,b.setAppData(e)}).always(v.Utils.returnResolvedPromise)}function N(){return b.clearCacheByType({cacheBase:"globals"},[])}function U(e){if(g===n.environment.develop)return v.Utils.returnResolvedPromise(!0);var t=T();return t.length<=0||function(e,t){for(var n=0;n<e.length;n++){var i=e[n].split("."),r=i[i.length-1];if(P.adunitFilesMapping.hasOwnProperty(r)&&e[n]!==P.adunitFilesMapping[r])return t.hasOwnProperty("trackEvent")&&t.trackEvent(m.globalsInOldFormat),!0}return!1}(t,e)?v.Utils.returnResolvedPromise(!0):SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==s?v.Utils.returnResolvedPromise(!0):b.getAppData().then(function(e){e=e||{};var t=v.Utils.versionCompare(s,e[P.adunitVersionKey]?e[P.adunitVersionKey]:"0");return v.Utils.returnResolvedPromise(0===t)}).then(function(e){var t=e&&function(){var e=T(),t=P.adunitFilesMapping;for(var n in t)if(-1===e.indexOf(t[n]))return!1;return!0}();return v.Utils.returnResolvedPromise(!t)}).fail(function(){return v.Utils.returnResolvedPromise(!0)})}function V(e){var a=O();return h.map(e,function(e){var t=/(\.\.\/)/g,n=e.match(t),i=n&&n.length||0;if(e=e.replace(t,""),0<i){var r=a.split("/");return r.splice(r.length-1-i,i),r.join("/")+e}return a+e})}function M(e){s=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function E(e){var t,n,i=h.extend(!0,{},P.adunitFilesMapping,e);return n=e,(t=i).libs=function(e,t){for(var n in e)e.hasOwnProperty(n)&&"string"==typeof e[n]&&(e[n]=t+e[n]);return e}(n.libs,"../../"),i=t}function k(e){return w.prefetchGlobalAssetsToBrowser(e,O())}return{init:function(e,t,n,i,r,a,o,s,d,l){e,c=t.debug,u=t.domain,f=t.protocol,p=t.scdn,h=n,b=i,S=r,y=a,A=o,g=s,v=d,m=l,C=new(K("./AdUnitDataJsonFetcher.js"))(v,h,t,g,P),w=new(K("./AdUnitUtils.js"))(v,h,P),I=new(K("./AdUnitGraphicAssetsManager.js"))(v,w,b)},setProtocol:function(e){f=e,C.setProtocol(e)},getStaticGlobalsUrl:O,getGlobalAssetsJSON:function(){return C.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:k,getGlobalsCache:T,isAdunitVersionChanged:function(n){var e=T(),i=!0;return h.each(e,function(e,t){return-1<t.indexOf(n)&&(i=!1),i}),i},clearGlobalsCache:N,getLocalGlobalsFolder:x,cacheGlobalAssets:F,assetsToCache:V,updateAdUnitGlobals:function(t,e,n,i){if(t){if(l&&"rejected"!==l.state())return l.promise();l=h.Deferred()}else{if(d&&"rejected"!==d.state())return d.promise();d=h.Deferred()}return D&&"rejected"!==D.state()||(D=C.getGlobalAssetsJSON().then(function(e){var t;M(r=e),r=E(r),a=P.adunitFilesMapping,I.setAdunitAssetsPaths(r.graphicAssets,O()),o=r.libs,A.setLibsFilesPaths(o,O()),t=O()+P.adunitFilesMapping.html,y.setRemoteAdunitUrl(t),y.setLocalAdunitUrlFromCache(x(),T())}).then(function(){return t?A.manageDownloadLibsFileByFiletype(P.adunitLibsFileName,e):k({adunitLibsFile:o.adunitLibsFile})}).fail(function(e){t?l.reject(e):d.reject(e)})),D.then(function(){return t?(e=n,I.shouldUpdateAdunitAssets()?I.precacheAdunitGraphicAssets(e):v.Utils.returnResolvedPromise()).then(null,function(){l.reject(P.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)}).then(U.bind(null,i)).then(function(e){return e?N().then(function(e,t){return F(V(e),t).then(function(){y.setLocalAdunitUrl(x()+y.getRemoteAdunitFileName())},function(){return y.setLocalAdunitUrl(y.getRemoteAdunitUrl()),P.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl}).then(L)}.bind(null,a,n)).then(function(){l.resolve()},function(e){l.reject(e)}).always(function(){return l.promise()}):(l.resolve(),l.promise())}):k(a).then(I.prefetchAdunitGraphicAssets).then(function(){d.resolve()},function(e){d.reject(e)}).always(function(){return d.promise()});var e})},setAdunitVersion:M,getAdunitGlobalsHTML:function(){return P.adunitFilesMapping.html},updateGlobalAssetsStructure:E,getOWGlobalsHTML:function(){return P.owFilesMapping.html},getOWStaticGlobalsUrl:function(e){var t=f+"//",n="/ow-adunit/dist",i="/versions/"+e;if(c&&0<parseInt(c)&&"www.supersonicads.com"!==u){var r=u.split(".")[0],a="/stage/";("local"===r||1<parseInt(r))&&(a="/dev/"),t=t+u+"/users/staging/"+r+n+i+a}else t=t+p+n+i+"/prod/";return t}}}var i;e.exports=function(e,t){return t?new n(e):(i||(i=new n(e)),i)}},{"./AdUnitConst.js":99,"./AdUnitDataJsonFetcher.js":100,"./AdUnitGraphicAssetsManager.js":102,"./AdUnitUtils.js":103}],102:[function(e,t,n){t.exports=function(e,t,n){var r,a=n||{},o=t||{},s={},i={},d="graphicAssets";function l(){var e=a.getCacheByType({cacheBase:d});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,t){s=e,r=t,i.sprite=s.sprite},shouldUpdateAdunitAssets:function(){if(0===l().length)return!0;for(var e in s)if(!a.isAssetInCache(o.extractFileNameFromPath(s[e]),d))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(t=function(){for(var e=l(),t=[],n=function(e){for(var t in s)if(o.extractFileNameFromPath(s[t])===e)return!1;return!0},i=0;i<e.length;i++)n(e[i])&&t.push(e[i]);return t}(),a.deleteCachedListOfAssets(d,t)).then(a.cacheGraphicAssets.bind(null,function(){var e=[];for(var t in s){var n=o.extractFileNameFromPath(s[t]);if(!a.isAssetInCache(n,d)){var i=o.formatAssetsUrlForCache(s[t],r);e.push(i)}}return e}(),e));var t},prefetchAdunitGraphicAssets:function(){return o.prefetchGlobalAssetsToBrowser(i,r)}}}},{}],103:[function(e,t,n){t.exports=function(e,t,n){var g=t||{},v=n||{};return{formatAssetsUrlForCache:function(e,t){var n=t,i=function(e,t){var n=/(\.\.\/)/g,i=t.match(n),r=i&&i.length||0;if(t=t.replace(n,""),0<r){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+t}return e+t};return"string"==typeof e?i(n,e):g.map(e,function(e){i(n,e)})},prefetchGlobalAssetsToBrowser:function(e,t,n,i){var r,a,o=new g.Deferred,s=[],d=0,l=0,c=g.extend(!0,{},e);c.hasOwnProperty(v.adunitAssetsJsonKeys.html)&&delete c.html;var u=function(e){return-1<s.indexOf(e)};g.each(c,function(e,t){"string"==typeof t?u(t)||l++:delete c[e]}),0===l&&o.resolve();var f=function(e){var t;if(u(t=e)||s.push(t),++d===l){if("function"==typeof n&&n(s),r)return;clearTimeout(a),o.resolve()}},p=t;return g.each(c,function(e,i){if(!u(i)){var t=p+i;g.get(t,{},null,{dataType:"text"}).done(function(){f(i)}).fail(function(e,t,n){"parsererror"===t&&f(i)})}}),a=setTimeout(function(){d<l&&("function"==typeof i&&i(),o.reject("Failed to preload all global assets ("+d+" out of "+l+" succeeded)")),r=!0},15e3),o.promise()},extractFileVersionFromUrl:function(e){var t=e.split("/");return 0<t.length?t[t.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],104:[function(A,e,t){function n(e){var a=e||{},t={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},o={dapi:{filename:"dapi.js",type:t.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:t.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:t.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:t.omid,cacheKeyName:"omid"}},s="libs",d,l,c,i,r;function u(e,t,n){return!!o[e]&&(o[e].url=t,o[e].newVersion=n,!0)}function n(e,t,n){return u(e,t,n),a.returnResolvedPromise()}function f(e,t){return u(e,i.formatAssetsUrlForCache(t,r),i.extractFileVersionFromUrl(t))}function p(e){return d.isAssetInCache(e,s)?d.deleteCachedAsset(s,e):a.returnResolvedPromise()}function g(e,t){return 0===a.versionCompare(e,t)}function v(e,t){var n=o[e],i={};return!!n&&(i[n.cacheKeyName]=t,i)}function m(e,t,n){c=e,l=t,d=n||{},i=new(A("./AdUnitUtils.js"))(l,d)}function h(e,t){if(r=t,e)for(var n in e)f(n,e[n])}function b(e,n){var i=o[e]||{},r=function(){return p(i.filename).then(function(){return c.log("LibsManager | updateFileInCache | going to download",c.LogLevels.verbose),d.cacheLibsAsset(i.url).then(null,function(){return a.returnResolvedPromise()})}).fail(function(){return a.returnResolvedPromise()})};return d.getAppData().then(function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var t=!g(i.newVersion,i.savedVersion);return n||t?r().then(function(e){c.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),c.LogLevels.verbose);var t=l.extend(e,v(i.type,i.newVersion));return c.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(t),c.LogLevels.verbose),d.setAppData(t).fail(function(){return a.returnResolvedPromise()})}.bind(null,e)):d.isAssetInCache(i.filename,s)?(c.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",c.LogLevels.verbose),a.returnResolvedPromise()):(c.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",c.LogLevels.verbose),d.cacheLibsAsset(i.url))},r).then(function(){return c.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,c.LogLevels.verbose),a.returnResolvedPromise("success")},function(){return c.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,c.LogLevels.verbose),S(i)})}function S(e){return e.filename===o.adunitLibsFile.filename?a.returnRejectedPromise("Failed to download file "+e.filename):a.returnResolvedPromise()}var y={init:m,setLibsFilesPaths:h,manageDownloadLibsFileByFiletype:b,updateFileVersionByFilePathForThirdPartyLibraries:n};return y}e.exports=n},{"./AdUnitUtils.js":103}],105:[function(e,t,n){function i(e,n){var t,i,a=function(){return t},r=function(e){t=e},o=function(){var e=null;return t&&(e=t.replace(/^.*[\\\/]/,"")),e},s=function(){return i},d=function(e){i=e},l=function(e,t,n,i){var r=e?s():a();return r+=t&&t.productType?"#?productType="+t.productType:"",r+=t&&t.demandSourceName?"&demandSourceName="+t.demandSourceName:"",r+=n&&n.shouldBuildAdUnitUrlForExternal?"&"+c(i):""};function c(e){var t={mode:"native",viewType:"external"};return e&&(t.deviceOs=e),n.serialize(t)}var u=function(n,e){jQuery.each(e,function(e,t){if("string"==typeof t&&t.match(/.*\.html/))return d(n+t.replace(/^.*[\\\/]/,"")),!1})},f={getAdunitUrl:l,getRemoteAdunitUrl:a,setRemoteAdunitUrl:r,getRemoteAdunitFileName:o,getLocalAdunitUrl:s,setLocalAdunitUrl:d,setLocalAdunitUrlFromCache:u};return f}t.exports=i},{}],106:[function(e,t,n){t.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4}}},{}],107:[function(e,t,n){t.exports=function(e,t,n,i){return{retriesLogic:e.retriesLogic,NativeAPI:e.NativeAPI,ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,ProductName:t.BN,Features:{allowMultiInitCalls:!0,shouldFetchNewFeedOnAdClose:!1,isSupportFetchFeedOnAdCloseLogic:!1,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:t.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0,forcePreload:i,width:n?n.width:0,height:n?n.height:0,label:n?n.label:null,lwsSupported:i}}},{}],108:[function(s,e,t){e.exports=function(r,a){var o=s("../components/Constants");return{create:function(e){var t=s("./ProductAdapter"),n=s("./AdapterSharedConfig"),i=s("./Banner/BannerConfiguration")(n,o,e,a.isBannerAndLoadWhileShowSupported(o.BN));return new t(r,a,i,o)}}}},{"../components/Constants":14,"./AdapterSharedConfig":106,"./Banner/BannerConfiguration":107,"./ProductAdapter":137}],109:[function(ae,e,t){function n(y,A){var C="NativeCallback",h="globals",b="graphicAssets",S="ad-player",n=!1,o=ae("./Cache/CacheConstants"),D={},I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},"ad-player":{cache:[],cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},w={Interstitial:{numOfBannersToCache:1}},P,t=function(e){return 0!==I[e.cacheBase].cache.length?(I[e.cacheBase].currentAd+1)%I[e.cacheBase].cache.length:0},i=function(i){i=i||{},jQuery.each(I,function(e,t){var n=e;I[n].cache&&0!==I[n].cache.length&&y.Utils.isDefined(i)&&i.hasOwnProperty(n)&&I[n].cache.sort(function(e,t){return i[n].indexOf(e.id)<i[n].indexOf(t.id)?-1:1})})},O=function(e){var t,n=e.length;for(t=0;t<n;t++)y.Utils.isDefined(e[t])&&e[t]&&y.PubSub.unsubscribe(e[t])},r=function(e){A.log("cache: "+JSON.stringify(I[e].cache)+" currentAd: "+I[e].currentAd,A.LogLevels.info),A.log("queue: "+JSON.stringify(I[e].cacheQueue),A.LogLevels.info)},T=function(e,t){var n,i=null,r=I[e.cacheBase].cacheQueue.length;for(n=0;n<r;n++)if(I[e.cacheBase].cacheQueue[n].cachingStatus===t){i=I[e.cacheBase].cacheQueue[n];break}return i},F=function(e,t){return e.cacheBase+"/"+t},x=function(e,t){var n=jQuery.map(I[e.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)});if(0<n.length){var i=n.indexOf(t.toString());0<=i&&(A.log("Removing ad from evaluatedCache! "+t,A.LogLevels.verbose),I[e.cacheBase].evaluatedCache.splice(i,1))}},L=function(e,t){var n=A.AdUtils.getAdId(t);if(t&&n){var i,r=I[e.cacheBase].cacheQueue.length;for(i=0;i<r;i++)I[e.cacheBase].cacheQueue[i].id==n&&(I[e.cacheBase].cacheQueue[i]=t)}},N=function(n,e){var i=-1;jQuery.each(I[e.cacheBase].cache,function(e,t){return!(y.Utils.isDefined(t.inventoryIndex)&&t.inventoryIndex>n.inventoryIndex||!y.Utils.isDefined(t.inventoryIndex))||(i=e,!1)}),-1===i?I[e.cacheBase].cache.push(n):I[e.cacheBase].cache.splice(i,0,n);var t={};t.cacheBase=e.cacheBase,t.id=n.id,t.inventoryId=n.inventoryId,t.demandSourceName=n.demandSourceName,y.PubSub.publish("Cache.campaignSaved",[t])},U=function(n){jQuery.each(I[n.cacheBase].cacheQueue,function(e,t){if(t.cachingStatus===P.cachingStatus.none&&0===jQuery.grep(I[n.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length&&0===jQuery.grep(I[n.cacheBase].evaluatedCache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length)return I[n.cacheBase].evaluatedCache.push(t),!1})},a=function(e,t){var n=jQuery.map(I[e.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)});if(0<n.length){var i=n.indexOf(t.toString());0<=i&&(A.log("Removing ad from cache array! "+t,A.LogLevels.verbose),I[e.cacheBase].cache.splice(i,1))}},s=function(i,r){return A.getGlobalAppData().then(function(e){e.cachePriorityArray=e.cachePriorityArray||{};var t=e.cachePriorityArray[i.cacheBase];if(t){var n=t.indexOf(r.toString());0<=n&&(A.log("Removing ad from cache array! "+r,A.LogLevels.verbose),t.splice(n,1),e.cachePriorityArray=t)}return A.setGlobalAppData(e)})};function d(s,c){I[s.cacheBase].evaluatedCache.length;var t,e,n,u,i=I[s.cacheBase].cacheQueue.length,r=(w[s.cacheBase].numOfBannersToCache,null),a=null,f=null,p=null,o=null,g=[],v=[],d=[],m=0,h={};for(n=jQuery.Deferred(),e=0;e<i;e++)I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.pending&&I[s.cacheBase].cacheQueue[e].cachingStatus!==P.cachingStatus.queued||0;var b=function(){0<I[s.cacheBase].evaluatedCache.length?(A.log("line[182]: evaluatedCache is: "+JSON.stringify(I[s.cacheBase].evaluatedCache),A.LogLevels.verbose),(t=T(s,P.cachingStatus.none))?(t.cachingStatus=P.cachingStatus.pending,x(s,A.AdUtils.getAdId(t)),t.numOfAssetsCached=0,D[s.cacheBase][t.id]=[],d.push(A.AdUtils.getAdId(t)),t.preProcessing().then(function(e){if(!y.Utils.isDefined(e))return y.Utils.returnResolvedPromise();t=Y(e),L(s,t)},function(){var e={};e.cacheBase=s.cacheBase,e.id=A.AdUtils.getAdId(t),e.inventoryId=t.inventoryId,e.demandSourceName=t.demandSourceName,y.PubSub.publish("Cache.preProcessingFailed",[e]),g.push(e.id),n.reject(I[s.cacheBase].cache,g)}).then(function(){var e={};e.cacheBase=s.cacheBase,e.id=t.id,e.demandSourceName=t.demandSourceName,y.PubSub.publish("Cache.campaignDownloadStarted",[e]),h={},0===t.assets.length?l(s,A.AdUtils.getAdId(t)):(A.log("campaign "+t.id+" download started",A.LogLevels.info),A.cacheAdUnitAssets(F(s,t.id),t))}),0):(O([r,a,o,f,p]),0===g.length?n.resolve(I[s.cacheBase].cache):n.reject(I[s.cacheBase].cache,g,v))):(T(s,P.cachingStatus.pending)&&A.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",A.LogLevels.verbose),O([r,a,o,f,p]),0===g.length?n.resolve(I[s.cacheBase].cache):n.reject(I[s.cacheBase].cache,g,v))},S=function(e){O([f,p]),e&&(0,b())},l=function(e,t,n,i){var r,a,o=i&&i.hasOwnProperty("file")?i.file:null,s=!(!i||!i.hasOwnProperty("status"))&&i.status,d=[];if((r=k(e,t))&&ne(s,h,o,r.assets,c)){if(c.cacheBase=e.cacheBase,h[o]={isSuccessfullyCached:s},!ie(n,o,h,r.assets,m,c))return void m++;m=0}if(D[e.cacheBase][t].push(i),r&&r.id&&D[e.cacheBase][r.id].length===r.assets.length)if(A.log("campaign "+r.id+" download finished!",A.LogLevels.info),u=K(D[e.cacheBase][r.id],function(e){return e.status}),a=B(D[e.cacheBase][r.id],r,function(e){return e.status}),0===r.assets.length&&(u=!0),delete D[e.cacheBase][r.id],u){if(r.cachingStatus=P.cachingStatus.queued,0<=I[e.cacheBase].evaluatedCache.length){E(e,r.id,!1),r.numOfAssetsCached=r.assets.length,N(r,e),d=I[e.cacheBase].cache.map(function(e){return A.AdUtils.getAdId(e)}),e.inventoryId=r.inventoryId,e.demandSourceName=r.demandSourceName;var l=jQuery.extend(!0,{},e,{inventoryId:r.inventoryId,demandSourceName:r.demandSourceName});y.PubSub.publish("Cache.cacheUpdated",[l])}else A.log("Cache full, could not enter new ad",A.LogLevels.error);0<d.length?(A.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+d,A.LogLevels.verbose),A.setCachePriorityArrayKey(e,d).always(function(){b()})):b()}else E(e,t,!1),U(e),f=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.log("in delete failure from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?S(!0):S(!1))}),p=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){A.log("in delete success from cache next",A.LogLevels.verbose),A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),S(!0))}),g.push(r.id),a&&v.push({id:r.id,failedAssetsUrlsArray:a.failedAssetsUrlsArray}),A.deleteFolder(n)};return r=y.PubSub.subscribe(C+".assetCached",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCached",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!0};-1!==jQuery.inArray(r.id,d)?y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached success: "+r.id+"/"+e.file,A.LogLevels.verbose),i={cacheBase:r.type},k(i,r.id).numOfAssetsCached++,l(i,r.id,a,o)):A.log("Exiting asset cached. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error):A.log("ad is not recognised in this scope: "+r.id+" adForCaching:"+d,A.LogLevels.info)}}),a=y.PubSub.subscribe(C+".assetCachedFailed",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("asset cached failed: "+r.id+"/"+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},l(i,r.id,a,o)):A.log("Exiting asset cached failed. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),o=y.PubSub.subscribe(C+".preCacheFileFail",function(e,t,n){if(A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",n).didSucceed){var i,r=V(e.path),a=decodeURIComponent(e.path),o={file:e.file,status:!1};-1!==jQuery.inArray(r.id,d)&&(y.Utils.isDefined(D[r.type][r.id])&&r.type===s.cacheBase?(A.log("pre cache file fail: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),i={cacheBase:r.type},l(i,r.id,a,o)):A.log("Exiting preCache file fail. folder:"+r.id+" responses array:"+JSON.stringify(D),A.LogLevels.error))}}),b(),n.promise()}var l=function(e,t){return e&&e.files&&Array.isArray(e.files)&&"ads"===t},c=function(e){var t;try{t=parseInt(e)}catch(e){t=0}return t},u=function(e,t,n){var i,r;for(i in t)if(t.hasOwnProperty(i)){if("userUniqueId"===i||"applicationUserId"===i||"applicationKey"===i)continue;if("files"===i){e.cache=t[i];continue}if(l(t[i],n)){e.cache.push({id:i,numOfAssetsCached:y.Utils.isDefined(t[i].files)?t[i].files.length:0,lastUpdateTime:y.Utils.isDefined(t[i].lastUpdateTime)?c(t[i].lastUpdateTime):0,assets:y.Utils.isDefined(t[i].files)?t[i].files:[]});continue}if("lastUpdateTime"===i)return;r=A.isRootFolder(i)?e:(P.initCacheBase(i),e[i]),u(r,t[i],i)}},f=function(e){y.Utils.isDefined(e)&&e&&e!=={}?u(I,e):I={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},V=function(e){var t=decodeURIComponent(e).split("/");return{type:t[0],id:y.Utils.isDefined(t[1])?t[1]:null}},p=function(e){var t=e.split("#");return 1<t.length?t[t.length-1]:(t=e.split("/"))[t.length-1]},M=function(e,t){var n,i=-1,r=p(t),a=e.length;for(n=0;n<a;n++)if(p(e[n])===r){i=n;break}return i},E=function(e,t,n){var i,r=I[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<I[e.cacheBase].cacheQueue.length;i++)r[i].id!=t?a.push(r[i]):(o&&!n&&a.push(r[i]),o=!0);I[e.cacheBase].cacheQueue=a},g=function(i,e){var t,n,r,a,o=0,s=I[i.cacheBase].cache.length,d=[],l=[],c=jQuery.Deferred(),u=function(e,t){-1!==jQuery.inArray(decodeURIComponent(e.path),d)&&(e.success=t,l.push(e),l.length>=d.length&&(O([r,a]),K(l,function(e){return y.Utils.isDefined(e.success)&&e.success})?c.resolve():c.reject()))};if(a=y.PubSub.subscribe(C+".deleteFolderFailed",function(e){A.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&-1!==e.path.indexOf(i.cacheBase)&&(A.log("deleting folder failed: "+JSON.stringify(e),A.LogLevels.error),y.Utils.isDefined(e.errCode)&&1==e.errCode?u(e,!0):u(e,!1))}),r=y.PubSub.subscribe(C+".deleteFolderSuccess",function(e){if(A.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&-1!==e.path.indexOf(i.cacheBase)){A.log("deleting folder success: "+JSON.stringify(e),A.LogLevels.info),u(e,!0);var t=V(e.path);if(null!==t.id){var n={};n.cacheBase=t.type,n.id=t.id,n.inventoryId=t.inventoryId,y.PubSub.publish("Cache.campaignDeleted",[n])}}}),-1!==[h,S].indexOf(i.cacheBase))I[i.cacheBase].cache=[],I[i.cacheBase].cacheQueue=[],d.push(i.cacheBase);else{for(o=0;o<s;o++)y.Utils.isDefined(I[i.cacheBase].cache[0].id)||A.log("something went wrong. len="+s+" cache size= "+I[i.cacheBase].cache.length+" first element="+JSON.stringify(I[i.cacheBase].cache[0]),1),t=I[i.cacheBase].cache[0].id.toString(),y.Utils.isDefined(t)&&-1===jQuery.inArray(t,e)&&(n=i.cacheBase+"/"+t,-1===jQuery.inArray(n,d)&&d.push(n)),I[i.cacheBase].cache.shift();for(s=I[i.cacheBase].cacheQueue.length,o=0;o<s;o++)t=I[i.cacheBase].cacheQueue[0].id,y.Utils.isDefined(t)&&I[i.cacheBase].cacheQueue[0].cachingStatus!==P.cachingStatus.none&&(n=i.cacheBase+"/"+t,-1===jQuery.inArray(n,d)&&d.push(n)),I[i.cacheBase].cacheQueue.shift()}if(0===d.length)O([r,a]),c.resolve();else for(A.log("Removing irrelevant campaigns: "+JSON.stringify(d)),o=0;o<d.length;o++)A.deleteFolder(d[o]);return c.promise()},v=function(e,t){var n,i=null,r=I[e.cacheBase].cache,a=I[e.cacheBase].cache.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},k=function(e,t){var n,i=null,r=I[e.cacheBase].cacheQueue,a=I[e.cacheBase].cacheQueue.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},K=function(e,t){var n,i=e.length,r=!0;for(n=0;n<i;n++)r=r&&t(e[n]);return r};function B(e,t,n){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,t){if(!e||!e.assets)return null;var n=e.assets;t=t.split("?")[0];for(var i=0;i<n.length;i++){if(t&&-1!==n[i].indexOf(t))return n[i].split("?")[0]}return null};for(i=0;i<r;i++)if(!n(e[i])){var s=o(t,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var m=function(){y.PubSub.subscribe(C+".printCache",function(e){y.Utils.isDefined(e.type)&&r(e.type)})},e=function(n,i,e){var r=0,a=!1;return jQuery.each(I[e.cacheBase].cache,function(e,t){if(0<jQuery.grep(n,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t)}).length&&i<=++r)return!(a=!0)}),a},R=function(t,e,n,i){var r,a=t.slice(0,e),o=[];for(I[i.cacheBase].evaluatedCache=[],r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&j(e,a[r])}).length&&I[i.cacheBase].evaluatedCache.push(a[r]);for(r=0;r<a.length;r++)0===jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(a[r])&&!j(e,a[r])}).length&&o.push(a[r]);for(r=e;r<t.length;r++)0<jQuery.grep(I[i.cacheBase].cache,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(t[r])&&j(e,t[r])}).length&&o.push(t[r]);var s,d=t.length;for(r=0;r<I[i.cacheBase].cache.length;r++)0===jQuery.grep(t,function(e){return A.AdUtils.getAdId(e)===A.AdUtils.getAdId(I[i.cacheBase].cache[r])}).length&&(I[i.cacheBase].cache[r].inventoryIndex=++d,o.push(((s=I[i.cacheBase].cache[r]).adId=s.id,s.staticContent=s.assets,s)));return I[i.cacheBase].mergedAds=o.slice(0,n),I[i.cacheBase].mergedAds},j=function(e,t){if(!e||!t)return A.log("line[750]: entering isCachedAdStillUpdated with no ad",A.LogLevels.verbose),!1;var n=$(e.assets),i=$(t.staticContent);return A.log("cachedAdNumOfUniqueAssets: "+n+", newAdNumOfUniqueAssets:"+i,A.LogLevels.verbose),n===i&&(W(t)||e.lastUpdateTime==t.lastUpdateTime)},W=function(e){return e&&"0"!==e.creativeId},_=function(e,t){return I[t]&&-1<I[t].cache.indexOf(e)};function G(e){if(!e)return null;var t=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!t)return null;for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.id===e)return i}return null}function H(e){return e&&e.assets?e.assets.length:0}function q(){var e=I[o.adsAssetsCacheDir]&&I[o.adsAssetsCacheDir].cache;if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n].id);return t}function Q(e){var t=G(A.AdUtils.getAdId(e));return!(!t||!e.adAssets||H(t)!==e.adAssets.length)}function J(e,t){var n=G(t);return!(!e||!n)&&!(!n.assets||-1===n.assets.indexOf(e))}function z(e,t){if(e&&t&&Array.isArray(t)&&0!==t.length){var n=A.AdUtils.getAdId(e);I[o.adsAssetsCacheDir]||(I[o.adsAssetsCacheDir]={}),I[o.adsAssetsCacheDir].cache||(I[o.adsAssetsCacheDir].cache=[]);for(var i=I[o.adsAssetsCacheDir].cache,r=0;r<i.length;r++){i[r].id===n&&i.splice(r,1)}var a={id:n,assets:t,lastUpdateTime:e.lastUpdateTime?e.lastUpdateTime:0,inventoryIndex:y.Utils.isDefined(e.inventoryIndex)?e.inventoryIndex:-1};i.push(a)}}var X=function(e,t,n){var i=v(e,t);i&&(i.inventoryIndex=n)},$=function(e){var n,i=[];return e?(jQuery.each(e,function(e,t){n=p(t),-1===M(i,n)&&i.push(n)}),i.length):(A.log("cannot extract unique assets count",A.LogLevels.error),-1)},Y=function(e){var t={id:A.AdUtils.getAdId(e),demandSourceName:e.demandSourceName,assets:e.staticContent||[],lastUpdateTime:y.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:P.cachingStatus.none,preProcessing:e.preProcessing||y.Utils.returnResolvedPromise};return y.Utils.isDefined(e.credits)&&(t.credits=e.credits),y.Utils.isDefined(e.inventoryIndex)&&(t.inventoryIndex=e.inventoryIndex),t},Z=function(e,t){var n={};n.failedCachedFile=e,n.listOfFilesUrls=t,e=e.split("?")[0];for(var i=0;i<t.length;i++)if(-1!==t[i].indexOf(e))return t[i];return!1},ee=function(e,t,n,i,r,a,o){return{cacheBase:e,productType:t,demandSourceName:n,file:i,currentRetryAttempt:r,totalRetryAttempts:a,assetType:o}},te=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},ne=function(e,t,n,i,r){return n&&i&&0<i.length&&(!e||t[n])&&te(r)},ie=function(e,t,n,i,r,a){var o,s=!0,d=Z(t,i),l=a.retryAttempts,c=a.retryInterval,u={cacheBase:e,failedCachedFile:t,listOfFilesUrls:i};if(d)return n[t].isSuccessfullyCached?0<r&&n[t].isSuccessfullyCached&&(o=ee(e,a.productType,a.demandSourceName,d,r,l,a.assetType),y.PubSub.publish("Cache.assetRetrySuccess",[o])):r<l?(s=!1,setTimeout(function(){A.cacheAsset(e,d)},1e3*c)):(o=ee(e,a.productType,a.demandSourceName,d,r,l,a.assetType),y.PubSub.publish("Cache.assetRetryFailed",[o])),s;y.PubSub.publish("Cache.executeRetryFileUrlEmpty",[u])},re={init:function(e,t){return P=this,n||(f(e),m(),n=!0),i(t),n},initCacheBase:function(e){I[e]||(I[e]={cache:[],currentAd:0,cacheQueue:[]}),D[e]||(D[e]={})},setAdInventoryIndex:X,cacheNext:function(e,t){return A.log("line[707]: recalling cache next",A.LogLevels.verbose),U(e),d(e,t)},incrementNextCampaign:function(e){I[e.cacheBase].currentAd=t(e)},isNextAvailable:function(e,t){return P.getCurrentAd(e,t)},setSettings:function(e,t){w[e.cacheBase]=t},getCacheSizeByType:function(e){var t=I[e.cacheBase];return t&&t.hasOwnProperty("cache")?t.cache.length:0},cacheGlobalAssets:function(e,t){return P.cacheFilesByFolder("globals",e,t)},cacheGraphicAssets:function(e,t){return P.cacheFilesByFolder("graphicAssets",e,t)},cacheFilesByFolder:function(n,i,r){var e,a,o,s,d,l=i.length,c=[],u=0,f={};if(!I.hasOwnProperty(n))return y.Utils.returnResolvedPromise();a=jQuery.Deferred();var p=I[n].cache,g=I[n].cacheQueue,v=function(e,t){if(ne(t,f,e,i,r)){if(f[e]={isSuccessfullyCached:t},r.cacheBase=n,!ie(n,e,f,i,u,r))return void u++;u=0}c.push({file:e,status:t}),m(e),c.length>=l&&(O([o,s,d]),K(c,function(e){return e.status})?(p=jQuery.map(i,function(e){return e.replace(/^.*[\\\/]/,"")}),a.resolve(p)):a.reject())},m=function(e){var t=g.indexOf(e);-1<t&&g.splice(t,1)};for(o=y.PubSub.subscribe(C+".assetCached",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"assetCached",n).didSucceed&&-1!==[h,b,S].indexOf(e.path)&&(A.log("asset cached success: "+e.file,A.LogLevels.verbose),v(e.file,!0))}),s=y.PubSub.subscribe(C+".assetCachedFailed",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",n).didSucceed&&-1!==[h,b,S].indexOf(e.path)&&(A.log("asset cached failed: "+e.file+" with error: "+e.errMsg,A.LogLevels.error),v(e.file,!1))}),d=y.PubSub.subscribe(C+".preCacheFileFailed",function(e,t,n){A.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",n).didSucceed&&-1!==[h,b,S].indexOf(e.path)&&(A.log("failed to request to save file:"+e.file+" with error "+e.errMsg,A.LogLevels.error),v(e.file,!1))}),e=0;e<l;e++)-1===M(p,i[e])?(-1===M(g,i[e])?g.push(i[e]):m(i[e]),A.cacheAsset(n,i[e])):-1!==M(p,i[e])&&v(i[e],!0);return 0===l&&O([o,s,d]),a.promise()},cacheLibsAsset:function(e){var t=jQuery.Deferred(),n=e.replace(/^.*[\\\/]/,"");return I.libs.cacheQueue.push(n),A.cacheAsset("libs",e).then(function(){!function(e){I.libs.cache.push(n);var t=I.libs.cacheQueue.indexOf(e);-1!==e&&I.libs.cacheQueue.splice(t,1)}(e),t.resolve(I.libs.cache)},function(){t.reject("Libs asset cache failed: "+e)}),t.promise()},cacheAds:function(e,t,n,i){var r,a=n.length;for(r=0;r<a;r++){var o=Y(n[r]);I[e.cacheBase].cacheQueue.push(o)}return d(e,i)},cacheSingleAd:function(e,t,n){I[e.cacheBase].cacheQueue.splice(0,0,Y(t)),P.cacheNext(e,n)},clearCacheByType:function(e,t){var n,i,r=t.length,a=[],o=null,s=[],d=jQuery.Deferred();if(0===I[e.cacheBase].cache.length&&0===I[e.cacheBase].cacheQueue.length)return d.resolve(I[e.cacheBase].cache),d.promise();for(n=0;n<r;n++)i=A.AdUtils.getAdId(t[n]),o=v(e,i),j(o,t[n])&&(s.push(i),y.Utils.isDefined(t[n].credits)&&!y.Utils.isDefined(o.credits)&&(o.credits=t[n].credits),a.push(o));return jQuery.when(g(e,s)).then(function(){I[e.cacheBase].cache=a,d.resolve(I[e.cacheBase].cache)},function(){A.log("error in clear cache by type",A.LogLevels.error),d.reject()}),d.promise()},getCurrentAd:function(t,e){var i=null;return t&&t.cacheBase&&e?(jQuery.each(e,function(e,n){return jQuery.each(I[t.cacheBase].cache,function(e,t){return!(i=A.AdUtils.getAdId(t)===A.AdUtils.getAdId(n)?t:i)}),!i}),i):null},getNextAvailableAd:function(){return{}},getCacheByType:function(e){return I[e.cacheBase]},getRootCacheStructure:function(){return I},isAdInCache:function(e,t){var n,i=!1,r=I[e.cacheBase],a=r&&r.cache?r.cache.length:0;for(n=0;n<a;n++)if(r.cache[n].id===t){i=!0;break}return i},getAdStatusInQueue:function(e,t){var n=k(e,t);return n?n.cachingStatus:null},setAppData:function(e){return A.setGlobalAppData(e)},getAppData:function(){return A.getGlobalAppData()},deleteCachedAsset:function(e,t){return A.deleteAsset(e,t)},deleteCachedListOfAssets:function(e,t){var n,i=new jQuery.Deferred,r=[],a=0;if(0===t.length)return i.resolve(0),i.promise();for(n=0;n<t.length;n++)r.push(A.deleteAsset(e,t[n]));return jQuery.when.apply(null,r).always(function(){var e=arguments;for(n in e)e[n]&&a++;i.resolve(a)}),i.promise()},deleteCachedCampaign:function(e,t){var n=e.cacheBase+"/"+t;return A.deleteFolder(n),a(e,t),s(e,t)},isAssetInCache:_,isAssetInAdsCacheFolder:J,getCachedAdFolder:G,getAmountOfAssetsInAdFolder:H,isAdExistInCacheAndContainsAllAssets:Q,setAdInAdsFolder:z,mergeCampaigns:R,areCampaignsAvailable:e,getFileIndexInCache:M,removeAdFromCacheArray:a,cachingStatus:{none:0,pending:1,queued:2}};return re}e.exports=n},{"./Cache/CacheConstants":115}],110:[function(e,t,n){t.exports=function(i,c,u,f){function p(e,t,n){i.PubSub.publish("AdsAssetsClearanceService.cacheReachedMaximumCapacity",[{demandSourceName:e.demandSourceName,productType:e.productType,maxAdsToSaveInCache:t,amountOfAdsCached:n}])}return{enactClearanceLogic:function(e,t,n,i,r){var a,o=function(e){for(var t=[],n=[],i=e.length,r=0;r<i;r++)c.isAdExistInCacheAndContainsAllAssets(e[r])?n.push(e[r]):t.push(e[r]);return{adsFromFeedThatAreNotInCache:t,adsThatWereAlreadyInTheCache:n}}(e),s=o.adsFromFeedThatAreNotInCache,d=c.getCacheSizeByType(n);if(t=function(e,t,n){for(var i=e,r=f.getAdIdsOfAds(n),a=0;a<i&&a<t.length;a++){var o=t[a].isCacheable,s=f.getAdId(t[a]),d=-1!==r.indexOf(s);o&&!d||e--}return e}(t,e,o.adsThatWereAlreadyInTheCache),a=s,t<=0||0===a.length||d+t<=i)return{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache};var l=function(e){for(var t=c.getCacheByType(e).cache,n=[],i=t.length,r=0;r<i;r++){var a=t[r];0===u.getReferenceCountOfAd(a.id)&&n.push(a)}return n}(n);return 0===l.length?(p(r,i,d),{adsToCache:s,adsToRemoveFromCache:[],adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}):{adsToCache:s,adsToRemoveFromCache:function(e,t,n,i,r){var a=e+n-i,o=t.length;if(o<a)return p(r,i,e),t;if(o===a)return t;if(a<o){var s=t.splice(0,a);return s}}(d,l,t,i,r),adsThatWereAlreadyCached:o.adsThatWereAlreadyInTheCache}}}}},{}],111:[function(r,e,t){e.exports=function(v,m,h){var o,b,s,S=r("./CacheConstants"),y=new(r("./CacheUtils"))(v),A=new(r("../../patches/PatchCacheFileEncoding")),d=new(r("./AdsReferencesManager")),u={},C={},i={};function f(e,t,n,i){var r=m.AdUtils.getAdId(t);if(!y.isAssetValid(e))return v.Utils.returnRejectedPromise(S.errors.cacheAssetInvalidParams);var a=e[S.assetKeys.URL],o=y.extractFileNameFromURL(a);if(!o)return w("urlNotMatched",{demandSourceName:n.demandSourceName,productType:n.productType,asset:e,ad:t}),v.Utils.returnRejectedPromise(S.errors.cacheAssetInvalidParams);if(b.isAssetInAdsCacheFolder(o,r))return e[S.assetKeys.file]=o,v.Utils.returnResolvedPromise(e);var s,d,l,c,u,f,p=new jQuery.Deferred,g=y.buildAdFolderPath(r);return s=e,d=g,l=p,c=[],u=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",function(e){e[S.assetKeys.path]===d&&A.isFileNameMatches(e[S.assetKeys.file],y.extractFileNameFromURL(s[S.assetKeys.URL]))&&(v.PubSub.clearHandlers(c),s[S.assetKeys.path]=y.buildAdAssetsPath(e[S.assetKeys.path],e[S.assetKeys.file]),s[S.assetKeys.file]=e[S.assetKeys.file],l.resolve(s))}),f=v.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedFailure",function(e){A.isFileNameMatches(e[S.assetKeys.file],y.extractFileNameFromURL(s[S.assetKeys.URL]))&&(v.PubSub.clearHandlers(c),l.reject("failed caching file "+e[S.assetKeys.file]))}),c.push(u,f),h.saveFileWithRetry(a,g,n,i),p.promise()}function p(n,i,e){var t,r,a=m.AdUtils.getAdId(n);if(!a)return v.Utils.returnRejectedPromise("Failed to cache ad "+a||m.AdUtils.getBannerId(n));if(!n.isCacheable)return v.Utils.returnResolvedPromise();if(b.isAdExistInCacheAndContainsAllAssets(n))return v.Utils.returnResolvedPromise();if(t=a,u.hasOwnProperty(t))return r=a,u.hasOwnProperty(r)?u[r]:v.Utils.returnResolvedPromise();var o,s,d=new jQuery.Deferred;o=a,s=d.promise(),u.hasOwnProperty(o)||(u[o]=s);for(var l=[],c=0;c<n.adAssets.length;c++)l.push(f(n.adAssets[c],n,i,e));return jQuery.when.apply(null,l).then(function(){var e=v.Utils.convertArrayLikeObjectToArray(arguments);!function(e,t){if(t&&Array.isArray(t)){for(var n=[],i=0;i<t.length;i++){var r=t[i];r&&r.hasOwnProperty(S.assetKeys.file)&&n.push(r[S.assetKeys.file])}b.setAdInAdsFolder(e,n)}}(n,e),g(a),w("saveAdInCacheSuccess",{demandSourceName:i.demandSourceName,productType:i.productType,ad:n}),d.resolve()},function(e){I(m.AdUtils.getAdId(n),i.instanceUniqueId),w("saveAdInCacheFailure",{demandSourceName:i.demandSourceName,productType:i.productType,ad:n});var t=y.buildAdFolderPath(a);!function(t,n,i,r,a){var o=[],s=m.AdUtils.getAdId(t),e=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",l),d=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",l);function l(e){e.path===n&&(v.PubSub.clearHandlers(o),w("deleteAdFromCacheSuccess",{demandSourceName:a.demandSourceName,productType:a.productType,ad:t}),g(s),r.reject("ad "+s+" failed to cached with reason: "+i))}o.push(e,d)}(n,t,e,d,i),h.deleteFolder(t)}),d.promise()}function g(e){u.hasOwnProperty(e)&&delete u[e]}function D(e){C.hasOwnProperty(e)&&delete C[e]}function I(e,t){d.unsetReferenceForAd(e,t)}function l(e,t){var n,i,r,a=m.AdUtils.getAdId(e);return n=a,null===b.getCachedAdFolder(n)?v.Utils.returnResolvedPromise():(r=a,C.hasOwnProperty(r)?(i=a,C.hasOwnProperty(i)?C[i]:v.Utils.returnResolvedPromise()):function(e,t){var n,i,r=m.AdUtils.getAdId(e),a=new jQuery.Deferred;n=r,i=a.promise(),C.hasOwnProperty(n)||(C[n]=i);var o,s,d,l,c,u,f,p,g=y.buildAdFolderPath(r);return o=e,s=g,d=a,l=t,c=[],u=m.AdUtils.getAdId(o),f=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",function(e){e.path===s&&(v.PubSub.clearHandlers(c),D(u),b.removeAdFromCacheArray(y.getAdLevelCacheConfiguration(),u),w("deleteAdFromCacheSuccess",{demandSourceName:l.demandSourceName,productType:l.productType,ad:o}),d.resolve())}),p=v.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",function(e){e.path===s&&(v.PubSub.clearHandlers(c),D(u),w("deleteAdFromCacheFailure",{demandSourceName:l.demandSourceName,productType:l.productType,ad:o}),d.reject(e.errorMsg))}),c.push(f,p),h.deleteFolder(g),a.promise()}(e,t))}function w(e,t){v.PubSub.publish("AdsAssetsManager."+e,[t])}return{init:function(e,t){var n;b=e,n=i=t||{},0!==Object.keys(n).length&&m.getSegmentationAllocator().addAdLevelCacheSegment(n.adLevelCacheGroup),s=i[S.maxAdsToSaveInCache]||S.defaultMaxAdsToSaveInCache,o=new(r("./AdsAssetsClearanceService"))(v,b,d,m.AdUtils)},setAdAssetsForAds:function(e){if(e)for(var t=0;t<e.length;t++)e[t].adAssets=y.extractAssetsFromAd(e[t])},cacheAssetsOfAd:p,cacheAdsWithClearanceLogic:function(e,t,n,i,r){if(0===e.length||!t||!o)return v.Utils.returnResolvedPromise(S.errors.cacheAdsWithClearanceLogicConfigurationProblem);var a=jQuery.extend(!0,[],e);return function(e,t){if(0===e.length)return v.Utils.returnResolvedPromise();for(var n=[],i=new jQuery.Deferred,r=0;r<e.length;r++)n.push(l(e[r],t));jQuery.when.apply(null,n).then(i.resolve,i.reject),i.promise()}(o.enactClearanceLogic(a,t,y.getAdLevelCacheConfiguration(),s,i).adsToRemoveFromCache,i),function(e,t,n,i,r){function a(){return function e(t,n,i,r){n<=0||0===t.length||p(t.shift(),i,r).then(function(){e(t,--n,i,r)}).fail(function(){e(t,n,i,r)})}(e,t,i,r),v.Utils.returnResolvedPromise()}return 0<n&&!function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable)return!1}return!0}(e,n)?function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable&&!b.isAdExistInCacheAndContainsAllAssets(i))return!1}return!0}(e,n)?(w("adsAlreadyCached",{demandSourceName:i.demandSourceName,productType:i.productType}),a()):(o=jQuery.extend(!0,[],e),s=n,d=i,l=r,c=new jQuery.Deferred,function e(t,n,i,r,a){n<=0?a.resolve():0===t.length&&0<n?a.reject(S.errors.cacheMandatoryAdsFailed):p(t.shift(),i,r).then(function(){e(t,--n,i,r,a)}).fail(function(){e(t,n,i,r,a)})}(o,s,d,l,c),c.promise()).then(a):a();var o,s,d,l,c}(a,t,n,i,r)},areNonMandatoryAdsToCacheConfigured:function(e,t){return!(!v.Utils.isDefined(e)||!v.Utils.isDefined(t))&&e<t},setReferencesForAds:function(e,t){var n,i,r;if(Array.isArray(e))for(var a=0;a<e.length;a++)(r=e[a])&&r.isCacheable&&(n=m.AdUtils.getAdId(e[a]),i=t,d.setReferenceForAd(n,i))},unsetReferencesForAds:function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)I(m.AdUtils.getAdId(e[n]),t)},unsetReferencesForInstance:function(e){d.unsetAllReferencesForReferrer(e)}}}},{"../../patches/PatchCacheFileEncoding":172,"./AdsAssetsClearanceService":110,"./AdsReferencesManager":113,"./CacheConstants":115,"./CacheUtils":116}],112:[function(g,e,t){e.exports=function(l,c){var u=g("./CacheConstants"),f=new(g("../../patches/PatchCacheFileEncoding")),p=new(g("./CacheUtils"))(l);return{saveFileWithRetry:function(t,n,i,r){var a=[],o=new(g("./CacheAssetRetry"))(r,d),e=l.PubSub.subscribe("NativeCallback.assetCached",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===n&&f.isFileNameMatches(e[u.assetKeys.file],p.extractFileNameFromURL(t))&&(o.areRetryAttemptsPerformed()&&l.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetrySuccess",[{demandSourceName:i.demandSourceName,productType:i.productType,file:t,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),l.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",[e]),l.PubSub.clearHandlers(a))}),s=l.PubSub.subscribe("NativeCallback.assetCachedFailed",function(e){e.path=decodeURIComponent(e.path),e[u.assetKeys.path]===n&&f.isFileNameMatches(e[u.assetKeys.file],p.extractFileNameFromURL(t))&&(o.shouldExecuteRetry()?o.performRetryWithDelay():(o.areRetryAttemptsPerformed()&&l.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetryFailed",[{demandSourceName:i.demandSourceName,productType:i.productType,file:t,currentRetryAttempt:o.getAttemptsSoFar(),totalRetryAttempts:r.adAssetRetryAttempts}]),l.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedFailure",[e]),l.PubSub.clearHandlers(a)))});function d(){c.callSDKFunction("saveFile",{file:t,path:n,overrideExistingFile:!1})}a.push(e,s),d()},deleteFolder:function(t){if(t){var n=[],e=l.PubSub.subscribe("NativeCallback.deleteFolderSuccess",function(e){c.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===t&&(l.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",[e]),l.PubSub.clearHandlers(n))}),i=l.PubSub.subscribe("NativeCallback.deleteFolderFailed",function(e){c.isIOS()&&(e.path=decodeURIComponent(e.path)),e.path===t&&(l.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderFailure",[e]),l.PubSub.clearHandlers(n))});n.push(e,i),c.callSDKFunction("deleteFolder",{path:t},"deleteFolderSuccess","deleteFolderFailed")}}}}},{"../../patches/PatchCacheFileEncoding":172,"./CacheAssetRetry":114,"./CacheConstants":115,"./CacheUtils":116}],113:[function(e,t,n){t.exports=function(){var i={};function r(e,t){if(e&&t&&i.hasOwnProperty(e)){var n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}}return{setReferenceForAd:function(e,t){e&&t&&(i.hasOwnProperty(e)||(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t))},unsetReferenceForAd:r,unsetAllReferencesForReferrer:function(e){for(var t=Object.keys(i),n=0;n<t.length;n++)r(t[n],e)},getReferenceCountOfAd:function(e){return(t=e,t&&i.hasOwnProperty(t)?i[t]:[]).length;var t}}}},{}],114:[function(e,t,n){t.exports=function(e,t){var n=e&&e.adAssetRetryAttempts,i=e&&e.adAssetRetryInterval,r=0;return{shouldExecuteRetry:function(){return r<n&&"function"==typeof t},areRetryAttemptsPerformed:function(){return 0<r},getAttemptsSoFar:function(){return r},performRetryWithDelay:function(){setTimeout(function(){r++,t()},1e3*i)}}}},{}],115:[function(e,t,n){t.exports={assetKeys:{URL:"URL",size:"size",label:"label",path:"path",file:"file"},errors:{cacheAssetInvalidParams:"Unable to cache asset due to invalid cacheModule/adId/asset",cacheAdsWithClearanceLogicConfigurationProblem:"Unable to cacheAds due to not being in new flow/no ads/no need to cache ads/no clearance service",cacheMandatoryAdsFailed:"Failed to cache mandatory ads"},adsAssetsCacheDir:"ads",supportNewCacheStructureConfigurationKey:"supportNewCacheStructure",fileNameFromURLPattern:/[^/]+$/,adLevelCache:"adLevelCache",maxAdsToSaveInCache:"maxAdsToSaveInCache",defaultMaxAdsToSaveInCache:30}},{}],116:[function(e,t,n){t.exports=function(r){var i=e("./CacheConstants");function a(e){return i.adsAssetsCacheDir+"/"+e}function o(e,t){return"../"+e+"/"+t}function s(e){if(!e)return null;var t=e.match(i.fileNameFromURLPattern);return t&&0!==t.length?t[0].split("?")[0]:null}return{isAssetValid:function(e){return e&&"string"==typeof e[i.assetKeys.URL]},extractAssetsFromAd:function(e){e.ext&&e.ext.appData&&e.ext.appData.adAssets&&(e.ext.appData.appImages=e.ext.appData.adAssets,delete e.ext.appData.adAssets);for(var t=[],n=r.AdAssets.extractStaticFiles(e).filter(function(e,t,n){return n.indexOf(e)===t}),i=0;i<n.length;i++)t.push({URL:n[i]});return t},buildAdFolderPath:a,buildAdAssetsPath:o,extractFileNameFromURL:s,extendAssetWithLocalPath:function(e,t){if(!e)return null;var n=s(e[i.assetKeys.URL]);return jQuery.extend({},e,{file:n,path:o(a(t),n)})},getAdLevelCacheConfiguration:function(){return{cacheBase:i.adsAssetsCacheDir}}}}},{"./CacheConstants":115}],117:[function(e,t,n){"use strict";var i=function(){function e(){this.store={}}return e.prototype.setData=function(e,t){this.store[e]=t},e.prototype.getData=function(e){return this.store[e]},e.prototype.clear=function(){this.store={}},e}();t.exports=i},{}],118:[function(Le,e,t){e.exports=function(w,P,O,e,T,t,F){"use strict";var x,c,u,f,n=!1,l=e.demandSourceName,L=P.adUnitUrl,N=P.adPlayerUrl,U=P.jQuery(),p=!1,g=new(Le("./../../components/MultipleInventories")),V=new(Le("./PreloadAdManager"))(w,P),v=Le("../../components/OMIDConstants"),M=new(Le("./../../components/sdkPluginType/SDKPluginTypeHandler"))(P,w.Utils),m=new(Le("./../../components/AdFeaturesParser"))(w,P,O,U,T,!0),h=T.eventicsCategories,E={},k=T.displayMode,b=!1,r=0,i=null,K={},S=O.closeButtonStates,a=[],d=O.CB,y=null,A=0,C={},o=P[T.productType],B=new(Le("./DemandEntityBuilder.js"))(T,e),D=Le("../../patches/PatchIOSLoadAfterLoad.js")(w,P,B),R=t,s=Le("./FetchDemand/FetcherPatch.js")(w,P,T,R,O),I=P.DemandUtils,j=new(Le("./../RewardedVideo/dsTaskManager.js"))(w,P,B,O),W=Le("../../components/VastService.js")(w,P),_=new(Le("./../RewardedVideo/availabilityReporter.js"))(w,P,T,B,j),G=new(Le("./../RewardedVideo/availabilityManager.js"))(w,P,_,T),H=new(Le("./PayloadBuilder.js"))(U,P,w,B,O),q=Le("../../components/containers/WPADUtils")(P),Q=Le("../AdPlayer/AdPlayerUtils"),J=!0,z=P.InstancesTimers;function X(){return P.ImpressionsCounterService.getCountersByProduct(T.productType).bidding+1}var $=function(){a.push(w.PubSub.subscribe("StoreKit.storeKitDisplayFailed",function(e){R.trackEvent(h.storeKitDisplayFailed,{},{generalMessage:e})})),a.push(w.PubSub.subscribe("StoreKit.storeKitCoolDown",function(e){R.trackEvent(h.storeKitCoolDown,{},{generalMessage:e})})),a.push(w.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if(I.shouldReceiveMessage(B,e)){var t,n,i;if(P.log("globals ready: "+b+" initSuccess in settings: "+E.numOfBannersToInitSuccess+" adUnits: "+g.size(e.inventoryId),P.LogLevels.verbose),0===E.numOfBannersToInitSuccess)n=1,t=F.areCampaignsAvailable(oe(e.inventoryId).slice(0,n),n);else{var r=se(e.inventoryId);n=r.length;var a=Z(g.getOffers(e.inventoryId),E.numOfBannersToInitSuccess);i=a<=n?a:n,t=F.areCampaignsAvailable(r,i)}P.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,P.LogLevels.verbose),b&&t&&te(e.inventoryId)}})),a.push(w.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if(I.shouldReceiveMessage(B,e)){var t,n=-1,i={};w.Utils.isDefined(e.id)&&(t=ae(e.id,e.inventoryId),i=P.AdUtils.updateEventWithAdParams(E,t,i),n=t&&w.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1),R.trackEvent(h.campaignDeletedCache,{inventoryIndex:n},i)}})),a.push(w.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if(I.shouldReceiveMessage(B,e)){var t,n=-1,i=null,r={};w.Utils.isDefined(e.id)&&(t=ae(e.id,e.inventoryId),i=e.id,n=t&&w.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1,r=P.AdUtils.updateEventWithAdParams(E,t,r)),U.extend(r,{eNameStart:{name:h.campaignSavedCache.name+(i||"")},inventoryIndex:n}),R.trackTimingStop(h.campaignSavedCache,r)}})),a.push(w.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if(I.shouldReceiveMessage(B,e)){var t=U.extend(!0,{},h.campaignSavedCache);t.name=t.name+(e.id||""),R.trackTimingStart(t)}})),a.push(w.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){I.shouldReceiveMessage(B,e)&&P.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),P.LogLevels.verbose)})),a.push(w.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){I.shouldReceiveMessage(B,o)&&o.deletedAds&&0<o.deletedAds.length&&U.each(o.deletedAds,function(e,t){var n=ae(t,o.inventoryId),i=P.AdUtils.updateEventWithAdParams(E,n,{}),r=o.deletedAdsData;if(r&&r[e].id==t){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}R.trackEvent(h.campaignFailedToCache,{},i),ie(t,o.inventoryId)})})),a.push(w.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){I.shouldReceiveMessage(B,e)&&(w.PubSub.publish(T.productType+".fallbackToNonPrecache",[e]),R.trackEvent(h.fallbackToNonPrecache))})),a.push(w.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if(I.shouldReceiveMessage(B,e)){P.log("RV cacheAdsFailedCallback "+JSON.stringify(e),P.LogLevels.verbose);for(var t,n,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],l=ae(d,e.inventoryId),c=P.AdUtils.updateEventWithAdParams(E,l,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();c.rvnomoreoffersreason=u.substring(0,999)}R.trackEvent(h.campaignFailedToCache,{},c),ne(d,e.inventoryId)}if(0===E.numOfBannersToInitSuccess)n=1,t=F.areCampaignsAvailable(oe(e.inventoryId).slice(0,n),n);else{var f=se(e.inventoryId);n=f.length;var p=Z(g.getOffers(e.inventoryId),E.numOfBannersToInitSuccess);i=p<=n?p:n,t=F.areCampaignsAvailable(f,i)}G.cacheAdsFailed(b,t,e.errorLog,te.bind(null,e.inventoryId))}})),a.push(w.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){I.shouldReceiveMessage(B,e)&&P.log("PM | preProcessingFailedCallback "+e,P.LogLevels.verbose)})),a.push(w.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if(I.shouldReceiveMessage(B,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,{});e.assetType===O.assetType.adunitAsset?R.trackEvent(h.adUnitRetrySuccess,{generalMessage:t.substring(0,250)},n):e.assetType===O.assetType.adAsset&&R.trackEvent(h.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),a.push(w.PubSub.subscribe("Cache.assetRetryFailed",function(e){if(I.shouldReceiveMessage(B,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,{});e.assetType===O.assetType.adunitAsset?R.trackEvent(h.adUnitRetryFail,{generalMessage:t.substring(0,250)},n):e.assetType===O.assetType.adAsset&&R.trackEvent(h.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),a.push(w.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),R.trackEvent(h.executeRetryFileUrlEmpty,{},t)})),a.push(w.PubSub.subscribe("SDKController.AdTracked",function(e){I.shouldReceiveMessage(B,e)&&(e=P.AdUtils.formatParamsToAdId(e),R.trackEvent(h.adTracked),P.callSDKFunction("adCredited",I.extendCallbackParamsWithParentProductConfig(B,{credits:ae(P.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),a.push(w.PubSub.subscribe("SDKController.AdStarted",function(e){if(I.shouldReceiveMessage(B,e)&&P.RingerSwitchService.isInitiated()){var t={},n=ye();n&&n.ext&&(t=Ie(i.ext)),P.RingerSwitchService.startListener(t),P.log("Ringer | startListener ringer status from AdStarted.",P.LogLevels.info)}})),a.push(w.PubSub.subscribe("SDKController.Analytics",function(e){if(I.shouldReceiveMessage(B,e)&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?R.trackEvent(n.eName,n.label,n.data):"startTiming"===t?R.trackTimingStart(n.eName,n.data):"stopTiming"===t?R.trackTimingStop(n.eName,n.data):"setCustomData"===t&&(P.log("Controller - setCustomData received",P.LogLevels.verbose),R.updateBaseData(n.data))}})),a.push(w.PubSub.subscribe("SDKController.AdLoaded",function(e){if(I.shouldReceiveMessage(B,e)){var t,n,i,r=P.AdUtils.getAdId(e),a=ae(r,e.inventoryId),o=e.inventoryId;if(clearTimeout(x),P.log("ad loaded with params: "+JSON.stringify(e),P.LogLevels.verbose),a&&R.updateBaseData({rvPlayMethod:a.displayMode}),w.Utils.isDefined(e.errMsg)){j.publish("AdErrorState",[I.extendCallbackParamsWithDemandConfig(B,{error:!0})]),P.log("Error in loading ad: "+e.errMsg,P.LogLevels.error);var s={generalMessage:e.errMsg,vastViewCount:0};return s=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,s),s=P.AdUtils.updateEventWithAdParams(E,a,s),R.trackEvent(h.adLoadedError,{},s),he(a),t=a,n=P.AdUtils.getAdId(t),i=j.getStatus().duringEngage,ie(n,t.inventoryId),void(i&&!p?function(){P.log(T.productType+" adLoaded with error | no offers for user - show dialog",P.LogLevels.verbose),P.setCloseButtonState({productType:T.productType,demandSourceName:l,state:S.close});var e={productType:T.productType,message:c&&c.noOffers?c.noOffers:O.labels.noOffers,yes:"close",alwaysClose:!0};P.postAdUnitEvent({name:"alertUserOnError",options:e}),R.trackEvent(h.userAlert,{inventoryIndex:t.inventoryIndex||-1})}():(P.log("DemandSource | adLoaded with error - removing and moving to next offer",P.LogLevels.verbose),Se(null),P.removeAdUnit(ae(n,t.inventoryId))))}E.viewType===O.viewTypes.externalView&&R.incrementSessionNumber(),R.trackEvent(h.adLoaded,{vastViewCount:0}),w.Utils.isDefined(e.enableBackButton)&&P.setBackButtonState(e.enableBackButton),e=P.AdUtils.formatParamsToAdId(e),P.onAdLoaded(ae(P.AdUtils.getAdId(e),e.inventoryId));var d={totalNumberCredits:re(o),numOfAdUnits:g.size(o),adViewId:e.adViewId};G.adLoadedSuccessfully(d,T.forcePreload)}})),a.push(w.PubSub.subscribe("SDKController.AdError",function(e){I.shouldReceiveMessage(B,e)&&P.log("SDKController.AdError:"+JSON.stringify(e),P.LogLevels.verbose)})),a.push(w.PubSub.subscribe("SDKController.dialogBoxResume",function(e){I.shouldReceiveMessage(B,e)&&R.trackEvent(h.dialogBoxResume)})),a.push(w.PubSub.subscribe("SDKController.dialogBoxExit",function(e){I.shouldReceiveMessage(B,e)&&R.trackEvent(h.dialogBoxExit)})),a.push(w.PubSub.subscribe(T.productType+".isVisible",function(e){var t=ye();if(I.shouldReceiveMessage(B,e)&&t){P.setCurrentDisplayedAd(t);var n=P.getAdViewContainer(t);n&&n.shouldReportAdVisible()&&P.onAdVisible()}})),a.push(w.PubSub.subscribe("SDKController.adClosed",function(e){I.shouldReceiveMessage(B,e)&&(P.SKAdImpressionService.endImpression(e.ad,Fe,xe),R.resetBaseData(O.keysToResetOnAdClosed))})),a.push(w.PubSub.subscribe(T.productType+".GetConfig",function(e){if(I.shouldReceiveMessage(B,e)){P.log("Bidder ProductInstance | getConfig received");var t=ye();if(!t)return void P.log("Bidder ProductInstance | getConfig with no loaded ad");!function(e,t){var n,i,r,a,o,s,d=ae(P.AdUtils.getAdId(e),e.inventoryId);if(d){!function(e){E.requestID&&(e.requestID=E.requestID);var t,n,i,r=(t=P.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn,n=P.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+t,"prod"!==P.getEnv()&&(n=P.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),n);U.extend(!0,e,P.getFormattedDeviceData(),(i=r,{settings:{protocol:P.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:i,appKey:P.getSDKDataByKey(O.requiredSDKDataKeys.applicationKey),appOrientation:P.getSDKDataByKey(O.requiredSDKDataKeys.appOrientation),deviceLanguage:P.getSDKDataByKey(O.requiredSDKDataKeys.deviceLanguage),bundleId:P.getSDKDataByKey(O.requiredSDKDataKeys.bundleId),sdkAbName:P.getSDKDataByKey(O.requiredSDKDataKeys.sdkAbName),deviceId:P.getDeviceId(),skOverlaySupported:P.SKOverlayManager.isSKOverlaySupported()}}))}(d),s=(n=d).displayMode!=k.softprecache&&F.isPrecache(),n.settings.omidUrl=(i=n,r=P.OMIDService.getVersionData().omidVersion,P.OMIDService.isAdOmidSupported(i)&&v.omidVersionRequiresWebviewPerAd[r]?P.OMIDService.getOmidBundleUrl():""),void 0===n.productType&&(n.productType=B.productType),void 0===n.demandSourceName&&(n.demandSourceName=B.demandSourceName),void 0!==n.settings.cw&&(n.settings.cw=(a=n,o=P.getDeviceOs(),a.settings.cw&&a.settings.cw.hasOwnProperty(o)?a.settings.cw[o]:a.settings.cw)),n.displayOnAdReady=E.displayOnAdReady,n.settings.precache=s,n.settings.sessionDepth=X(),n.settings.viewType=E.viewType,w.AdAssets.isAdAbleToCache(n)&&(n.settings.ableToCache=n.ext.ableToCache,delete n.ext.ableToCache);var l=function(e){var t=JSON.parse(JSON.stringify(e));function n(e,t,n){e.hasOwnProperty(t)&&"object"==typeof e[t]&&(n?U.extend(!0,e,e[t]):U.extend(e,e[t]),delete e[t])}return n(t,"ext",!1),n(t,"features",!1),n(t,"settings",!0),t}(d);t&&t.callback&&t.callback.call(null,l)}else P.log("line[456]: no current available ad",P.LogLevels.verbose)}(t,e)}})),a.push(w.PubSub.subscribe(T.productType+"isVisible",function(e){if(P.log("Bidder ProductInstance | isVisible"),I.shouldReceiveMessage(B,e)){var t=ye();if(P.isAdDisplayed(t))return void P.log("Bidder ProductInstance | isVisible | isAdDisplayed=true");if(!t)return void P.log("Bidder ProductInstance | isVisible | ad is null");P.getCurrentDisplayedAdType()!==T.productType&&P.getCurrentDisplayedAd()||P.setCurrentDisplayedAd(t)}}))};function Y(e){var t={};if(w.Utils.isDefined(e.ad)){var n=e.ad&&w.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;t=P.AdUtils.updateEventWithAdParams(E,e.ad,t),U.extend(t,{inventoryIndex:n})}return t}a.push(w.PubSub.subscribe("ExternalContainer.duringCreation",function(e){I.shouldReceiveMessage(B,e)&&R.trackEvent(h.duringCreation)}));var Z=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},ee=function(){j.publish("InitiatedAPICall",[I.extendCallbackParamsWithProductConfig(B,{duringInit:!1})])},te=function(e){var t,n,i;if(P.log("Bidder ProductInstance | handlePossibleAdUnitsReady",P.LogLevels.verbose),de(e)){var r=g.size(e),a=re(e);ee(),T.forcePreload||G.canReportAvailable(r,a),n=de(t=e),i=F.isPrecache(),V.canPreloadCandidateAd(!1,!1,n,!1,i,E.displayOnAdReady)&&function(e){var t=new U.Deferred;if(!j.canPreload())return P.log("Cannot preload at this time, "+j.getStatusMsg(),P.LogLevels.error),w.Utils.returnRejectedPromise(O.errors.showAdFailedReasons.taskManagerPreload);var n=ye()||de(e);n?(U.extend(!0,n,B),Pe(n,!1,t),t.promise()):(P.log("Cannot preload with no offer",P.LogLevels.error),w.Utils.returnRejectedPromise(O.errors.showAdFailedReasons.preloadNoAd))}(t)}},ne=function(e,t){g.removeOfferById(e,t)&&!g.isEmpty(t)&&F.incrementNextCampaign()},ie=function(e,t){var n=g.getOfferById(e,t);n?n.toRemove=!0:P.log("Error in mark current ad to be removed:"+e,P.LogLevels.error)},re=function(e){for(var t=0,n=g.getOffers(e),i=g.size(e),r=0;r<i;r++)t+=n[r].credits;return t},ae=function(e,t){var n=g.getOfferById(e,t);return n||P.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(g.getOffers(t)),1),n},oe=function(e){return U.grep(g.getOffers(e),function(e){return!(w.Utils.isDefined(e.toRemove)&&e.toRemove)})},se=function(e){var t=oe(e);return U.grep(t,function(e){return e.isCacheable})},de=function(e){var t,n=ae(P.AdUtils.getAdId(ue(e)),e);return t=F.isPrecache()&&n&&n.isCacheable?(n=ae(P.AdUtils.getAdId(ce(e)),e),k.precache):k.nonprecache,n&&!n.displayMode&&le(n,t),n},le=function(e,t){e&&(e.displayMode=t)},ce=function(e){return 0===E.numOfBannersToInitSuccess?F.getCurrentAd(oe(e).slice(0,1)):F.getCurrentAd(oe(e))},ue=function(e){return g.getCurrentOffer(e)},fe=function(e){p=!1;var t=P.AdUtils.getAdId(e);j.publish("Engaged",[I.extendCallbackParamsWithProductConfig(B,{duringEngage:!1})]);var n=ae(t,e.inventoryId);clearTimeout(x),n?(P.log("onEngageEnd with params: "+JSON.stringify(n),P.LogLevels.verbose),w.Utils.isDefined(n)&&n.toRemove&&(P.AdsAssetsManager.unsetReferencesForAds([e],B.instanceUniqueId),P.log("removing ad id: "+t,P.LogLevels.verbose),ne(t,n.inventoryId))):P.log("Tried to end engage with no ad",P.LogLevels.error)},pe=function(e){var t=new U.Deferred;if(w.Utils.isDefined(e.response)&&w.Utils.isDefined(e.response.errorCode)){ee();var n=w.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:T.errors.init[1003];t.reject(n)}else w.Utils.isDefined(e.seatbid)&&w.Utils.isDefined(e.seatbid.bid)&&w.Utils.isDefined(e.seatbid.ext)&&w.Utils.isDefined(e.seatbid.ext.labels)?t.resolve(e):(ee(),t.reject(T.errors.init[1004]));return t.promise()},ge=function(e){var s=function(e){return E.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(be),function(e){if(e){var t={blacklistedCampaigns:e.join(",")};P.getTokenService().updateToken(t)}}(o.filteredListService.getFilteredListCampaigns())),w.Utils.returnResolvedPromise()},d=function(e){return function(e){for(var t=0;t<e.length;t++){var n=e[t].ext.layoutData;if(w.Utils.isDefined(n)&&w.Utils.isDefined(n.html)&&0<n.html.length)return!0}return!1}(e)?P.libsManager.manageDownloadLibsFileByFiletype(T.libsCacheFiles.dapi):w.Utils.returnResolvedPromise()},l=function(t){return F.isPrecache()&&function(e){for(var t=!1,n=0;n<e.length;n++)if(P.AdUtils.isPlayablePrecachedAd(e[n])){t=!0;break}return t}(t)?P.libsManager.manageDownloadLibsFileByFiletype(T.libsCacheFiles.externalObfuscation).then(function(e){!function(e,t){for(var n=0;n<e.length;n++)P.AdUtils.isPlayablePrecachedAd(e[n])&&(e[n].ext.ableToCache="success"===t)}(t,e)}):w.Utils.returnResolvedPromise()};return function(e){j.setConnection(!0);var t,n,i=e.seatbid.bid,r=e.seatbid.ext,a=g.getAvailableInventoryId(),o=0<i.length&&Q.shouldUseAdPlayer(!!P.getConfig().mobileSDKSettings.ext.adPlayerVersion,P.getDeviceOs(),i[0]);return P.log("should use ad-player? "+o),R.updateBaseData({landingId:r.landingId,strategyId:r.strategyId,adSource:r.adSource,rvnomoreoffersreason:r.dspName}),f=r.deliveryPlumbus,U.when((n=e,void(E=m.parse(n))),(t=r,u=t.labels,void(t.templateid==T.customDialog?u.confirmCloseMsg[O.confirmCloseMsgMap[0]].alwaysClose=!0:c=t.labels))).then(function(e){e&&P.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}.bind(null,E)).then(function(e){e&&e.hasOwnProperty(O.numOfBannersToInitSuccess)&&e.hasOwnProperty(O.numOfBannersToCache)&&R.updateBaseData({cacheConfig:e[O.numOfBannersToInitSuccess]+"/"+e[O.numOfBannersToCache]})}.bind(null,E)).then(P.CampaignsFilter.filterByAppInstalled.bind(null,i,E,T.filterDisableTypes)).then(s).then(function(e){for(var t=e&&e.length||0,n="",i=0;i<t;i++)n+=P.AdUtils.getAdType(e[i],E),i<t-1&&(n+=", ");return R.updateBaseData({feedSize:t,feedCampaignOrder:n}),w.Utils.returnResolvedPromise()}.bind(null,i)).then(function(e){return e.some(function(e){return P.OMIDService.isAdOmidSupported(e,T.productType)})&&P.OMIDService.downloadOmidJsBundle(),w.Utils.returnResolvedPromise()}.bind(null,i)).then(F.decidePrecacheStatus.bind(null,{numOfCampaigns:i.length,settings:E})).then(function(){return G.setAMSettings({preFetchAllVasts:E.preFetchAllVasts,isPreCache:F.isPrecache(),numOfBannersToInitSuccess:E.numOfBannersToInitSuccess,reportOnAdunitReady:E.reportOnAdunitReady}),i&&0<i.length?(b=!1,C={productType:T.productType,demandSourceName:B.demandSourceName,retryAttempts:E.adunitRetryAttempts||15,retryInterval:E.adunitRetryInterval||1,assetType:O.assetType.adunitAsset},o?w.Utils.returnResolvedPromise():P.adUnitGlobals.updateAdUnitGlobals(!0,E.purgeAdunitLibsFile,C,R)):w.Utils.returnRejectedPromise(O.errors.noFill)}).then(function(){return o?w.Utils.returnResolvedPromise():U.when(d(i),l(i))}).then(function(e){return e?P.getAdPlayerAssets().prepareAdPlayerAssets(C):w.Utils.returnResolvedPromise()}.bind(null,o)).then(P.AdsAssetsManager.setAdAssetsForAds.bind(null,i)).then(function(e){for(var t=0;t<e.length;t++)e[t].isCacheable=0<e[t].adAssets.length}.bind(null,i)).then(P.AdsAssetsManager.setReferencesForAds.bind(null,i,B.instanceUniqueId)).then(function(e){U.each(e,function(e,t){t.inventoryIndex=e})}.bind(null,i)).then(function(r,a,e){var t,o=new U.Deferred,s=P.AdsAssetsManager.cacheAdsWithClearanceLogic(r,a.numOfBannersToCache,a.numOfBannersToInitSuccess,e,De(a)).then(function(){clearTimeout(t),o.resolve()}).fail(function(e){clearTimeout(t),o.reject(e)});return t=setTimeout(function(){var e=s.state();if("pending"===e||"rejected"===e){var t={};if(a&&a.addExtraMPDataToEvent&&r[0]){var n=r[0],i={custom_a:n&&n.ext&&n.ext.videoData&&n.ext.videoData.videoSource&&n.ext.videoData.videoSource.videoformat_mp4||"empty",generalmessage:n&&n.ext&&n.ext.appData&&n.ext.appData.appImages&&n.ext.appData.appImages.portrait[0]||"empty"};t=P.AdUtils.updateEventWithAdParams(a,n,i)}R.trackEvent(h.adLevelCachingTimeout,{callfailreason:"ad level timeout expired when caching ads"},t),o.reject("cacheAdsAssets timeout expired")}"resolved"===e&&o.resolve()},T.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),o.promise()}.bind(null,i,E,B)).then(function(){b=!0;var e=g.setOffers(i.slice(0),a);0!==E.numOfBannersToInitSuccess||T.forcePreload||G.reportAdAvailable({numOfAdUnits:g.size(e),totalNumberCredits:re(e)}),te(e)}).fail(function(e){var t=e||"Fail parse adUnit info from api response";P.AdsAssetsManager.unsetReferencesForAds(i,B.instanceUniqueId),g.removeInventory(a),Ae(),Se(null),e&&P.log(e,P.LogLevels.error),G.inventoryEmpty(e||t)}),(new U.Deferred).resolve(U.extend(!0,{},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)};function ve(e){j.publish("Engaged",[I.extendCallbackParamsWithProductConfig(B,{duringEngage:e})])}var me=function(e,t,n){var i,r=P.AdUtils.getAdId(e);P.log("Error in loading ad - timeout in "+r,P.LogLevels.error),i=n?h.showAdFail:h.adLoadedError;var a,o,s={isprecache:F.isPrecache()};s=P.AdUtils.updateEventWithAdParams(E,e,s),R.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},s),I.extendCallbackParamsWithProductConfig(B,e),ie(r,e.inventoryId),Se(null),W.removeIframe((a=r,o="",w.Utils.isDefined(B.demandSourceName)&&(o=B.demandSourceName),o+=B.productType+a)),E.viewType===O.viewTypes.externalView?P.removeAdUnitFromExternal(e):P.removeAdUnit(e)},he=function(e){e&&e.cid?P.blacklistService.addToBlacklistedCampaigns(B.productType,B.demandGroupName,e.cid):P.log("DemandSource | cannot add to blacklist with no ad",P.LogLevels.error)},be=function(e){e&&e.cid&&o.filteredListService.addToFilteredListCampaigns(e.cid)},Se=function(e){i=e},ye=function(){return i},Ae=function(){G.reset(),V.reset()},Ce=function(){for(var e=Object.keys(g.getInventories()),t=0;t<e.length;t++)P.AdsAssetsManager.unsetReferencesForAds(g.getOffers(e[t]),B.instanceUniqueId)};function De(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Ie(e){return e?{ringerUpdateDelay:E.ringerUpdateDelay,shouldSetRingerUpdateDelay:P.AdUtils.isPlayableCampaign(e)||P.AdUtils.isMRAIDCampaign(e)||P.AdUtils.isExternalCampaign(e)}:{}}function we(e,t){P.log(t,P.LogLevels.error);var n=I.extendCallbackParamsWithDemandConfig(B,{errMsg:t});w.PubSub.publish(T.productType+".failedToShow",[n]);var i=t;i!==O.errors.showAdFailedReasons.preloadNoAd&&i!==O.errors.showAdFailedReasons.showNoAd&&(i+=j.getStatusMsg()),R.trackEvent(h.showAdFail,{callFailReason:i}),P.callSDKFunction(e,I.extendCallbackParamsWithDemandConfig(B,{errMsg:t})),t!==O.errors.showAdFailedReasons.onAdVisibleFailed&&t!==O.errors.showAdFailedReasons.screenVisibleTimeout||ve(!1)}function Pe(e,t,n){P.log("Bidder ProductInstance | preloadFlow"),V.preloadAdFinished();var i,r,a,o,s,d,l,c=!1,u=F.isPrecache();e.displayMode===k.softprecache&&(c=!0),o=c,s=e,d=!1,u&&!o&&(P.AdUtils.isPlayablePrecachedAd(s)?w.AdAssets.isAdAbleToCache(s)&&(d=!0):d=!0),d&&(i=e,r=P.AdUtils.getAdId(i),a=F.getConfig().precachePath+r+"/",w.AdAssets.updateAdunitPrecachePath(i,a,P.AdUtils.isPlayablePrecachedAd(i),P.isAndroid())),e.isWPAD=q.shouldDisplayAdOnExternalWebView(e,E),l=e.isWPAD?(P.AdUtils.setViewType(E,e,O.viewTypes.externalView),K.shouldBuildAdUnitUrlForExternal=!0,2):(P.log("Bidder ProductInstance | ad is not WPAD"),P.AdUtils.removeViewTypeFromSetting(E),K.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=l;var f=P.AdUtils.updateEventWithAdParams(E,e,{});U.extend(f,{displaystrategy:l}),R.updateBaseData(f),Se(e);var p,g,v,m,h,b,S,y,A,C=!c&&u,D=!!P.getConfig().mobileSDKSettings.ext.adPlayerVersion,I=P.getDeviceOs();p=Q.shouldUseAdPlayer(D,I,e)?N.getAdPlayerUrl(C,I,B,K):L.getAdunitUrl(C,B,K,I),g=e,v=p,m=t,h=T.timerLengths.loadAdTimeout,clearTimeout(x),x=setTimeout(function(){me(g,v,m)},h),U.extend(E,{preload:!0}),P.AdUtils.setViewType(E,e),M.shouldShowInStandAloneView(P.getConfig())&&P.AdUtils.extendSettingsWithStandaloneViewSupport(E),e=P.StoreKitService.updateAdWithStoreAppId(e,E),P.loadAdUnitUrl(e,p,B,E),e.isWPAD?(b=e,S=n,y=P.getContainerCreationHandler(b),(A=y.getState())===y.getCreationStates().createdSuccessfully?(P.log("product instance | containerState | createdSuccessfully ",P.LogLevels.info),S.resolve(b)):A===y.getCreationStates().duringCreation?U.when(y.getCreationResultPromise()).then(function(){P.log("product instance | during creation result: success",P.LogLevels.info),S.resolve(b)}).fail(function(e){S.reject("product instance | "+e)}):S.reject("product instance | did not start to create native webview")):n.resolve(e)}function Oe(){R.trackEvent(h.startImpressionSuccess)}function Te(e){R.trackEvent(h.startImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Fe(){R.trackEvent(h.endImpressionSuccess)}function xe(e){R.trackEvent(h.endImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}return{name:l,init:function(){n||(Ae(),$(),a.push(w.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if(I.shouldReceiveMessage(B,e)){var t={custom_b:e.maxAdsToSaveInCache};t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,t),R.trackEvent(h.adLevelCacheReachedMaxCapacity,{},t)}})),a.push(w.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if(I.shouldReceiveMessage(B,e)){var t=Y(e);t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,t),R.trackEvent(h.saveAdInCacheSuccess,{},t);var n=P.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(E.numOfBannersToInitSuccess,E.numOfBannersToCache);b&&n&&te(g.getActiveInventoryId())}})),a.push(w.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if(I.shouldReceiveMessage(B,e)){var t=Y(e);t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,t),R.trackEvent(h.saveAdInCacheFailure,{},t),ie(P.AdUtils.getAdId(e.ad))}})),a.push(w.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if(I.shouldReceiveMessage(B,e)){var t=Y(e);t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,t),R.trackEvent(h.deleteAdFromCacheSuccess,{},t)}})),a.push(w.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if(I.shouldReceiveMessage(B,e)){var t=Y(e);t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,t),R.trackEvent(h.deleteAdFromCacheFailure,{},t)}})),a.push(w.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){if(I.shouldReceiveMessage(B,e)){var t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,{});t=U.extend(t,e),R.trackEvent(h.adsAlreadyCached,{},t)}})),a.push(w.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if(I.shouldReceiveMessage(B,e)){var t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,{}),n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";R.trackEvent(h.adAssetRetrySuccess,{generalMessage:n.substring(0,250)},t)}})),a.push(w.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if(I.shouldReceiveMessage(B,e)){var t=z.extendEventDataWithElapsedLoadTime(B.productType,B.demandSourceName,{}),n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]";R.trackEvent(h.adAssetRetryFail,{generalMessage:n.substring(0,250)},t)}})),a.push(w.PubSub.subscribe("AdsAssetsManager.urlNotMatched",function(e){if(I.shouldReceiveMessage(B,e)){var t=Y(e);U.extend(t,{generalMessage:JSON.stringify(e.asset)}),R.trackEvent(h.urlNotMatched,{},t)}})),F.init(),j.init(),P.initEventics(I.extendCallbackParamsWithParentProductConfig(B,{})),(T=T||{}).isExhaustInstanceAllowed=!1,n=!0)},initProduct:function(e){e&&e.demandSourceName},loadAdWithAdm:function(e,i){e&&e.adm&&e.demandSourceName===l&&(P.log("loadAdWithAdm | bidder | resetting last response to none",P.LogLevels.verbose),P.unloadAdViewsByProductExceptDisplayedView(B),P.DeviceDataService.shouldPullDataOnLoadAd()&&P.DeviceDataService.pullData(),Ae(),Se(null),s.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!j.canEngage()),(j.publish("InitiatedAPICall",[I.extendCallbackParamsWithProductConfig(B,{duringInit:!0})]),w.Utils.returnResolvedPromise(e.adm)).then(pe).then(ge,function(e){var t;switch(t=T.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?t=e.responseText:e.errorMessage&&""!==e.errorMessage&&(t=e.errorMessage);break;case"string":""!==e&&(t=e)}return ee(),w.Utils.returnRejectedPromise(t)}).then(function(){},function(e){try{if("string"==typeof e){var t=parseInt(e);1001<t&&t<1006&&(e=T.errors.load.invalid)}}catch(e){}var n=I.extendCallbackParamsWithDemandConfig(B,{errMsg:e});P.callSDKFunction(i,n),w.PubSub.publish(T.productType+".failedToLoad",[n])}))},showAd:function(e,o,s){var t,n,i=ye()||de(g.getActiveInventoryId());function r(e){return(n=e,a=n,a&&a.settings&&a.settings.enableNewShowAdFlow?(i=n,r=new U.Deferred,i?j.canEngage()?(ve(!0),U.extend(i,{showAdCallbacks:{onShowSuccess:r.resolve,onShowFailed:r.reject}}),P.displayAdView(i),r.promise()):r.reject(O.errors.showAdFailedReasons.taskManagerEngage):r.reject(O.errors.showAdFailedReasons.showNoAd)):(t=n,t?j.canEngage()?(ve(!0),P.displayAdView(t),w.Utils.returnResolvedPromise()):w.Utils.returnRejectedPromise(O.errors.showAdFailedReasons.taskManagerEngage):w.Utils.returnRejectedPromise(O.errors.showAdFailedReasons.showNoAd))).then(function(){var e;e=o,R.trackTimingStop(h.showAdSuccess,{eNameStart:h.showAdCalled}),P.callSDKFunction(e,I.extendCallbackParamsWithDemandConfig(B)),D.onShowSuccess(B)},function(e){we(s,e)});var t,n,i,r,a}i?(P.RingerSwitchService.isInitiated()&&i&&(P.RingerSwitchService.startListener(Ie(i.ext)),P.log("Ringer | startListener from DS.",P.LogLevels.info)),function(){y=new U.Deferred;var t=w.PubSub.subscribe(d+".getDemandSourceStateSuccess",function(e){I.shouldReceiveMessage(B,e)&&(w.PubSub.unsubscribe(t),w.PubSub.unsubscribe(n),"resolved"!==y.state()&&(A=e&&e.state||A,y.resolve(e)))}),n=w.PubSub.subscribe(d+".getDemandSourceStateFail",function(e){I.shouldReceiveMessage(B,e)&&(w.PubSub.unsubscribe(n),w.PubSub.unsubscribe(t),"resolved"!==y.state()&&y.resolve())}),e=I.extendCallbackParamsWithParentProductConfig(B);P.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}(),P.isContainerLoaded(i)?r(i):(t=i,n=new U.Deferred,Pe(t,!0,n),n.promise()).then(r).fail(function(e){we(s,e)})):we(s,"ShowAd | Bidding | there is no ad to show.")},onShowAdFailed:we,adVisible:function(e){p=!0;var t,n=P.AdUtils.getAdId(e),i=ae(n,e.inventoryId);P.log("Bidder ProductInstance | adVisible | id="+n),j.publish("Engaged",[I.extendCallbackParamsWithParentProductConfig(B,{duringEngage:!0})]),R.trackTimingStop(h.adVisible,{eNameStart:h.showAdCalled}),P.log("Bidder ProductInstance | send event adVisible"),P.SKAdImpressionService.startImpression(i,Oe,Te),ie(n,e.inventoryId),R.trackTimingStart(h.adVisibleToClose),E.extraOffersInEndCard&&P.ExtraOffers.isSupported(P.getConfig().mobileSDKSettings.deviceOs,P.getConfig().mobileSDKSettings.deviceApiLevel,i,E)&&U.when((t={impressionsCount:X(),firstAttemptToGetFeed:J,retryCounter:r,deliveryPlumbus:f},H.createPayload(t).then(function(e){return e}))).then(function(e){var t=P.getCurrentDisplayedAd();return P.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)}).then(function(e){P.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){P.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";P.log("onExtraOffersFetchFail | Reason: "+t),R.trackEvent(h.getExtraOffersInventoryFailed,{callfailreason:t})})},engageEnd:function(e,t){if(P.log("engageEnd",P.LogLevels.verbose),I.shouldReceiveMessage(B,e)){var n;n=e,P.log("_resetPreloadedAd",P.LogLevels.verbose),fe(n),R.resetBaseData(O.baseDataKeys),V.setCanPreloadFlag(!0);var i={handlePrefetchFailedOnBackground:function(e){P.log("_backgroundPrefetchFailed | ManualLoad",P.LogLevels.verbose),this.publishNoMoreOffers(O.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){var t;P.log("handlePrefetchFailedOnVisible | manuel load",P.LogLevels.verbose),t=e,F.isPrecache()&&P.AdsAssetsManager.cacheAssetsOfAd(g.getActiveInventory().getCurrentOffer(),B,De(E)).then(te.bind(null,t.inventoryId))},handleAdClosed:function(e){P.log("handleAdClosed | manuel load",P.LogLevels.verbose),P.AdsAssetsManager.unsetReferencesForAds(g.getOffers(e.inventoryId),B.instanceUniqueId),g.removeInventory(e.inventoryId)},publishNoMoreOffers:function(e){P.log("publishNoMoreOffers | ManualLoad",P.LogLevels.verbose);var t=I.extendCallbackParamsWithDemandConfig(B,{errorMsg:e||O.noMoreOffersReason.noMoreOffersToShowInFeed});w.PubSub.publish(T.productType+".NoMoreOffers",[t])}};!function(e){P.log("getAndResetErrorStateFromTaskManager",P.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[I.extendCallbackParamsWithProductConfig(B,{error:!1})]),t}(j)?e.engaged?i.handleAdClosed(e):i.handlePrefetchFailedOnBackground(e):e.engaged?i.handlePrefetchFailedOnVisible(e):i.handlePrefetchFailedOnBackground(e),(w.Utils.isFunction(t)?t:function(){})()}},getConfirmCloseMsg:function(){return u&&u.confirmCloseMsg[O.confirmCloseMsgMap[0]]},getDSEventics:function(){return R},reset:function(){Ce(),g.reset(),j.publish("InitiatedTimeoutAttempt",[I.extendCallbackParamsWithProductConfig(B,{duringAPITimeoutAttempts:!1})]),Ae(),Se(null)},clearListeners:function(){U.each(a,function(e,t){w.PubSub.unsubscribe(t)})},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/OMIDConstants":42,"../../components/VastService.js":64,"../../components/containers/WPADUtils":77,"../../patches/PatchIOSLoadAfterLoad.js":173,"../AdPlayer/AdPlayerUtils":98,"./../../components/AdFeaturesParser":3,"./../../components/MultipleInventories":36,"./../../components/sdkPluginType/SDKPluginTypeHandler":85,"./../RewardedVideo/availabilityManager.js":143,"./../RewardedVideo/availabilityReporter.js":144,"./../RewardedVideo/dsTaskManager.js":145,"./DemandEntityBuilder.js":119,"./FetchDemand/FetcherPatch.js":123,"./PayloadBuilder.js":124,"./PreloadAdManager":126}],119:[function(i,e,t){e.exports=function(e,t){var n=i("../../components/Constants.js");return{productType:e.productType,demandGroupName:t.demandGroupName||t.demandSourceName,demandSourceName:t.demandSourceName,demandType:t.demandType||n.demandSourceType.demandSource,isInAppBidding:t.isInAppBidding,demandSourceId:t.demandSourceId,waterfallPosition:t.waterfallPosition,originalDemandSourceName:t.originalDemandSourceName||t.demandSourceName,instanceUniqueId:e.productType+"."+t.demandSourceName,adSize:t.adSize}}},{"../../components/Constants.js":14}],120:[function(e,t,n){t.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},adTracked:{name:"adTracked",id:34},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},getExtraOffersInventoryFailed:{name:"getExtraOffersInventoryFailed",id:160},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},gatewayRequest:{name:"gatewayRequest",id:310},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},refreshInterval:{name:"refreshInterval",id:164},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323},saveAdInCacheSuccess:{name:"saveAdInCacheSuccess",id:279},saveAdInCacheFailure:{name:"saveAdInCacheFailure",id:280},deleteAdFromCacheSuccess:{name:"deleteAdFromCacheSuccess",id:281},deleteAdFromCacheFailure:{name:"deleteAdFromCacheFailure",id:282},adLevelCacheReachedMaxCapacity:{name:"adLevelCacheReachedMaxCapacity",id:283},adsAlreadyCached:{name:"adsAlreadyCached",id:284},adLevelCachingTimeout:{name:"adLevelCachingTimeout",id:285},duringCreation:{name:"duringCreation",id:287},startImpressionSuccess:{name:"startImpressionSuccess",id:304},startImpressionFailed:{name:"startImpressionFailed",id:305},endImpressionSuccess:{name:"endImpressionSuccess",id:306},endImpressionFailed:{name:"endImpressionFailed",id:307},overlayDismissed:{name:"overlayDismissed",id:299},overlayDismissFailure:{name:"overlayDismissFailure",id:337},overlayRemovalFailure:{name:"overlayRemovalFailure",id:338},overlayMissing:{name:"overlayMissing",id:339},presentOverlay_c:{name:"presentOverlay_c",id:352},overlayDidFinishPresentation_c:{name:"overlayDidFinishPresentation_c",id:353},presentOverlayFailed_c:{name:"presentOverlayFailed_c",id:354},dismissOverlay_c:{name:"dismissOverlay_c",id:355},overlayWillStartDismissal_c:{name:"overlayWillStartDismissal_c",id:356},overlayDidFinishDismissal_c:{name:"overlayDidFinishDismissal_c",id:357},overlayWillStartPresentation_c:{name:"overlayWillStartPresentation_c",id:358},presentOverlayDuringPendingPresent:{name:"podpp",id:359},noFill:{name:"noFill",id:20},urlNotMatched:{name:"urlNotMatched",id:349},storeKitCoolDown:{name:"storeKitCoolDown",id:374},storeKitDisplayFailed:{name:"storeKitDisplayFailed",id:375}}}},{}],121:[function(e,t,n){t.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],122:[function(e,t,n){t.exports=function(i){var r=e("./FetchDemandConst.js");return{fetchFeed:function(e,t,n){return i({url:e,data:t,type:r.direct.http.method,dataType:r.direct.http.dataType,timeout:n||1e4})}}}},{"./FetchDemandConst.js":121}],123:[function(e,t,n){t.exports=function(r,i,e,a,o){var s=295e3,d=i.getConfig().mobileSDKSettings.deviceOs,l=i.getConfig().controllerConfig||{},c=!(e.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&!e.overrideFeedSettings.shouldFetchNewFeedOnAdClose),u={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842}};function f(){setTimeout(function(){i.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()})}function p(n){var t=r.PubSub.subscribe(o.CB+".viewableChange",function(e){e.isViewable&&(r.PubSub.unsubscribe(t),f())}),i=r.PubSub.subscribe(o.CB+".webviewPatch",function(){var e,t;r.PubSub.unsubscribe(i),e=n,t=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e,a.trackEvent(u.applyPatchLogicEnd,{generalMessage:0<t?t:-9}),f()})}function g(e){if(d!==o.deviceOs.android)return!1;if("number"!=typeof e||e<s)return!1;var t=i.SupplyConfigurations.getNetworkConfigValueByKey("shouldApplyNetworkSolution"),n=l.shouldApplyNetworkSolution;return!(c&&(!1===t||!1===n))}return{applyCommunicationSolution:function(e,t){var n;g(e)&&(t||(i.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),n=e,a.trackEvent(u.applyPatchLogic,{generalMessage:0<s?n:-8}),p(e),i.callSDKFunction(o.nativeInterfaceMethod.displayWebView,{display:!0,productType:o.IS,activityThemeTranslucent:!0,success:"webviewPatch"})))},shouldApplyCommunicationSolution:g}}},{}],124:[function(U,e,t){e.exports=function(d,l,c,r,u){var a,o,f=U("./PayloadBuilderConstants.js"),t="PayloadBuilder | ",n=U("../../components/storeKit/SKANModel")(),i=r.productType,s=r.demandSourceName,p=r.demandGroupName,g=0,v=!1,m=0,h=l.getConfig().controllerConfig;function b(e){var t=l.getSDKDataByKey(u.abTests.abt);return t&&t.hasOwnProperty(u.abtParamByProductType[i])&&0<t[u.abtParamByProductType[i]].length&&(e.abt=t[u.abtParamByProductType[i]]),c.Utils.returnResolvedPromise(e)}function S(e){var t=n.extractDataForPayload(h,l.getConfig().applicationSettings);return d.extend(e,t),c.Utils.returnResolvedPromise(e)}function y(e){return d.extend(e,{demandSource:s,impressionsCount:g,auid:l.AppUserIdService.getAUID()}),c.Utils.returnResolvedPromise(e)}function A(e){var t=l.ImpressionsCounterService.getPayloadCounters(r);return d.extend(e,t),c.Utils.returnResolvedPromise(e)}function C(e){var t={},n=l.getApiData({fpf:0});v&&n&&(t.fpf=n.fpf);var i=r.waterfallPosition;return c.Utils.isDefined(i)&&(t.wp=i),t.retryCounter=m,t.delpl=a,o&&(t.sesp=o),d.extend(e,t),c.Utils.returnResolvedPromise(e)}function D(e){var t=l.getApiData({segmentId:0}),n=l.getApiData({segmentName:0});return t&&n&&d.extend(e,{segmentId:t.segmentId,segmentName:n.segmentName}),c.Utils.returnResolvedPromise(e)}function I(e){var t=l.getApiData({coppa:0});return e.cscd=t&&t.coppa,c.Utils.returnResolvedPromise(e)}function w(e){var t=l.getApiData({med_ver:0});return t&&t.med_ver&&(e.medv=t.med_ver),c.Utils.returnResolvedPromise(e)}function P(t){var e=new d.Deferred;return l.shouldExtendApiDataWithDebugData()?l.getSDKDebugParams().then(function(e){return d.extend(t,e),c.Utils.returnResolvedPromise(t)}).always(function(){e.resolve(t)}):e.resolve(t),e.promise()}function O(e){if(!l.blacklistService.isEmpty(i,p)){var t=l.blacklistService.getBlacklistedCampaigns(i,p);d.extend(e,{blacklistedCampaigns:t.join(",")})}return c.Utils.returnResolvedPromise(e)}function T(e){return l.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(i)&&d.extend(e,{lastSeenCampaignId:l.LastSeenCampaignService.getLastDisplayedAdCampaignId()}),c.Utils.returnResolvedPromise(e)}function F(e){if(l.OMIDService.isNativeServiceActivated()){var t=l.OMIDService.getVersionData();d.extend(e,{omidEnabled:!0,omidVersion:t.omidVersion,omidPartnerVersion:t.omidPartnerVersion})}else d.extend(e,{omidEnabled:!1,moatSupported:!1});return c.Utils.returnResolvedPromise(e)}function e(){var t,n,i=d.Deferred(),r=function(e){c.PubSub.clearHandlers([t,n]),i.resolve(e)};return t=c.PubSub.subscribe(f.CB+"."+f.callbacks.getTokenSuccess,function(e){r(e)}),n=c.PubSub.subscribe(f.CB+"."+f.callbacks.getTokenFailed,function(e){e&&e.errMsg?l.log(f.errorLog+": "+e.errMsg,l.LogLevels.error):l.log(f.errorLog),r({})}),l.callSDKFunction(f.nativeFunction,{functionName:f.nativeAPI.getToken},f.callbacks.getTokenSuccess,f.callbacks.getTokenFailed),i.promise()}function x(s){return e().then(function(e){if("object"!=typeof e)return c.Utils.returnResolvedPromise(s);var t,n,i,r,a,o=(t=l.SupplyConfigurations.getNetworkConfigValueByKey(f.addTokenKeysToPayload),Array.isArray(t)||(t=[]),t);return d.each(e,function(e,t){var n;n=e,(-1<o.indexOf(n)||-1<e.indexOf(f.metaDataPrefix))&&(s[e]=t)}),e.hasOwnProperty(f.metaDataOneTokenKey)&&(n=s,"object"==typeof(i=e[f.metaDataOneTokenKey])&&d.each(i,function(e,t){n[f.metaDataPrefix+e]=t})),l.isIOS()&&!l.isLegacy(l.featureMap.mutableAdvertingTrackingData)&&(r=s,(a=function(e){for(var t,n={},i=u.advertiserIdParamsToUpdate,r=0;r<i.length;r++)t=i[r],void 0!==e[t]&&(n[t]=e[t]);return n}(e))&&(l.getConfigurationHelper().parseConfiguration(a,{},l.getConfig().mobileSDKSettings),l.AdvertisingIdService.decideOnAdvertisingId(l.getConfig().mobileSDKSettings,h),d.each(a,function(e,t){var n=l.getSDKDataByKey(e);void 0!==n&&(r[e]=n)}))),c.Utils.returnResolvedPromise(s)})}function L(e){var t=l.getSDKDataByKey(u.xCodeVersion);return t&&d.extend(e,{xCodeVersion:t}),c.Utils.returnResolvedPromise(e)}function N(e){return l.log(t+"returnPayload | built payload for "+i),c.Utils.returnResolvedPromise(e)}return{createPayload:function(e){return g=e.impressionsCount,v=e.firstAttemptToGetFeed,m=e.retryCounter,a=e.deliveryPlumbus,o=e.sesp,l.getApplicationInfo(l.DemandUtils.extendCallbackParamsWithParentProductConfig(r,{})).then(l.getAPIRequiredData).then(y).then(A).then(C).then(I).then(w).then(D).then(b).then(S).then(P).then(O).then(T).then(F).then(x).then(L).then(N)},getToken:e}}},{"../../components/storeKit/SKANModel":87,"./PayloadBuilderConstants.js":125}],125:[function(e,t,n){t.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",metaDataOneTokenKey:"md",addTokenKeysToPayload:"addTokenKeysToPayload",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],126:[function(e,t,n){t.exports=function(s,d){var l=!0;function e(e){l=!!e}return{canPreloadCandidateAd:function(e,t,n,i,r,a){if(!l)return d.log("PreloadAdManager | Can not preload next ad right now"),!1;if(e&&!t)return d.log("PreloadAdManager | Skipping preload on capped demand"),!1;if(a)return d.log("PreloadAdManager | can preload true | Display when ad ready true"),!0;var o=s.VastUtils.isVastCampaign(n);return t||r&&!o||i?(d.log("PreloadAdManager | preload ad "+d.AdUtils.getAdId(n)),!0):(d.log("PreloadAdManager | skip preload ad "+d.AdUtils.getAdId(n)),!1)},preloadAdFinished:function(){e(!1)},setCanPreloadFlag:e,reset:function(){e(!0)}}}},{}],127:[function(qn,e,t){function n(c,g,f,e,o,t,s){"use strict";var d,n=!1,a=e.demandSourceName,p=g.adUnitUrl,v=g.adPlayerUrl,m=g.jQuery(),i,h=new(qn("./../../components/MultipleInventories.js")),b=new(qn("./PreloadAdManager"))(c,g),r=qn("../../components/OMIDConstants"),l=new(qn("./../../components/AdFeaturesParser"))(c,g,f,m,o,!1),u=new(qn("../../patches/PublisherPatchEasybrain.js"))(g.getConfigurationHelper()),S=new(qn("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(g,c.Utils),y=o.eventicsCategories,A={},C=m.extend(!0,{},o.precacheConfig),D=o.displayMode,I=!1,w=0,P=null,O=null,T=null,F=!1,x,L=[],N,U={},V,M=f.closeButtonStates,E=!1,k=[],K=null,B=null,R=null,j=f.CB,W=null,_=0,G={},H={},q,Q=g[o.productType],J=new(qn("./DemandEntityBuilder.js"))(o,e),z=qn("../../patches/PatchIOSLoadAfterLoad.js")(c,g,J),X=t||ve(),$=qn("./FetchDemand/FetcherPatch.js")(c,g,o,X,f),Y=g.DemandUtils,Z=new(qn("./../RewardedVideo/dsTaskManager.js"))(c,g,J,f),ee=qn("../../components/VastService.js")(c,g),te=new(qn("./../RewardedVideo/availabilityReporter.js"))(c,g,o,J,Z),ne=new(qn("./../RewardedVideo/availabilityManager.js"))(c,g,te,o),ie=new(qn("./PayloadBuilder.js"))(m,g,c,J,f),re=qn("../../components/containers/WPADUtils")(g),ae=qn("../AdPlayer/AdPlayerUtils"),oe,se=!0,de=1,le=!1,ce=g.getExternalContainer(),ue=g.InstancesTimers,fe=function(){k.push(c.PubSub.subscribe("StoreKit.storeKitDisplayFailed",function(e){X.trackEvent(y.storeKitDisplayFailed,{},{generalMessage:e})})),k.push(c.PubSub.subscribe("StoreKit.storeKitCoolDown",function(e){X.trackEvent(y.storeKitCoolDown,{},{generalMessage:e})})),k.push(c.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){var t,n,i;if(g.log("globals ready: "+I+" initSuccess in settings: "+A.numOfBannersToInitSuccess+" adUnits: "+h.size(e.inventoryId),g.LogLevels.verbose),0===A.numOfBannersToInitSuccess)n=1,t=oe.areCampaignsAvailable(at(e.inventoryId).slice(0,n),n);else{var r=ot(e.inventoryId);n=r.length;var a=Xe(h.getOffers(e.inventoryId),A.numOfBannersToInitSuccess);i=a<=n?a:n,t=oe.areCampaignsAvailable(r,i)}g.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,g.LogLevels.verbose),I&&t&&Ze(e.inventoryId)}})),k.push(c.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){var t,n=-1,i={};c.Utils.isDefined(e.id)&&(t=it(e.id,e.inventoryId),i=g.AdUtils.updateEventWithAdParams(A,t,i),n=t&&c.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1),X.trackEvent(y.campaignDeletedCache,{inventoryIndex:n},i)}})),k.push(c.PubSub.subscribe("PrecacheManager.campaignSavedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){var t,n=-1,i=null,r={};c.Utils.isDefined(e.id)&&(t=it(e.id,e.inventoryId),i=e.id,n=t&&c.Utils.isDefined(t.inventoryIndex)?t.inventoryIndex:-1,r=g.AdUtils.updateEventWithAdParams(A,t,r)),m.extend(r,{eNameStart:{name:y.campaignSavedCache.name+(i||"")},inventoryIndex:n}),X.trackTimingStop(y.campaignSavedCache,r)}})),k.push(c.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){var t=m.extend(!0,{},y.campaignSavedCache);t.name=t.name+(e.id||""),X.trackTimingStart(t)}})),k.push(c.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",function(e){Y.shouldReceiveMessage(J,e)&&g.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),g.LogLevels.verbose)})),k.push(c.PubSub.subscribe("PrecacheManager.cacheNextFail",function(o){Y.shouldReceiveMessage(J,o)&&o.deletedAds&&0<o.deletedAds.length&&m.each(o.deletedAds,function(e,t){var n=it(t,o.inventoryId),i=g.AdUtils.updateEventWithAdParams(A,n,{}),r=o.deletedAdsData;if(r&&r[e].id==t){var a=r[e].failedAssetsUrlsArray.toString();i.rvnomoreoffersreason=a.substring(0,999)}X.trackEvent(y.campaignFailedToCache,{},i),tt(t,o.inventoryId)})})),k.push(c.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",function(e){Y.shouldReceiveMessage(J,e)&&(c.PubSub.publish(o.productType+".fallbackToNonPrecache",[e]),X.trackEvent(y.fallbackToNonPrecache))})),k.push(c.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){g.log("RV cacheAdsFailedCallback "+JSON.stringify(e),g.LogLevels.verbose);for(var t,n,i,r=e.deletedOffers.length,a=e.deletedOffers,o=e.deletedAdsData,s=0;s<r;s++){var d=a[s],l=it(d,e.inventoryId),c=g.AdUtils.updateEventWithAdParams(A,l,{});if(o&&o[s].id==d){var u=o[s].failedAssetsUrlsArray.toString();c.rvnomoreoffersreason=u.substring(0,999)}X.trackEvent(y.campaignFailedToCache,{},c),et(d,e.inventoryId)}if(0===A.numOfBannersToInitSuccess)n=1,t=oe.areCampaignsAvailable(at(e.inventoryId).slice(0,n),n);else{var f=ot(e.inventoryId);n=f.length;var p=Xe(h.getOffers(e.inventoryId),A.numOfBannersToInitSuccess);i=p<=n?p:n,t=oe.areCampaignsAvailable(f,i)}ne.cacheAdsFailed(I,t,e.errorLog,Ze.bind(null,e.inventoryId))}})),k.push(c.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",function(e){if(Y.shouldReceiveMessage(J,e)){g.log("PM | preProcessingFailedCallback "+e,g.LogLevels.verbose);var t=e.id,n=it(t,e.inventoryId);He(n)&&(Y.extendCallbackParamsWithProductConfig(J,n),g.addAdToLoadedCreatives(n),Ye(),Ce(n))}})),k.push(c.PubSub.subscribe("Cache.assetRetrySuccess",function(e){if(Y.shouldReceiveMessage(J,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});e.assetType===f.assetType.adunitAsset?X.trackEvent(y.adUnitRetrySuccess,{generalMessage:t.substring(0,250)},n):e.assetType===f.assetType.adAsset&&X.trackEvent(y.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),k.push(c.PubSub.subscribe("Cache.assetRetryFailed",function(e){if(Y.shouldReceiveMessage(J,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});e.assetType===f.assetType.adunitAsset?X.trackEvent(y.adUnitRetryFail,{generalMessage:t.substring(0,250)},n):e.assetType===f.assetType.adAsset&&X.trackEvent(y.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),k.push(c.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),X.trackEvent(y.executeRetryFileUrlEmpty,{},t)})),k.push(c.PubSub.subscribe("SDKController.AdTracked",function(e){Y.shouldReceiveMessage(J,e)&&(e=g.AdUtils.formatParamsToAdId(e),X.trackEvent(y.adTracked),g.callSDKFunction("adCredited",Y.extendCallbackParamsWithParentProductConfig(J,{credits:it(g.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))})),k.push(c.PubSub.subscribe("SDKController.AdStarted",function(e){if(Y.shouldReceiveMessage(J,e)&&g.RingerSwitchService.isInitiated()){var t={},n=Kt();n&&n.ext&&(t=An(T.ext)),g.RingerSwitchService.startListener(t),g.log("Ringer | startListener ringer status from AdStarted.",g.LogLevels.info)}})),k.push(c.PubSub.subscribe("SDKController.Analytics",function(e){if(Y.shouldReceiveMessage(J,e)&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?X.trackEvent(n.eName,n.label,n.data):"startTiming"===t?X.trackTimingStart(n.eName,n.data):"stopTiming"===t?X.trackTimingStop(n.eName,n.data):"setCustomData"===t&&(g.log("Controller - setCustomData received",g.LogLevels.verbose),X.updateBaseData(n.data))}})),k.push(c.PubSub.subscribe("SDKController.AdLoaded",function(e){if(Y.shouldReceiveMessage(J,e)){var t=g.AdUtils.getAdId(e),n=it(t,e.inventoryId),i=e.inventoryId;clearTimeout(x),g.log("ad loaded with params: "+JSON.stringify(e),g.LogLevels.verbose),n&&X.updateBaseData({rvPlayMethod:n.displayMode});var r=0;if(c.VastUtils.isVastCampaign(n)&&(r=c.VastUtils.getVastViewCount(n)),c.Utils.isDefined(e.errMsg)){Z.publish("AdErrorState",[Y.extendCallbackParamsWithDemandConfig(J,{error:!0})]),g.log("Error in loading ad: "+e.errMsg,g.LogLevels.error);var a={generalMessage:e.errMsg,vastViewCount:c.VastUtils.getVastViewCountForEvent(r)};return a=g.AdUtils.updateEventWithAdParams(A,n,a),a=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,a),X.trackEvent(y.adLoadedError,{},a),c.VastUtils.setMaxVastCount(n),Ut(n),void Ce(n)}A.viewType===f.viewTypes.externalView&&X.incrementSessionNumber();var o=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});X.trackEvent(y.adLoaded,{vastViewCount:c.VastUtils.getVastViewCountForEvent(r)},o),c.Utils.isDefined(e.enableBackButton)&&g.setBackButtonState(e.enableBackButton),e=g.AdUtils.formatParamsToAdId(e),g.onAdLoaded(it(g.AdUtils.getAdId(e),e.inventoryId)),ne.adLoadedSuccessfully({numOfAdUnits:h.size(i),totalNumberCredits:nt(i)})}})),k.push(c.PubSub.subscribe("SDKController.AdLoadError",function(e){Y.shouldReceiveMessage(J,e)&&(ne.adLoadError(),g.unloadAdViewsByProduct(J),wn()||Ht())})),k.push(c.PubSub.subscribe("SDKController.AdError",function(e){Y.shouldReceiveMessage(J,e)&&g.log("SDKController.AdError:"+JSON.stringify(e),g.LogLevels.verbose)})),k.push(c.PubSub.subscribe("SDKController.dialogBoxResume",function(e){Y.shouldReceiveMessage(J,e)&&X.trackEvent(y.dialogBoxResume)})),k.push(c.PubSub.subscribe("SDKController.dialogBoxExit",function(e){Y.shouldReceiveMessage(J,e)&&X.trackEvent(y.dialogBoxExit)})),k.push(c.PubSub.subscribe("SDKController.adClosed",function(e){Y.shouldReceiveMessage(J,e)&&(g.SKAdImpressionService.endImpression(e.ad,Bn,Rn),X.resetBaseData(f.keysToResetOnAdClosed))})),k.push(c.PubSub.subscribe(o.productType+".GetConfig",function(n){if(Y.shouldReceiveMessage(J,n)){g.log("ProductInstance | getConfig received");var e=Kt();if(!e)return void g.log("ProductInstance | getConfig with no loaded ad");c.VastUtils.isVastCampaign(e)&&B?B.then(function(e,t){he(t||e,n)}):he(e,n)}})),k.push(c.PubSub.subscribe(o.productType+".isVisible",function(e){if(g.log("ProductInstance | isVisible"),Y.shouldReceiveMessage(J,e)){var t=Kt(),n=g.getCurrentDisplayedAd();if(g.isAdDisplayed(t))return void g.log("ProductInstance | isVisible | isAdDisplayed=true");t?n&&g.getCurrentDisplayedAdType()!==o.productType?X.trackEvent(y.bannerLoadedDuringShow):(g.setCurrentDisplayedAd(t),g.getCurrentDisplayedAdType()===f.BN&&ce.shouldReportAdVisibleForBanners()&&(g.log("ProductInstance | isVisible | shouldReportAdVisible"),g.onAdVisible())):g.log("ProductInstance | isVisible | ad is null")}}))};k.push(c.PubSub.subscribe("ExternalContainer.duringCreation",function(e){Y.shouldReceiveMessage(J,e)&&X.trackEvent(y.duringCreation)}));var pe=function(){k.push(c.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",function(e){if(Y.shouldReceiveMessage(J,e)){var t={custom_b:e.maxAdsToSaveInCache};t=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,t),X.trackEvent(y.adLevelCacheReachedMaxCapacity,{},t)}})),k.push(c.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",function(e){if(Y.shouldReceiveMessage(J,e)){var t=ge(e);t=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,t),X.trackEvent(y.saveAdInCacheSuccess,{},t);var n=g.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(A.numOfBannersToInitSuccess,A.numOfBannersToCache);I&&n&&Ze(h.getActiveInventoryId())}})),k.push(c.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",function(e){if(Y.shouldReceiveMessage(J,e)){var t=ge(e);t=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,t),X.trackEvent(y.saveAdInCacheFailure,{},t),tt(g.AdUtils.getAdId(e.ad))}})),k.push(c.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",function(e){if(Y.shouldReceiveMessage(J,e)){var t=ge(e);t=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,t),X.trackEvent(y.deleteAdFromCacheSuccess,{},t)}})),k.push(c.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",function(e){if(Y.shouldReceiveMessage(J,e)){var t=ge(e);t=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,t),X.trackEvent(y.deleteAdFromCacheFailure,{},t)}})),k.push(c.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",function(e){Y.shouldReceiveMessage(J,e)&&(e=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,e),X.trackEvent(y.adsAlreadyCached,{},e))})),k.push(c.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",function(e){if(Y.shouldReceiveMessage(J,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});X.trackEvent(y.adAssetRetrySuccess,{generalMessage:t.substring(0,250)},n)}})),k.push(c.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",function(e){if(Y.shouldReceiveMessage(J,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=ue.extendEventDataWithElapsedLoadTime(J.productType,J.demandSourceName,{});X.trackEvent(y.adAssetRetryFail,{generalMessage:t.substring(0,250)},n)}})),k.push(c.PubSub.subscribe("AdsAssetsManager.urlNotMatched",function(e){if(Y.shouldReceiveMessage(J,e)){var t=ge(e);m.extend(t,{generalMessage:JSON.stringify(e.asset)}),X.trackEvent(y.urlNotMatched,{},t)}}))};function ge(e){var t={};if(c.Utils.isDefined(e.ad)){var n=e.ad&&c.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;t=g.AdUtils.updateEventWithAdParams(A,e.ad,t),m.extend(t,{inventoryIndex:n})}return t}function ve(){var e={productChance:(g.getEnv(),1),baseData:{productType:J.productType,demandSourceName:J.demandSourceName,isBiddingInstance:wn()}};return c.Eventics.createEventic(e,g.EventsManager)}function me(){return X}function he(e,t){var n=it(g.AdUtils.getAdId(e),e.inventoryId);if(n){c.VastUtils.isVastCampaign(e)||be(n),Te(n);var i=Oe(n);t&&t.callback&&t.callback.call(null,i)}else g.log("line[456]: no current available ad",g.LogLevels.verbose);return n}function be(e){A.requestID&&(e.requestID=A.requestID);var t=Se(g.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);return m.extend(!0,e,g.getFormattedDeviceData(),ye(t))}function Se(e){var t=g.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==g.getEnv()&&(t=g.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),t}function ye(e){return{settings:{protocol:g.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:g.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),appOrientation:g.getSDKDataByKey(f.requiredSDKDataKeys.appOrientation),deviceLanguage:g.getSDKDataByKey(f.requiredSDKDataKeys.deviceLanguage),bundleId:g.getSDKDataByKey(f.requiredSDKDataKeys.bundleId),sdkAbName:g.getSDKDataByKey(f.requiredSDKDataKeys.sdkAbName),deviceId:g.getDeviceId(),skOverlaySupported:g.SKOverlayManager.isSKOverlaySupported()}}}function Ae(){K=B=null}function Ce(t){var e=g.AdUtils.getAdId(t);tt(e,t.inventoryId);var n=Z.getStatus().duringEngage;Ae();var i=d.getNextAd(n,t.inventoryId);function r(){g.log("RV adLoaded with error | no offers for user - show dialog",g.LogLevels.verbose),g.setCloseButtonState({productType:o.productType,demandSourceName:a,state:M.close});var e={productType:o.productType,message:N&&N.noOffers?N.noOffers:f.labels.noOffers,yes:"close",alwaysClose:!0};g.postAdUnitEvent({name:"alertUserOnError",options:e}),X.trackEvent(y.userAlert,{inventoryIndex:t.inventoryIndex||-1})}n&&t.isWPAD?r():n&&!i?r():(g.log("DemandSource | adLoaded with error - removing and moving to next offer",g.LogLevels.verbose),kt(null),g.removeAdUnit(it(e,t.inventoryId)))}function De(e){return e&&e.displayMode?e.displayMode:D.softprecache}function Ie(){var e=h.getActiveInventoryId();X.incrementSessionNumber();var t=Kt()||st(e);t||(t=dt(!0,e));var n=g.AdUtils.updateEventWithAdParams(A,t,{});n.rvPlayMethod=De(t),X.updateBaseData(n)}function we(e){var t=g.OMIDService.getVersionData().omidVersion;return g.OMIDService.isAdOmidSupported(e)&&r.omidVersionRequiresWebviewPerAd[t]?g.OMIDService.getOmidBundleUrl():""}function Pe(e){var t=g.getDeviceOs();return e.settings.cw&&e.settings.cw.hasOwnProperty(t)?e.settings.cw[t]:e.settings.cw}function Oe(e){var t=JSON.parse(JSON.stringify(e));function n(e,t,n){if(e.hasOwnProperty(t)&&"object"==typeof e[t]){n?m.extend(!0,e,e[t]):m.extend(e,e[t]);delete e[t]}}return n(t,"ext",!1),n(t,"features",!1),n(t,"settings",!0),t}function Te(e){var t=e.displayMode!=D.softprecache&&oe.isPrecache();e.settings.omidUrl=we(e),void 0===e.productType&&(e.productType=J.productType),void 0===e.demandSourceName&&(e.demandSourceName=J.demandSourceName),void 0!==e.settings.cw&&(e.settings.cw=Pe(e)),e.settings.precache=t,e.settings.sessionDepth=de,e.settings.viewType=A.viewType,c.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache)}var Fe=function(e){var t="AttemptToBringNewAds | ";if(g.log(t),X.trackEvent(y.attemptToBringNewFeed,{generalMessage:Z.getStatusMsg()}),E)g.log(t+"Cannot bring feed attemptToBringNewAdsInProcess="+E);else{if(E=!0,!Z.allowExternalCallToApi())return g.log(t+"Cannot bring feed: "+Z.getStatusMsg()),void(O=setTimeout(function(){E=!1,g.log(t+"2 minutes delay finished"),Fe(e)},o.timerLengths.riDelay));ne.inventoryEmpty(e),setTimeout(function(){g.log(t+"Can bring feed"),xe(A.refreshInterval),g.unloadAdViewsByProduct(J),E=!1,Ht()},0)}},xe=function(e){g.log("setting refresh interval to: "+e,g.LogLevels.info),P&&clearInterval(P),e&&0!==e&&!wn()?P=setInterval(function(){X.trackEvent(y.refreshInterval),Z.canEngage()?(clearInterval(P),Z.canInitCallToApi().then(Fe)):(g.log("setDuringRefreshInterval(true)",g.LogLevels.info),Ln(!0))},e*o.timeUnit):g.log("No Refresh interval is needed")};function Le(e){V=e.labels,e.templateid==o.customDialog?V.confirmCloseMsg[f.confirmCloseMsgMap[0]].alwaysClose=!0:N=e.labels}var Ne=function(e){A=l.parse(e)};function Ue(e){P&&clearInterval(P),Xt()&&xe(e.refreshInterval)}function Ve(e){g.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}var Me=function(){return J.demandSourceName===f.RIS?f.RIS:Q.getProductType()},Ee=function(e){m.each(e,function(e,t){t.inventoryIndex=e,oe.isPrecache()&&oe.setAdInventoryIndex(g.AdUtils.getAdId(t),e)})};function ke(e){return e?g.getAdPlayerAssets().prepareAdPlayerAssets(G):c.Utils.returnResolvedPromise()}function Ke(e){for(var t=0;t<e.length;t++)e[t].isCacheable=0<e[t].adAssets.length}function Be(e){m.each(e,function(e,t){t.inventoryIndex=e})}function Re(){m.each(k,function(e,t){c.PubSub.unsubscribe(t)})}function je(){O&&clearTimeout(O),P&&clearInterval(P)}function We(e){g.AdsAssetsManager.unsetReferencesForInstance(J.instanceUniqueId);var t=!!e&&e.engaged;Re(),je();var n=m.extend(!0,{},J,{engaged:t});c.PubSub.publish(o.productType+".exhaustedDemandSource",[n])}function _e(e){var t,n=[];for(t=0;t<e.length;t++)oe.isAdInCache(g.AdUtils.getAdId(e[t]))||n.push(e[t]);return n}var Ge=function(e){var n=[];return m.each(e,function(e,t){t.ext&&t.ext.appData&&t.ext.appData.adAssets&&(t.ext.appData.appImages=t.ext.appData.adAssets,delete t.ext.appData.adAssets),n.push(t)}),n},He=function(e){return oe.isPrecache()&&c.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},qe=function(e){return 1===e.length&&He(e[0])&&(F=!0),c.Utils.returnResolvedPromise()},Qe=function(e){return bt(c.VastUtils.isVastCampaign(e)),e.inventoryId&&It(),ht(e).then(function(e,t){return g.AdUtils.formatVastAdForPrecache(t,Qe.bind(null,e))})},Je=function(e){var t=[];return F?t.push(g.AdUtils.formatVastAdForPrecache(e[0],Qe.bind(null,e[0]))):t=g.AdUtils.formatAdsForPrecache(e),t},ze=function(r,a){var o,s,e,d=oe.isPrecache();r=Ge(r),Ee(r);var l=h.setOffers(r.slice(0),a);o=Je(r),s=Xe(r,A.numOfBannersToCache);var t=function(){if(c.VastUtils.isThereVastCampaign(at(l))&&ne.setAMSettings({reportOnAdunitReady:!1},!0),d){var e=Xe(r,A.numOfBannersToInitSuccess),t=oe.areCampaignsAvailable(o.slice(0,e),e);t&&X.trackEvent(y.campaignsAvailableFromCache),g.log("DemandSource | updateCurrentAds areCampaignsAvailable "+t,g.LogLevels.verbose),0===A.numOfBannersToInitSuccess&&ne.reportAdAvailable({numOfAdUnits:h.size(l),totalNumberCredits:nt(l)}),(t||0===s||0===A.numOfBannersToInitSuccess)&&Ze(l);var n=_e(o),i={cacheTimeoutSuccessCallback:function(){ze(r,a)},cacheTimeoutFailCallback:$e,applicationUserId:g.getSDKDataByKey(f.requiredSDKDataKeys.applicationUserId),applicationKey:g.getSDKDataByKey(f.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:n,inventoryId:l,adAssetsCacheConfig:H};oe.handleCacheAds(i)}else Ze(l)};d&&(e=oe.mergeCampaigns(o,s),g.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(e),g.LogLevels.verbose)),!d||A.purgeCacheOnInit?(g.log("DemandSource | already purged cache so go strait to adding the new ads",g.LogLevels.verbose),t()):oe.clearCacheByType(e).always(t)},Xe=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},$e=function(e){ne.cacheTimeoutFail(e)},Ye=function(){Z.publish("InitiatedAPICall",[Y.extendCallbackParamsWithProductConfig(J,{duringInit:!1})])},Ze=function(e){g.log("ProductInstance | handlePossibleAdUnitsReady",g.LogLevels.verbose);var t=st(e);if(t){var n=c.VastUtils.isVastCampaign(t);if(F&&bt(n,e))Dt(e);else{var i=h.size(e),r=nt(e),a=c.VastUtils.areAllCampaignTypesAreVast(at(e));Ye(),ne.canReportAvailable(i,r,a,n)}ce&&J.productType===f.BN?Mn(A,J,U):d.attemptToPreloadAd(!1,e)}},et=function(e,t){h.removeOfferById(e,t)&&!h.isEmpty(t)&&oe.incrementNextCampaign()},tt=function(e,t){var n=h.getOfferById(e,t);n?n.toRemove=!0:g.log("Error in mark current ad to be removed:"+e,g.LogLevels.error),R=null},nt=function(e){for(var t=0,n=h.getOffers(e),i=h.size(e),r=0;r<i;r++)t+=n[r].credits;return t},it=function(e,t){var n=h.getOfferById(e,t);return n||g.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(h.getOffers(t)),1),n},rt=function(e,t,n){return h.replaceOfferById(e,t,n)},at=function(e){return m.grep(h.getOffers(e),function(e){return!(c.Utils.isDefined(e.toRemove)&&e.toRemove)})},ot=function(e){var t=at(e);return m.grep(t,function(e){return e.isCacheable})},st=function(e){var t,n=it(g.AdUtils.getAdId(ft(e)),e);return t=oe.isPrecache()&&n&&n.isCacheable?(n=it(g.AdUtils.getAdId(ut(e)),e),D.precache):D.nonprecache,n&&!n.displayMode&&lt(n,t),n},dt=function(e,t){if(!e)return null;var n=ct(t);return n?it(g.AdUtils.getAdId(n),t):null},lt=function(e,t){e&&(e.displayMode=t)},ct=function(e){return 0<at(e).length?at(e)[0]:null},ut=function(e){return 0===A.numOfBannersToInitSuccess?oe.getCurrentAd(at(e).slice(0,1)):oe.getCurrentAd(at(e))},ft=function(e){return h.getCurrentOffer(e)},pt=function(e){var t=g.AdUtils.getAdId(e);Z.publish("Engaged",[Y.extendCallbackParamsWithProductConfig(J,{duringEngage:!1})]),kt(null),Ae();var n=it(t,e.inventoryId);clearTimeout(x),n?(g.log("onEngageEnd with params: "+JSON.stringify(n),g.LogLevels.verbose),c.Utils.isDefined(n)&&n.toRemove&&(g.AdsAssetsManager.unsetReferencesForAds([e],J.instanceUniqueId),g.log("removing ad id: "+t,g.LogLevels.verbose),et(t,n.inventoryId))):g.log("Tried to end engage with no ad",g.LogLevels.error)},gt=function(e){var t=g.AdUtils.getAdId(e),n=it(t,e.inventoryId);c.Utils.isDefined(n)&&n.toRemove&&(g.log("removing ad id: "+t,g.LogLevels.verbose),et(t,n.inventoryId))};function vt(e){K&&"pending"===K.state()&&(c.Utils.isDefined(e)?(g.log("handleVastAvailability - VAST failed to load with reason: "+e),K.reject()):(g.log("handleVastAvailability - VAST verified - resolve"),K.resolve()))}function mt(e){var t="";return c.Utils.isDefined(J.demandSourceName)&&(t=J.demandSourceName),t+=J.productType+e}function ht(r){var a=g.AdUtils.getAdId(r),o=yt(r),s=r.inventoryId;if(r.ext.videoData.isVast&&R){var e=c.VastUtils.getVastViewCount(r),t=r.settings.preload,n=r.displayMode;R=c.VastUtils.setVastViewCount(R,e),(r=R).settings.preload=t,r.displayMode=n}else(r=c.VastUtils.setVastViewCount(r,0)).ext.vastExhaustIndex&&1<r.ext.vastExhaustIndex&&(R=r);return be(r),B=new m.Deferred,r.vastIframeId=mt(a),X.trackTimingStart(y.parseVast),ee.parseVast(r,oe.isPrecache(),A).then(function(e){if(null!==B){if(X.trackTimingStop(y.parseVastSuccess,{generalMessage:o,eNameStart:y.parseVast}),!c.Utils.isDefined(r.toRemove)||!r.toRemove){e.ext.videoData.isVast=!0,c.Utils.isDefined(r.displayMode)&&(e.displayMode=r.displayMode),c.VastUtils.incrementVastViewCount(e),vt(e.errMsg);var t=r;return c.VastUtils.incrementVastViewCount(t),rt(r=e,g.AdUtils.getAdId(r),s),B.resolve(t,e)}ee.removeIframe(mt(a))}},function(e){if(null!==B){var t={generalMessage:o,eNameStart:y.parseVast};if(t=g.AdUtils.updateEventWithAdParams(A,r,t),e.isTimeLimitReached&&(t.callFailReason="timeout"),X.trackTimingStop(y.parseVastFail,t),!c.Utils.isDefined(r.toRemove)||!r.toRemove){var n=c.VastUtils.incrementVastViewCount(r);vt(e.errMsg),Z.publish("AdErrorState",[Y.extendCallbackParamsWithProductConfig(J,{error:!0})]),g.log("Error in loading ad: "+e.errMsg,g.LogLevels.error);var i={generalMessage:e.errMsg,vastViewCount:c.VastUtils.getVastViewCountForEvent(n)};return i=g.AdUtils.updateEventWithAdParams(A,r,i),X.trackEvent(y.adLoadedError,{},i),c.VastUtils.setMaxVastCount(r),Ut(it(a,s)),B.reject()}ee.removeIframe(mt(a))}})}function bt(e,t){return St(e)||At(t)}function St(e){return A.preFetchAllVasts&&e}function yt(e){var t;return St(c.VastUtils.isVastCampaign(e))?t="preFetchAllVasts":At(e.inventoryId)&&(t="vastAvailabilityValidation"),t}function At(e){return oe.isPrecache()&&c.VastUtils.areAllCampaignTypesAreVast(at(e))}function Ct(e){g.log("handleVastAvailability",g.LogLevels.verbose),It(),Dt(e),Ye()}function Dt(e){m.when(K).then(function(){Ye(),ne.canReportAvailable(h.size(e),nt(e))})}function It(){K&&"pending"===K.state()||(K=new m.Deferred)}var wt=function(){return Z.canInitCallToApi().then(function(){},function(){return g.log(o.errors.init[1001]+Z.getStatusMsg(),g.LogLevels.error),o.errors.init[1001]}).then(function(){return Z.publish("InitiatedAPICall",[Y.extendCallbackParamsWithProductConfig(J,{duringInit:!0})]),w++,c.Utils.decodeValues(i),f.BN===o.productType&&X.trackEvent(y.getInventory),$.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer)),g.FetchDirectService.fetchFeed(Q.getDestination(a),i,o.timerLengths.serverResponseTimeoutInMilis)}).then(Pt).then(Tt,function(e,t){var n,i=new m.Deferred;switch(n=o.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return Ye(),"timeout"===t?i.reject(o.errors.load.timeout):i.reject(n),i.promise()})},Pt=function(e){var t=new m.Deferred;if(c.Utils.isDefined(e.response)&&c.Utils.isDefined(e.response.errorCode)){Ye();var n=c.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:o.errors.init[1003];t.reject(n)}else c.Utils.isDefined(e.seatbid)&&c.Utils.isDefined(e.seatbid.bid)&&c.Utils.isDefined(e.seatbid.ext)&&c.Utils.isDefined(e.seatbid.ext.labels)?t.resolve(e):(Ye(),t.reject(o.errors.init[1004]));return t.promise()};function Ot(e){if(e){var t={blacklistedCampaigns:e.join(",")};g.getTokenService().updateToken(t)}}var Tt=function(e){var a=function(e){return wn()&&(A.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(Vt),Ot(Q.filteredListService.getFilteredListCampaigns()))),c.Utils.returnResolvedPromise()};return function(e){Z.setConnection(!0);var n=e.seatbid.bid,t=e.seatbid.ext,i=0<n.length&&ae.shouldUseAdPlayer(!!g.getConfig().mobileSDKSettings.ext.adPlayerVersion,g.getDeviceOs(),n[0]);g.log("should use ad-player? "+i),Q.getAmountOfSupportedInventories()===f.DEFAULT_AMOUNT_OF_INVENTORIES&&(jt(),h.reset());var r=h.getAvailableInventoryId();return X.updateBaseData({landingId:t.landingId,strategyId:t.strategyId,adSource:t.adSource}),q=t.deliveryPlumbus,t.sessionPlumbus&&s.setData(o.productType+"sesp",t.sessionPlumbus),m.when(Ne(e),Le(t)).then(Ue.bind(null,A)).then(Ve.bind(null,A)).then(zt.bind(null,A)).then(g.CampaignsFilter.filterByAppInstalled.bind(null,n,A,o.filterDisableTypes)).then(a).then(function(e){for(var t=e&&e.length||0,n="",i=0;i<t;i++)n+=g.AdUtils.getAdType(e[i],A),i<t-1&&(n+=", ");return X.updateBaseData({feedSize:t,feedCampaignOrder:n}),c.Utils.returnResolvedPromise()}.bind(null,n)).then(function(e){return e.some(function(e){return g.OMIDService.isAdOmidSupported(e,o.productType)})&&g.OMIDService.downloadOmidJsBundle(),c.Utils.returnResolvedPromise()}.bind(null,n)).then(oe.decidePrecacheStatus.bind(null,{numOfCampaigns:n.length,settings:A})).then(function(){return ne.setAMSettings({preFetchAllVasts:A.preFetchAllVasts,isPreCache:oe.isPrecache(),numOfBannersToInitSuccess:A.numOfBannersToInitSuccess,reportOnAdunitReady:A.reportOnAdunitReady}),n&&0<n.length?(I=!1,qt(),i?c.Utils.returnResolvedPromise():g.adUnitGlobals.updateAdUnitGlobals(!0,$t(),G,X)):c.Utils.returnRejectedPromise(f.errors.noFill)}).then(function(){return i?c.Utils.returnResolvedPromise():m.when(Yt(n)?g.libsManager.manageDownloadLibsFileByFiletype(o.libsCacheFiles.dapi):c.Utils.returnResolvedPromise(),(t=n,oe.isPrecache()&&Zt(t)?g.libsManager.manageDownloadLibsFileByFiletype(o.libsCacheFiles.externalObfuscation).then(function(e){en(t,e)}):c.Utils.returnResolvedPromise()));var t}).then(function(){return mn()?oe.handleCacheClear():c.Utils.returnResolvedPromise()}).then(qe(n)).then(ke.bind(null,i)).then(g.AdsAssetsManager.setAdAssetsForAds.bind(null,n)).then(Ke.bind(null,n)).then(g.AdsAssetsManager.setReferencesForAds.bind(null,n,J.instanceUniqueId)).then(Be.bind(null,n)).then(function(e,t,n){if(mn())return c.Utils.returnResolvedPromise();var i,r=new m.Deferred,a=g.AdsAssetsManager.cacheAdsWithClearanceLogic(e,t.numOfBannersToCache,t.numOfBannersToInitSuccess,n,Jt(t)).then(function(){clearTimeout(i),r.resolve()}).fail(function(e){clearTimeout(i),r.reject(e)});return i=setTimeout(function(){var e=a.state();if("pending"===e||"rejected"===e){var t={callfailreason:"ad level timeout expired when caching ads"};t=ue.extendEventDataWithElapsedLoadTime(n.productType,n.demandSourceName,t),X.trackEvent(y.adLevelCachingTimeout,{},t),r.reject("cacheAdsAssets timeout expired")}"resolved"===e&&r.resolve()},o.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),r.promise()}.bind(null,n,A,J)).then(function(){if(I=!0,mn())return Qt(),ze(n,r);var e=h.setOffers(n.slice(0),r);0===A.numOfBannersToInitSuccess&&ne.reportAdAvailable({numOfAdUnits:h.size(e),totalNumberCredits:nt(e)}),Ze(e)}).fail(function(e){var t=e||"Fail parse adUnit info from api response";g.AdsAssetsManager.unsetReferencesForAds(n,J.instanceUniqueId),h.removeInventory(r),f.BN===o.productType&&X.trackEvent(y.getInventoryFailed,{generalMessage:t}),Bt(),e&&g.log(e,g.LogLevels.error),ne.inventoryEmpty(e||t),_n()&&We()}),(new m.Deferred).resolve(m.extend(!0,{},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},Ft=function(){m.each(L,function(e,t){clearTimeout(t)}),L=[]};function xt(e){Z.publish("Engaged",[Y.extendCallbackParamsWithProductConfig(J,{duringEngage:e})])}function Lt(){var e;e={productType:o.productType,message:N&&N.noInternet?N.noInternet:f.labels.noInternet,yes:"close",alwaysClose:!0},g.alert(e)}var Nt=function(e,t,n){var i,r=g.AdUtils.getAdId(e);g.log("Error in loading ad - timeout in "+r,g.LogLevels.error),i=n?y.showAdFail:y.adLoadedError;var a={isprecache:oe.isPrecache()};a=g.AdUtils.updateEventWithAdParams(A,e,a),X.trackEvent(i,{callfailreason:"Error in loading ad - timeout"},a),Y.extendCallbackParamsWithProductConfig(J,e),c.VastUtils.isVastCampaign(e)&&Ut(e),tt(r,e.inventoryId),kt(null),Ae(),ee.removeIframe(mt(r)),A.viewType===f.viewTypes.externalView?g.removeAdUnitFromExternal(e):g.removeAdUnit(e)},Ut=function(e){e&&e.cid?g.blacklistService.addToBlacklistedCampaigns(J.productType,J.demandGroupName,e.cid):g.log("DemandSource | cannot add to blacklist with no ad",g.LogLevels.error)},Vt=function(e){e&&e.cid&&Q.filteredListService.addToFilteredListCampaigns(e.cid)},Mt=function(){var e={errMsg:void 0,didSucceed:!0};return c.Utils.isDefined(A.allowMultiInitCalls)&&!A.allowMultiInitCalls?(e.errMsg=o.errors.init.multi,e.didSucceed=!1):Z.allowExternalCallToApi()?u.shouldFail(g.getConfig())&&(e.errMsg=o.errors.init.deviceOsIsNotSupported,e.didSucceed=!1):(e.errMsg="Already attempting to initiate",e.didSucceed=!1),e},Et=function(){O&&clearTimeout(O)},kt=function(e){T=e},Kt=function(){return T},Bt=function(){kt(null),Ae(),ne.reset(),b.reset()},Rt=function(){jt(),h.reset(),Z.publish("InitiatedTimeoutAttempt",[Y.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),Bt()},jt=function(){for(var e=Object.keys(h.getInventories()),t=0;t<e.length;t++)g.AdsAssetsManager.unsetReferencesForAds(h.getOffers(e[t]),J.instanceUniqueId)},Wt=function(){var e=!1;if(J.productType===f.BN&&h){var t=h.getActiveInventoryId();t&&(e=h.isNextOfferAvailable(t))}return e},_t=function(){var e=h.getActiveInventoryId();if(e){var t=st(e);h.removeOfferById(t.id,e),Ze(e)}};function Gt(){g.DeviceDataService.shouldPullDataOnLoadAd()&&g.DeviceDataService.pullData()}function Ht(i,r){var e=function(e){if(!a){w=0,Z.publish("InitiatedTimeoutAttempt",[Y.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),e=e||o.errors.init[1002],f.BN===o.productType&&(X.trackEvent(y.getInventoryFailed,{generalMessage:e}),ce.resetExternalAdViewsIdentifiers());try{if("string"==typeof e){var t=parseInt(e);1001<t&&t<1006&&(e=o.errors.load.invalid)}}catch(e){}var n=Y.extendCallbackParamsWithDemandConfig(J,{errMsg:e});g.callSDKFunction(r,n),c.PubSub.publish(o.productType+".failedToLoad",[n]),_n()&&We()}};if(Gt(),Bt(),Wt())_t();else{var a=!1;(L.push(setTimeout(function(){e(o.errors.load.timeout),a=!0},7*o.timeUnit)),(new m.Deferred).resolve()).then(Et).then(In).then(wt).always(Ft).then(function(){a||(w=0,Z.publish("InitiatedTimeoutAttempt",[Y.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!1})]),se=!1)},function(e){var t=new m.Deferred,n=Q.doesAllowConsecutiveGatewayRequestsDuringLoad();return a||(e===o.errors.load.timeout&&n&&w<o.maxNumOfAttemptsToCallAPI?(Z.publish("InitiatedTimeoutAttempt",[Y.extendCallbackParamsWithProductConfig(J,{duringAPITimeoutAttempts:!0})]),setTimeout(function(){Ht(i,r)},o.timerLengths.initAttemptsDelay),t.resolve()):t.reject(e)),t.promise()}).then(null,e)}}function qt(){G={productType:o.productType,demandSourceName:J.demandSourceName,retryAttempts:A.adunitRetryAttempts||15,retryInterval:A.adunitRetryInterval||1,assetType:f.assetType.adunitAsset}}function Qt(){H={productType:o.productType,demandSourceName:J.demandSourceName,retryAttempts:A.adAssetRetryAttempts,retryInterval:A.adAssetRetryInterval,assetType:f.assetType.adAsset}}function Jt(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function zt(e){e&&e.hasOwnProperty(f.numOfBannersToInitSuccess)&&e.hasOwnProperty(f.numOfBannersToCache)&&X.updateBaseData({cacheConfig:e[f.numOfBannersToInitSuccess]+"/"+e[f.numOfBannersToCache]})}function Xt(){return!wn()}function $t(){return A.purgeAdunitLibsFile}function Yt(e){for(var t=0;t<e.length;t++){var n=e[t].ext.layoutData;if(c.Utils.isDefined(n)&&c.Utils.isDefined(n.html)&&0<n.html.length)return!0}return!1}function Zt(e){for(var t=!1,n=0;n<e.length;n++)if(g.AdUtils.isPlayablePrecachedAd(e[n])){t=!0;break}return t}function en(e,t){for(var n=0;n<e.length;n++)g.AdUtils.isPlayablePrecachedAd(e[n])&&(e[n].ext.ableToCache="success"===t)}function tn(e){var t=A.numOfBannersToCache,n=at(e).slice(0,t),i=!0;return m.each(n,function(e,t){return!g.AdUtils.isCacheableAd(t)||He(t)||oe.isAdInCache(g.AdUtils.getAdId(t))||oe.getAdStatusInQueue(g.AdUtils.getAdId(t))===oe.cachingStatus.pending||(i=!1),i}),i}function nn(e){var t=oe.isPrecache();t&&!mn()?g.AdsAssetsManager.cacheAssetsOfAd(h.getActiveInventory().getCurrentOffer(),J,Jt(A)).then(Ze.bind(null,e.inventoryId)):t&&!tn(e.inventoryId)?oe.updateCache(H):F&&c.VastUtils.isVastCanPlayAgain(e)&&oe.cacheSingleAd(g.AdUtils.formatVastAdForPrecache(e,Qe.bind(null,e)),H)}function rn(e,t){if(g.log("engageEnd",g.LogLevels.verbose),Y.shouldReceiveMessage(J,e))if(e.productType!==f.BN){on(e);var n=sn;an(Z)?e.engaged?n.handlePrefetchFailedOnVisible(e):n.handlePrefetchFailedOnBackground(e):e.engaged?n.handleAdClosed(e):n.handlePrefetchFailedOnBackground(e),(c.Utils.isFunction(t)?t:function(){})()}else gt(e)}function an(e){g.log("getAndResetErrorStateFromTaskManager",g.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[Y.extendCallbackParamsWithProductConfig(J,{error:!1})]),t}function on(e){g.log("_resetPreloadedAd",g.LogLevels.verbose),pt(e),X.resetBaseData(f.baseDataKeys),b.setCanPreloadFlag(!0)}var sn={handleCappingOnAdClosed:function(e){g.log("_handleCappingOnAdClosed | ManuelLoad",g.LogLevels.verbose),this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed),We(e)},handlePrefetchFailedOnBackground:function(e){g.log("_backgroundPrefetchFailed | ManualLoad",g.LogLevels.verbose),d.getNextAd(!1,e.inventoryId,!0)?nn(e):this.publishNoMoreOffers(f.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){g.log("handlePrefetchFailedOnVisible | manuel load",g.LogLevels.verbose),nn(e)},shouldPerformInternalLoad:function(){var e=o.overrideFeedSettings.isSupportFetchFeedOnAdCloseLogic&&o.overrideFeedSettings.shouldFetchNewFeedOnAdClose;return c.Utils.isDefined(A.shouldFetchNewFeedOnAdClose)?A.shouldFetchNewFeedOnAdClose:e},handleAdClosed:function(e){if(g.log("handleAdClosed | manuel load",g.LogLevels.verbose),jn())this.handleCappingOnAdClosed(e);else{if(wn())return g.log("handleAdClosed | manuel load | isInAppBiddingInstance=true"),g.AdsAssetsManager.unsetReferencesForAds(h.getOffers(e.inventoryId),J.instanceUniqueId),void h.removeInventory(e.inventoryId);if(this.shouldPerformInternalLoad())return g.AdsAssetsManager.unsetReferencesForAds(h.getOffers(e.inventoryId),J.instanceUniqueId),h.removeInventory(e.inventoryId),void Fe();g.log("handleAdClosed | manuel load | Do not perform internal load."),Bt(),jt(),h.reset(),c.PubSub.publish(o.productType+".resetStateManager",[J])}},publishNoMoreOffers:function(e){g.log("publishNoMoreOffers | ManualLoad",g.LogLevels.verbose);var t=Y.extendCallbackParamsWithDemandConfig(J,{errorMsg:e||f.noMoreOffersReason.noMoreOffersToShowInFeed});c.PubSub.publish(o.productType+".NoMoreOffers",[t])}};function dn(e){if(Y.shouldReceiveMessage(J,e)){var t=g.AdUtils.getAdId(e),n=it(t,e.inventoryId);g.log("ProductInstance | adVisible | id="+t),Z.publish("Engaged",[Y.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]),g.SKAdImpressionService.startImpression(n,kn,Kn);n.displayMode;if(c.VastUtils.isVastCampaign(n)){var i=c.VastUtils.getVastViewCount(n);X.trackTimingStop(y.adVisible,{vastViewCount:c.VastUtils.getVastViewCountForEvent(i),eNameStart:y.showAdCalled}),g.log("ProductInstance | send event adVisible"),c.VastUtils.isVastCanPlayAgain(n)||tt(t,e.inventoryId)}else X.trackTimingStop(y.adVisible,{eNameStart:y.showAdCalled}),g.log("ProductInstance | send event adVisible"),tt(t,e.inventoryId);de++,X.trackTimingStart(y.adVisibleToClose),A.extraOffersInEndCard&&g.ExtraOffers.isSupported(g.getConfig().mobileSDKSettings.deviceOs,g.getConfig().mobileSDKSettings.deviceApiLevel,n,A)&&ln()}}function ln(){m.when(In()).then(function(e){var t=g.getCurrentDisplayedAd();return g.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)}).then(function(e){g.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))}).fail(function(e){g.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";g.log("onExtraOffersFetchFail | Reason: "+t),X.trackEvent(y.getExtraOffersInventoryFailed,{callfailreason:t})})}function cn(e,t){return new(qn("../../components/precacheManager.js"))(e,t,un())}function un(){var e=mn()?J.productType+"_"+J.demandSourceName:f.cacheAdsDirectory;return C.cacheBase=e,C.precachePath="../"+C.cacheBase+"/",m.extend(C,J),C}function fn(){var e=g.getSDKDataByKey(f.cacheConfiguration);if(e){var t=e&&e.adLevelCacheTimeout?1e4*e.adLevelCacheTimeout:f.defaultTimeoutForCachingAds;o.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow=t}}function pn(e){return J[e]}function gn(e){e&&e.demandSourceName===a&&In()}function vn(e,t){var n;if(g.log("in load ad with params: "+JSON.stringify(e),g.LogLevels.verbose),!e||e.demandSourceName!==a)return n=ue.extendEventDataWithElapsedLoadTime(o.productType,a,{}),X.trackEvent(y.loadAdIgnored,{callFailReason:o.errors.general.dsNameNotValid},n),void ue.clearLoadStartTimeForInstance(o.productType,a);var i=Mt();if(i.errMsg){var r=y.loadAdFailed;return n=ue.extendEventDataWithElapsedLoadTime(o.productType,a,{}),X.trackEvent(r,{callFailReason:i.errMsg,demandSourceName:a},n),ue.clearLoadStartTimeForInstance(o.productType,a),void g.callSDKFunction(t,Y.extendCallbackParamsWithDemandConfig(J,{errMsg:i.errMsg}))}g.unloadAdViewsByProduct(J),g.log("resetting last response to none",g.LogLevels.verbose),Ht(e,t)}function mn(){for(var e=Q.getDestination(a),t=[f.gatewayDestinationMap.IS.production,f.gatewayDestinationMap.BN.production,f.gatewayDestinationMap.RV.production],n=0;n<t.length;n++)if(-1!==e.indexOf(t[n]))return!1;return!0}function hn(e,t,n){var i=st(h.getActiveInventoryId());g.RingerSwitchService.isInitiated()&&i&&(g.RingerSwitchService.startListener(An(i.ext)),g.log("Ringer | startListener from DS.",g.LogLevels.info)),Pn(),d.preload(!0,h.getActiveInventoryId()).then(function(){return d.show(Kt())}).then(function(){Cn(t)}).fail(function(e){g.log("Cannot engage at this time "+Z.getStatusMsg(),g.LogLevels.error),Dn(n,e)})}function bn(e){return(t=e)&&t.settings&&t.settings.enableNewShowAdFlow?yn(e):Sn(e);var t}function Sn(e){return e?Z.canEngage()?(xt(!0),g.displayAdView(e),c.Utils.returnResolvedPromise()):c.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerEngage):c.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.showNoAd)}function yn(e){var t=new m.Deferred;return e?Z.canEngage()?(xt(!0),m.extend(e,{showAdCallbacks:{onShowSuccess:t.resolve,onShowFailed:t.reject}}),g.displayAdView(e),t.promise()):t.reject(f.errors.showAdFailedReasons.taskManagerEngage):t.reject(f.errors.showAdFailedReasons.showNoAd)}function An(e){return e?{ringerUpdateDelay:A.ringerUpdateDelay,shouldSetRingerUpdateDelay:g.AdUtils.isPlayableCampaign(e)||g.AdUtils.isMRAIDCampaign(e)||g.AdUtils.isExternalCampaign(e)}:{}}function Cn(e){X.trackTimingStop(y.showAdSuccess,{eNameStart:y.showAdCalled}),g.callSDKFunction(e,Y.extendCallbackParamsWithDemandConfig(J)),z.onShowSuccess(J)}function Dn(e,t){var n=Y.extendCallbackParamsWithDemandConfig(J,{errMsg:t});c.PubSub.publish(o.productType+".failedToShow",[n]);var i=t;i!==f.errors.showAdFailedReasons.preloadNoAd&&i!==f.errors.showAdFailedReasons.showNoAd&&(i=i+". "+Z.getStatusMsg()),X.trackEvent(y.showAdFail,{callFailReason:i}),g.callSDKFunction(e,Y.extendCallbackParamsWithDemandConfig(J,{errMsg:t})),t!==f.errors.showAdFailedReasons.onAdVisibleFailed&&t!==f.errors.showAdFailedReasons.screenVisibleTimeout||xt(!1)}function In(){var e={impressionsCount:de-1,firstAttemptToGetFeed:se,retryCounter:w,deliveryPlumbus:q,sesp:s.getData(o.productType+"sesp")};return ie.createPayload(e).then(function(e){return i=e})}function wn(){return e&&e.isInAppBidding}function Pn(){W=new m.Deferred;var t=c.PubSub.subscribe(j+".getDemandSourceStateSuccess",function(e){Y.shouldReceiveMessage(J,e)&&(c.PubSub.unsubscribe(t),c.PubSub.unsubscribe(n),"resolved"!==W.state()&&(_=e&&e.state||_,W.resolve(e)))}),n=c.PubSub.subscribe(j+".getDemandSourceStateFail",function(e){Y.shouldReceiveMessage(J,e)&&(c.PubSub.unsubscribe(n),c.PubSub.unsubscribe(t),"resolved"!==W.state()&&W.resolve())}),e=Y.extendCallbackParamsWithParentProductConfig(J);g.callSDKFunction("getDemandSourceState",e,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function On(){return V&&V.confirmCloseMsg[f.confirmCloseMsgMap[0]]}function Tn(e,t){var n=g.getContainerCreationHandler(e),i=n.getState();i===n.getCreationStates().createdSuccessfully?(g.log("product instance | containerState | createdSuccessfully ",g.LogLevels.info),t.resolve(e)):i===n.getCreationStates().duringCreation?m.when(n.getCreationResultPromise()).then(function(){g.log("product instance | during creation result: success",g.LogLevels.info),t.resolve(e)}).fail(function(e){t.reject("product instance | "+e)}):t.reject("product instance | did not start to create native webview")}function Fn(e){var t=g.AdUtils.getAdId(e),n=C.precachePath+t+"/";c.AdAssets.updateAdunitPrecachePath(e,n,g.AdUtils.isPlayablePrecachedAd(e),g.isAndroid())}function xn(e,t,n){var i=!1;return e&&!t&&(g.AdUtils.isPlayablePrecachedAd(n)?c.AdAssets.isAdAbleToCache(n)&&(i=!0):c.VastUtils.isVastCampaign(n)&&!He(n)||(i=!0)),i}function Ln(e){le=e}function Nn(){return le}function Un(e,t,n){var i=o.timerLengths.loadAdTimeout;clearTimeout(x),x=setTimeout(function(){Nt(e,t,n)},i)}function Vn(e){!F&&c.VastUtils.isVastCampaign(e)&&(null!==B||c.Utils.isDefined(e.toRemove)&&e.toRemove||ht(e).then(null,Ce.bind(null,e)))}function Mn(r,a,o,s){ce.checkStatusOfAdView().then(function(e){var t=st(s);g.AdUtils.setViewType(r,t,f.viewTypes.externalView);var n=g.AdUtils.updateEventWithAdParams(r,t,{});X.updateBaseData(n),kt(t),o.shouldBuildAdUnitUrlForExternal=!0;var i=p.getAdunitUrl(!1,a,o,g.getDeviceOs());e.isExternalAdViewInitiated?(he(t),ce.updateAdInAdView(i,t,a,r)):(Un(t,i,!1),m.extend(r,{adViewId:ce.getContainerID()}),ce.createAdUrlInAdView(i,t,a,r)),g.addAdToLoadedCreatives(t)})}function En(){return e.shouldAvoidHandleFrameClose}function kn(){X.trackEvent(y.startImpressionSuccess)}function Kn(e){X.trackEvent(y.startImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Bn(){X.trackEvent(y.endImpressionSuccess)}function Rn(e){X.trackEvent(y.endImpressionFailed,{},{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function jn(){var e=_===f.demandSourceStates.cappedPerSession;return e&&c.Utils.isDefined(J)&&g.log("isDemandCapped | demandSource "+J.demandSourceName+" is capped"),e}function Wn(){return!1===A.isExhaustInstanceAllowed}function _n(){return o.isExhaustInstanceAllowed&&J.demandType===f.demandSourceType.instance&&!Wn()}function Gn(){wn()&&o&&(o.isExhaustInstanceAllowed=!1)}var Hn={name:a,init:function(){d=this,n||(Bt(),oe=cn(c,g),fe(),pe(),fn(),oe.init(),Z.init(),g.initEventics(Y.extendCallbackParamsWithParentProductConfig(J,{})),Gn(),n=!0)},isNextAvailable:function(e){if(oe.isPrecache()){var t=at(e);return oe.isNextAvailable(t)||t&&t[0]&&!t[0].isCacheable}return h.isNextOfferAvailable(e)||c.VastUtils.isVastCanPlayAgain(st(e))},prepareAdToEngageEnd:function(e){return He(e)?oe.deleteCachedCampaign(g.AdUtils.getAdId(e)):c.Utils.returnResolvedPromise()},getNextAd:function(e,t,n){var i=d.isNextAvailable(t);return oe.isPrecache()&&!i&&(i=dt(n||e,t)),i},attemptToPreloadAd:function(e,t){var n=jn();if(!n||e){var i=at(t),r=st(t),a=St(c.VastUtils.isVastCampaign(r))||c.VastUtils.areAllCampaignTypesAreVast(i),o=oe.isPrecache();bt(c.VastUtils.isVastCampaign(r),t)&&Ct(t),b.canPreloadCandidateAd(n,e,r,a,o,A.displayOnAdReady)&&d.preloadAd(e,t)}else g.log("Skipping preload on capped demand",g.LogLevels.verbose)},preloadAd:function(e,t){d.preload(e,t).then(function(){e&&d.show(Kt())})},preload:function(e,t){var n,i=new m.Deferred;return Z.canPreload()?(n=Kt()||st(t))||(n=dt(e,t),lt(n,D.softprecache),n)?(m.extend(!0,n,J),g.isContainerLoaded(n)?i.resolve(n):d.preloadFlow(n,e,i),i.promise()):(g.log("Cannot preload with no offer",g.LogLevels.error),c.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.preloadNoAd)):(g.log("Cannot preload at this time, "+Z.getStatusMsg(),g.LogLevels.error),c.Utils.returnRejectedPromise(f.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,t,n){g.log("ProductInstance | preloadFlow"),b.preloadAdFinished();var i,r=!1,a=oe.isPrecache(),o={preload:!t};e.displayMode==D.softprecache&&(r=!0),xn(a,r,e)&&Fn(e),e.isWPAD=re.shouldDisplayAdOnExternalWebView(e,A),i=e.isWPAD?(g.AdUtils.setViewType(A,e,f.viewTypes.externalView),U.shouldBuildAdUnitUrlForExternal=!0,2):(g.log("ProductInstance | ad is not WPAD"),g.AdUtils.removeViewTypeFromSetting(A),U.shouldBuildAdUnitUrlForExternal=!1,1),e.displayStrategy=i;var s=g.AdUtils.updateEventWithAdParams(A,e,{});m.extend(s,{displaystrategy:i}),X.updateBaseData(s),kt(e);var d,l=!r&&a,c=!!g.getConfig().mobileSDKSettings.ext.adPlayerVersion,u=g.getDeviceOs();Un(e,d=ae.shouldUseAdPlayer(c,u,e)?v.getAdPlayerUrl(l,u,J,U):p.getAdunitUrl(l,J,U,u),t),m.extend(A,o),g.AdUtils.setViewType(A,e),S.shouldShowInStandAloneView(g.getConfig())&&g.AdUtils.extendSettingsWithStandaloneViewSupport(A),e=g.StoreKitService.updateAdWithStoreAppId(e,A),g.loadAdUnitUrl(e,d,J,A),Vn(e),e.isWPAD?Tn(e,n):n.resolve()},show:bn,getConfirmCloseMsg:On,getDSEventics:me,adVisible:dn,engageEnd:rn,initProduct:gn,loadAd:vn,updateEventicsWithAdData:Ie,showAd:hn,onShowAdFailed:Dn,getProperty:pn,isInAppBiddingInstance:wn,isDemandCapped:jn,shouldAvoidHandleFrameClose:En,reset:Rt};return d=Hn,Hn}e.exports=n},{"../../components/OMIDConstants":42,"../../components/VastService.js":64,"../../components/containers/WPADUtils":77,"../../components/precacheManager.js":82,"../../patches/PatchIOSLoadAfterLoad.js":173,"../../patches/PublisherPatchEasybrain.js":176,"../AdPlayer/AdPlayerUtils":98,"./../../components/AdFeaturesParser":3,"./../../components/MultipleInventories.js":36,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":85,"./../RewardedVideo/availabilityManager.js":143,"./../RewardedVideo/availabilityReporter.js":144,"./../RewardedVideo/dsTaskManager.js":145,"./DemandEntityBuilder.js":119,"./FetchDemand/FetcherPatch.js":123,"./PayloadBuilder.js":124,"./PreloadAdManager":126}],128:[function(e,t,n){t.exports=function(e,t){var n,i=(e=e||{}).retriesLogic||{},r=e.Features||{},a=e.ProductName;return{initiated:!1,overrideFeedSettings:r,productType:a,errors:{init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",1001:"Trying to call API while during an un-finished process",1002:"1002",1003:"1003",1004:"Invalid API response",1005:"1005",deviceOsIsNotSupported:"Device OS is not Supported"},load:{noMoreOffers:"Failed to load "+a+" ad",duringLoad:"Load "+a+" is already in progress",duringShow:"Can not Load "+a+" when showing ad",timeout:"API request timeout",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:a+" load is in progress",visible:a+" is already showing",tryingToEngage:a+" is in showing process",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:10,nonPrecacheFallback:3e5,cacheBase:null,precachePath:null,timeoutForCachingAdsInAdLevelCacheFlow:3e4},timeUnit:6e4,timerLengths:{initAttemptsDelay:i.initAttemptsDelay||500,serverResponseTimeoutInMilis:i.serverResponseTimeoutInMilis,riDelay:12e4,loadAdTimeout:16e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:i.maxNumOfAttemptsToCallAPI||2,eventicsCategories:t,isExhaustInstanceAllowed:(n=r,void 0!==n.isExhaustInstanceAllowed&&n.isExhaustInstanceAllowed),shouldDisplayOnAdReady:!!r.displayOnAdReady,forcePreload:e.forcePreload}}},{}],129:[function(n,e,t){e.exports=function(e){var t={prod:n("./EnvironmentProduction"),staging:n("./EnvironmentStaging")};return t[e.environment]?new t[e.environment](e,n("./constants")):new t.staging(e,n("./constants"))}},{"./EnvironmentProduction":130,"./EnvironmentStaging":131,"./constants":132}],130:[function(e,t,n){t.exports=function(e,t){var n,i,r=t.fileExtension,a=t.controllerFolder,o=t.cacheRootFolder,s=t.jQueryFileName,d=e.controllerVersion,l=e.schema,c=e.cdnDomain,u=e.scdnDomain,f=e.environment,p=o[e.deviceOs],g=e.cdnService,v=e.domain;function m(){return l+"//"+c+"/mobileSDKController"}function h(){return p}return{getControllerHost:m,getControllerJsUrl:function(){return m()+"/versions/"+d+"/sdk_controller"+r+".js"},getJQueryUrls:function(){return[l+"//code.jquery.com/"+s,l+"//"+c+"/libs/"+s]},getConfig:function(){return{controllerVersion:d,schema:l,cdnDomain:c,environment:f,cacheRootFolder:p,serviceCdn:g,domain:v}},getCacheControllerJsUrl:function(){return h()+"/"+a+d+"/sdk_controller"+r+".js"},getCacheJQueryPath:function(){return h()+"/assets/"+s},getAppConfigDomain:function(){return l+"//"+g},getMicroJobUrl:function(){return l+"//"+c+"/users/microjob/sdkconfig.json"},getUrlToCdnAdUnit:function(){return n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+u},setController:function(e){n=e},getStaticGlobalsUrl:function(e){return l+"//"+u+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return l+"//"+u+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return l+"//"+g+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){i=e},getBaseServerUrlForOfferwall:function(){return i?l+"//"+i:""},getCacheRootFolder:h,getExternalLibrariesUrl:function(){return m()+"/libs/"},getCacheLibsPath:function(){return h()+"/libs/"}}}},{}],131:[function(e,t,n){t.exports=function(e,t){t.fileExtension;var n=t.controllerFolder,i=t.cacheRootFolder,r=t.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,d=(e.scdnDomain,e.environment),l=e.stagingCdnDomain,c=i[e.deviceOs],u=e.cdnService,f=e.domain;function p(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e}function g(){return c}return{getControllerHost:p,getControllerJsUrl:function(){return p()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:d,cacheRootFolder:c,stagingCdnDomain:l,domain:f}},getCacheControllerJsUrl:function(){return e=a,g()+"/"+n+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return g()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getMicroJobUrl:function(){return o+"//"+s+"/users/microjob/sdkconfig_staging.json"},getUrlToCdnAdUnit:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e},setController:function(e){},getStaticGlobalsUrl:function(e){var t=l.split(".")[0];return o+"//"+l+"/users/staging/"+t+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){},getBaseServerUrlForOfferwall:function(){return""},getCacheRootFolder:g,getExternalLibrariesUrl:function(){return p()+"/common/libs/"},getCacheLibsPath:function(){return g()+"/libs/"}}}},{}],132:[function(e,t,n){t.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],133:[function(e,t,n){t.exports=function(e,t,n){var i=t.shouldFetchNewFeedOnAdCloseFlag(n.IS);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"InterstitialDS",ProductName:n.IS,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.IS.production},amountOfInventories:1,lwsSupported:!1}}},{}],134:[function(e,t,n){t.exports=function(){var i=[];function r(e){return-1!==i.indexOf(e)}return{removeAll:function(e,t){if(!r(t)){for(var n=0;n<i.length;n++)e[i[n]].clearListeners(),delete e[i[n]];i=[]}},add:function(e){r(e)||i.push(e)},clear:function(e){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}}}},{}],135:[function(e,t,n){t.exports=function(){return{showOWCalled:{name:"showOWCalled",id:16},showOWFail:{name:"showOWFail",id:17},owVisible:{name:"owVisible",id:18},inventoryGetToReceived:{name:"inventoryGetToReceived",id:-12},initControllerToShowOWCalled:{name:"initControllerToShowOWCalled",id:-13},showOWCalledToOwVisible:{name:"showOWCalledToOwVisible",id:-14},adVisibleToClose:{name:"adVisibleToClose",id:-5},initOW:{name:"initOW",id:13},initOWFail:{name:"initOWFail",id:14},initOWSuccess:{name:"initOWSuccess",id:127},staticAssetsLoaded:{name:"staticAssetsLoaded",id:126},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159}}}},{}],136:[function(Et,e,t){function n(d,s){"use strict";var i=Et("../../components/Constants.js"),r,a=!1,t=6e4,l="https://guc-api.sonic-us.supersonicads.com/api/v1/guc.php?format=json",n="https://guc-api.sonic-us.supersonicads.com/api/v1/myOffers",o="openRTB",c=i.OW,u="TaskManager",f=i.CB,p=window.jQuery,e,g={},v,m={},h={},b={productType:c},S=i.confirmCloseMsgMap,y={missingData:"Failed to get required parameters",invalid:"Invalid API response",appInfo:"Failed to retrieve application info",timeout:"API request timeout",server:"Server error",engaged:"Already engaged with OfferWall product",adunitAssetsTimeout:"Timeout in loading ad unit static assets",closeBeforeVisible:"User closed before ad loaded",missingDeviceIds:"Missing deviceIds",preconditions:"Failed to initiated OW, preconditions did not pass"},A={adunit:"adunit",inventory:"inventory",inventoryInBackground:"inventoryInBackground",preConditions:"preConditions",close:"close"},C={v:1,controllerId:1,applicationKey:0,applicationUserId:0,debug:0,language:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:1,timezoneOffset:1,itemSignature:0,disableCache:0,showDeliveryLimitationsLog:0,disableSession:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserGender:0,applicationUserAgeGroup:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[OpenUDID]":0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,pageSize:0,page:0,landingId:0,customParams:0,admin:0,useClientSideCallbacks:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,mediationType:0},D={settings:{},textData:{},offers:[]},I={SDKVersion:1},w={id:0,url:""},P={openAppStoreSheet:!0,preload:!1},O={osNotSupported:"Sorry, your operating system version is not supported.",dialogErrorMessage:"Sorry, we were unable to display the wall at the moment. Please try again later.",noOffers:"Sorry, we currently have no offers to display. Please try again later.",noInternet:"No internet connection. Please connect and try again."},T={initOWSuccess:null,initOWFailure:null},F=0,x,L={},N,U,V,M,E,k=!1,K=!1,B=null,R=null,j=s.adUnitGlobals,W="#/?productType="+c+"&mode=msdkctrl",_=null,G=null,H=null,q=null,Q=null,J=!1,z=null,X,$={adUnitAssetsTimeout:6e4,pollAPITimeout:1e4},Y={offers:[],settings:{},textData:{noOffers:O.noOffers},ext:{emptyOWReason:"default empty OW reason"}},Z={},ee=Et("./OWEventCategories.js")(),te,ne,ie,re,ae=(oe=!1,se=!1,de=!1,le=!0,ce=!1,{init:function(){oe||(d.PubSub.subscribe(u+".Engaged",function(e){d.Utils.isDefined(e.duringEngage)&&(se=e.duringEngage)}),d.PubSub.subscribe(f+".enterBackground",function(){de=!0}),d.PubSub.subscribe(f+".enterForeground",function(e){de=!1,!ge()||e&&d.Utils.isDefined(e.active)&&!e.active||(s.log("poll on CPI offer closed/external browser offer closed (iOS flow)"),K=!1,Ae())}),d.PubSub.subscribe(f+".viewableChange",function(e){e&&d.Utils.isDefined(e.isViewable)&&(!ce||!e.isViewable||d.Utils.isDefined(e.webview)&&"main"!==e.webview||(ce=!1,s.postAdUnitEvent({name:"OfferClosed"})),ge()&&e.isViewable&&d.Utils.isDefined(e.webview)&&"main"===e.webview&&(s.log("poll on CPI offer closed/external browser offer closed (Android flow)"),K=!1,Ae()))}),d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(le="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),oe=!0)},canEngage:function(){if(se||!le)return!1;var e=s.getCurrentDisplayedAd();return!e||e.productType===i.BN},isConnected:function(){return le},setConnection:function(e){le=e},setAdOpened:function(e){ce=e},getStatusMsg:function(){return" duringEngage:"+se+" appInBackground:"+de+" isConnected:"+le},getStatus:function(){return{duringEngage:se,appInBackground:de,isConnected:le,isAdOpened:ce}},duringEngage:function(){return se},publish:function(e,t){d.PubSub.publish(u+"."+e,t)},waitUntilAppInForeground:function(){var e=p.Deferred();return de?(s.log("OfferWall | Waiting for app to be in foreground"),d.PubSub.subscribeOnce(f+".enterForeground",function(){e.resolve()})):e.resolve(),e.promise()},waitUntilConnected:function(){var t=p.Deferred();if(le)t.resolve();else{s.log("OfferWall | waiting for internet connection");var n=d.PubSub.subscribe(f+".deviceStatusChanged",function(e){d.Utils.isDefined(e.connectionType)&&(le="none"!==e.connectionType&&"notReachable"!==e.connectionType)&&(d.PubSub.unsubscribe(n),t.resolve())})}return t.promise()}}),oe,se,de,le,ce,ue=function(){d.PubSub.subscribe(c+".ActionClick",function(e){s.OpenURLService.openForOW(e)||s.log(c+" failed to perform ActionClick")}),d.PubSub.subscribe("SDKController.AdClosed",function(e){e.productType===c&&ae.getStatus().isAdOpened&&s.isIOS()&&(s.postAdUnitEvent({name:"OfferClosed"}),ae.setAdOpened(!1),ge()&&(s.log("OfferWall | poll on ad closed"),Ae()))}),d.PubSub.subscribe("SDKController.AdOpened",function(e){e.productType===c&&(ae.setAdOpened(!0),k&&he(e.bannerId,!0))}),d.PubSub.subscribe("SDKController.engageEnd",function(e,t){e.productType===c&&(s.callSDKFunction("removeCloseEventHandler"),k&&(s.log("OfferWall | poll on engageEnd(ad closed)"),Ae()),ae.publish("Engaged",[{duringEngage:!1,productType:c}]),ne.unsetParamFromBaseData("landingId"),d.Utils.isFunction(t)&&t.call(),J&&"pending"===G.state()&&Ve("User closed before visible"),_&&_.always(function(){_=null;Le(!0)}))}),d.PubSub.subscribe("SDKController.adLoaded",function(e){e.adType===c&&(s.log("OfferWall | received ad loaded event"),s.onAdLoaded(w))}),d.PubSub.subscribe("SDKController.AdVisible",function(e){e.productType===c&&(s.log("OfferWall | ad visible"),ne.trackTimingStop(ee.owVisible,{eNameStart:ee.showOWCalledToOwVisible}),ne.trackTimingStart(ee.adVisibleToClose))}),d.PubSub.subscribe("SDKController.Analytics",function(e){if(e.productType===c&&e&&e.action){var t=e.action,n=e.eventParam;"fireEvent"===t?ne.trackEvent(n.eName,n.label,n.data):"startTiming"===t?ne.trackTimingStart(n.eName,n.data):"stopTiming"===t?ne.trackTimingStop(n.eName,n.data):"setCustomData"===t?ne.updateBaseData(n.data):"unsetCustomData"===t&&(n&&n.data&&"bannerId"===n.data?ne.resetBaseData(i.baseDataKeys):ne.unsetParamFromBaseData(n.data))}}),d.PubSub.subscribe(f+".initOfferWall",function(e,t,n){s.log("OfferWall | CB.init called"),Se(),ne.trackEvent(ee.initOW),s.getApplicationInfo(b).then(bt,function(e){s.callSDKFunction(n,{errMsg:e||y.appInfo})}).then(function(){return ne.trackEvent(ee.initOWSuccess),s.callSDKFunction(t),d.Utils.returnResolvedPromise()},function(e){return ne.trackEvent(ee.initOWFail,{callFailReason:e}),s.callSDKFunction(n,{errMsg:e}),d.Utils.returnResolvedPromise()}).then(Te).then(function(){k&&Ae()})}),d.PubSub.subscribe(f+".showOfferWall",function(e,t,n){e&&s.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),r.showOfferWall().then(function(){s.callSDKFunction(t,{placementId:nt()})},function(e){s.callSDKFunction(n,{errMsg:e})}).always(function(){Dt(Ct())&&(_=null)})}),d.PubSub.subscribe(f+".getUserCredits",function(e,t,n){if(s.checkRequiredCallbackParams(["applicationKey","applicationUserId","productType"],e,"getOfferWallCredits",n).didSucceed&&e.productType===c){if(d.Utils.decodeValues(e),Ot(e)&&ae.duringEngage()){var i="Could not provide credits, user provided is different from current user";return s.callSDKFunction(n,{errMsg:i}),void s.log(i,s.LogLevels.error)}Te(!0,e).then(function(){Ae(e,n)},function(e){s.log(e,s.LogLevels.error),s.callSDKFunction(n,{errMsg:"Failed to initiate client side callbacks"})})}}),d.PubSub.subscribe("SDKController.OWOfferClicked",function(e){s.getCurrentDisplayedAdType()===c&&ve(e)}),d.PubSub.subscribe("SDKController.videoOfferClosed",function(){s.RingerSwitchService.isInitiated()&&(s.RingerSwitchService.stopListener(),s.log("OfferWall | Ringer | stop detecting ringer status changes from OW videoOfferClosed event")),ge()&&(K=!1,Ae())}),d.PubSub.subscribe("SDKController.dialogBoxResume",function(e){pe(e)&&ne.trackEvent(ee.dialogBoxResume)}),d.PubSub.subscribe("SDKController.dialogBoxExit",function(e){pe(e)&&ne.trackEvent(ee.dialogBoxExit)}),d.PubSub.subscribe(c+".GetCompletionOffers",function(e){if(d.Utils.isDefined(e.productType)){var t=je();re.getInventory(t.data,n,"json").then(fe.bind(null,e),fe.bind(null,e))}}),d.PubSub.subscribe("SDKController.OWPopupOfferOpened",function(e){te||(te=window.timerService.startTimer())})};function fe(e,t){re.isValidResponseStructure(t)&&(t=ot(t)),e&&e.callback&&e.callback.call(null,t)}function pe(e){return e&&e.productType===b.productType}function ge(){return k&&K}function ve(e){s.log("OfferWall | marked offer clicked for CSC with type "+e.type),K=!0}function me(e){return x=e&&e.placementId||F,s.log("OfferWall | Updated placement to "+x),x}var he=function(e,t){E&&"pending"===E.state()&&p.when(E).always(function(){he(e,t)}),(L[e]=t)?N++:N--,p.when(M).always(function(){s.log("poll counter set to: "+N),E=s.setUserData(m.applicationKey,m.applicationUserId,{counter:N}),p.when(E).always(function(){E=null})})},be=function(){var e=new p.Deferred,t={counter:0,timestamp:0};return p.when(M,E).always(function(){p.when(s.getUserData(R,B)).then(function(e){N=t.counter=d.Utils.isDefined(e.counter)?e.counter:0,U=t.timestamp=d.Utils.isDefined(e.timestamp)?e.timestamp:0}).always(function(){p.when(s.setUserData(R,B,t)).then(function(){s.log("initiation done with resolve"),e.resolve()},function(){s.log("initiation done with reject",s.LogLevels.error),e.reject()})})}),e.promise()};function Se(){if(!ie){ie=!0,s.initEventics(b);var e={owPageNumber:0,isPrecache:Z.precache};ne.updateBaseData(e)}}var ye=function(e){var t,n;if(M){if("pending"===M.state())return M.promise()}else M=new p.Deferred;return t=d.PubSub.subscribe(f+".adCreditedSuccess",function(){U=e.timestamp,M.resolve(),d.PubSub.clearHandlers([t,n])}),n=d.PubSub.subscribe(f+".adCreditedFailed",function(e){M.reject(e.errMsg),d.PubSub.clearHandlers([t,n])}),p.when(E).always(function(){s.callSDKFunction("adCredited",e,"adCreditedSuccess","adCreditedFailed")}),M.promise()},Ae=function(t,n){var i={},r=[];if(s.log("In poll with counter "+N),!d.Utils.isDefined(t)&&N<=0||V&&"pending"===V.state())s.log("Exit poll, p:"+(V?V.state():null)+" a:"+(M?M.state():null));else{var e=s.getApiData(I),a=0;if(d.Utils.isDefined(e.errMsg)||!d.Utils.isDefined(R)||!d.Utils.isDefined(B))return s.log(e.errMsg,s.LogLevels.error),void(d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to make polling request, missing data"}));d.Utils.decodeValues(e);var o={aid:R,auid:B,SDKVersion:e.SDKVersion,timestamp:U};Ge(o),V=p.ajax({url:l,data:o,timeout:$.pollAPITimeout,type:"GET",dataType:"jsonp"}),p.when(V).then(function(e){if(s.log("Received poll data"),!(d.Utils.isDefined(e.rewardsData)&&d.Utils.isDefined(e.sig)&&d.Utils.isDefined(e.rewardsSummary)))return s.log("Poll data error",s.LogLevels.error),void(d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to retrieve user completion data, data error"}));!d.Utils.isEmptyObject(e.rewardsData)||d.Utils.isDefined(t)?(s.log(a),i={productType:c,credits:e.rewardsFromTime,total:e.rewardsSummary,signature:e.sig,timestamp:e.latestCompletionTime,externalPoll:d.Utils.isDefined(t),totalCreditsFlag:0===U},p.when(M).always(function(){M=null,p.when(ye(i)).then(function(){p.each(e.rewardsData,function(){this.b&&L[this.b]&&he(this.b,!1),r.push(this.id),a+=this.r?this.r:0}),0<r.length&&p.ajax({url:e.callbackURL,type:"GET",dataType:"jsonp",data:{vt:r.join(","),applicationKey:R,applicationUserId:B},success:function(){s.log("successfully updated server on csc")},error:function(e){s.log("failed to update server on csc",s.LogLevels.error)}})}).always(function(){M=null})})):s.log("no new completions")},function(e){s.log("Error retrieve user completion data"),d.Utils.isDefined(t)&&d.Utils.isDefined(n)&&s.callSDKFunction(n,{errMsg:"Failed to retrieve user completion data"})})}};function Ce(){return ae.canEngage()?d.Utils.returnResolvedPromise():ae.isConnected()?d.Utils.returnRejectedPromise(y.engaged):d.Utils.returnRejectedPromise(O.noInternet)}function De(e){e&&(g=e)}function Ie(e){return e in g?g[e]:null}function we(e,t){var n;return n=e?t:m=s.getApiData(C),d.Utils.returnResolvedPromise(n)}function Pe(e){return k=e&&("true"===e.useClientSideCallbacks||"boolean"==typeof e.useClientSideCallbacks&&e.useClientSideCallbacks),d.Utils.returnResolvedPromise(e)}function Oe(e){var t=Ot(e);return d.Utils.returnResolvedPromise(t,e)}function Te(n,e){return we(n,e).then(Pe).then(Oe).then(function(e,t){return e&&(k||n)?(s.log("OfferWall | init client side callbacks"),Tt(t),be()):d.Utils.returnResolvedPromise()})}function Fe(){return Ce().then(s.getApplicationInfo.bind(s,b)).then(function(){return me(s.getApiData({placementId:1})),Te()})}function xe(){s.log("OfferWall | In Refresh Interval"),ae.duringEngage()?s.log("OfferWall | Refresh Interval Popped, but during engage - ignore"):ae.waitUntilAppInForeground().then(ae.waitUntilConnected).then(function(){s.log("OfferWall | Refresh Interval Popped, calling refreshOfferWall"),s.unloadAdViewsByProduct(b),Le()})}function Le(e){Ee(),ae.isConnected()&&($e(),Z.precache?gt():e&&!Z.getInventoryOnInit||Me())}function Ne(){z=setTimeout(function(){s.log("OfferWall | Adunit static assets timer popped"),Ve(y.adunitAssetsTimeout)},$.adUnitAssetsTimeout)}function Ue(e){clearTimeout(z),s.log("OfferWall | Resolve adunit static assets promise"),G.resolve(e)}function Ve(e){clearTimeout(z),s.log("OfferWall | Reject adunit static assets promise - "+JSON.stringify(e)),G.reject.apply(G.reject,arguments)}function Me(){var e=je();e.errMsg||ft(e).always(St)}function Ee(){q=Q=H=null}function ke(){var e=d.PubSub.subscribe(c+".GetConfig",function(e){s.log("OfferWall | Received getConfig event from adunit"),Ue(e)});return function(){d.PubSub.unsubscribe(e)}}function Ke(){var e=d.PubSub.subscribe(u+".Engaged",function(e){e.productType===c&&(J=!0)});return function(){d.PubSub.unsubscribe(e)}}function Be(){s.log("OfferWall | Load Adunit"),G=new p.Deferred,ne.trackTimingStart(ee.staticAssetsLoaded);var e=ke();return p.when(v?(s.log("Using cached adunit url: "+v),d.Utils.returnResolvedPromise({html:v})):j.getGlobalAssetsJSON()).then(function(e){if(v||(j.setAdunitVersion(e),v=j.getAdunitGlobalsHTML()),J)Ve("User closed before visible");else if("rejected"===H.state())Ve("Finished when flow already failed");else{var t=j.getStaticGlobalsUrl()+v+W;setTimeout(function(){s.updateAdUnitUrl(w,t,b,{preload:!0,forceCreation:!0})},0),Ne()}},Ve),G.promise().then(function(e){return ne.trackTimingStop(ee.staticAssetsLoaded),e}).always(function(){e()})}function Re(){var e={pass:!0,reason:"ok"};return ae.isConnected()?s.isSupportedOsVersion(c)?s.isLimitedDeviceModel()&&(e.reason="Device is not supported",e.pass=!1):(e.pass=!1,e.reason="Operating system version "+s.getConfigurationHelper().getDeviceOsVersion()+" is not supported"):(e.pass=!1,e.reason=O.noInternet),e}function je(){var e={data:null,errMsg:null},t=s.getApiData(C);return d.Utils.isDefined(t.errMsg)?e.errMsg=t.errMsg:t==={}?e.errMsg=y.missingData:(t.format=o,Ge(t),_e(t),We(t),d.Utils.decodeValues(t),t.auid=s.AppUserIdService.getAUID(),e.data=t,m=t),e}function We(e){var t=s.getApiData({coppa:0});e.cscd=t&&t.coppa}function _e(e){var t=s.getSDKDataByKey(i.xCodeVersion);t&&(e.xCodeVersion=t)}function Ge(e){var t=s.getSDKDataByKey(i.abTests.abt);t&&t.hasOwnProperty(i.abtParamByProductType[c])&&0<t[i.abtParamByProductType[c]].length&&(e.abt=t[i.abtParamByProductType[c]])}function He(e){H&&"pending"===H.state()&&(s.log("OfferWall | Rejecting Get Inventory | "+e.errMsg),e.errCode&&(eventObj.errorCode=e.errCode),e.failFlow!=A.preConditions&&ne.trackEvent(ee.getInventoryFailed,{callFailReason:e.errMsg}),H.reject(e))}function qe(e,t){return{failFlow:e,errMsg:t}}function Qe(){return qe(A.close,"User closed before visible",!0)}function Je(e,t,n){var i=qe(e,t);return i.errCode=n||0,i}function ze(){return _&&"pending"===_.state()}function Xe(){return H&&"pending"===H.state()}function $e(){X&&(clearTimeout(X),X=null)}function Ye(){var e=s.getApiData({scdn:1,protocol:0,defaultProtocol:1}),t=s.decideUrlProtocolAccordingToHTTPSCompliance(),n=e.scdn;return{protocol:t,urltocdn:"prod"!==s.getEnv()?s.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:t+"//"+n,preload:Z.precache,hasNotch:s.getNotchService().hasNotch()}}function Ze(e,t){var n=ze(),i=e.offers&&0<e.offers.length;if(n||i)return O.confirmCloseMsg=e.textData.confirmCloseMsg,p.extend(e.settings,Ye(),s.getFormattedDeviceData()),tt(e),it(e).then(function(e){et(e),t.callback.call(null,e)});var r=qe(A.inventoryInBackground,"Empty Inventory");return s.log("No inventory available while preloading in background - Remove iframe"),s.unloadAdViewsByProduct(b),He(r),d.Utils.returnRejectedPromise(r)}function et(e){var t={settings:{deviceId:s.getDeviceId(),appKey:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),userApplicationId:s.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),shouldShowOWPopup:Ut()}};return p.extend(!0,e,t)}function tt(e){s.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios&&e.settings.forceOWOrientation&&(w.ext={forceOrientation:e.settings.forceOWOrientation})}function nt(){return x||F}function it(e){var t=new p.Deferred;if(!e.settings.placementsFlow)return t.resolve(ot(e));if(ze())t.resolve(st(e));else{s.log("Waiting for show before resolving getConfig");var n=d.PubSub.subscribe(f+".showOfferWall",function(){d.PubSub.unsubscribe(n),s.getApplicationInfo(b).then(function(){me(s.getApiData({placementId:1})),t.resolve(st(e))})})}return t.promise()}function rt(e,t){if(!e)return!1;if(e.offers&&0<e.offers.length){var n=e.offers[0];return n.rewards&&n.rewards[t]}return!!e.settings.currency&&e.settings.currency[t]}function at(e,t){if(!e.intermediateData||!e.intermediateData.text)return e;var n=e.currency||t,i=e.intermediateData.text.actionButton,r=e.intermediateData.text.instructionDescription,a=e.intermediateData.text.instructions,o={"{{rewardCount}}":e.rewards,"{{currencyName}}":n};if(0<i.length&&(e.intermediateData.text.actionButton=d.Utils.replacePlaceHolder(i,o)),0<r.length&&(e.intermediateData.text.instructionDescription=d.Utils.replacePlaceHolder(r,o)),0<a.length)for(var s=0;s<a.length;s++)a[s]=d.Utils.replacePlaceHolder(a[s],o);return e}function ot(e){for(var t=e.offers,n=0;n<t.length;n++)t[n]=at(t[n],e.settings.currency);return e}function st(e){var t=e.offers,n=nt();rt(e,n)||(n=me({placementId:F})),s.log("Offerwall | currentPlacement: "+n),e.settings.placementId=n;for(var i=0;i<t.length;i++)t[i].textData=t[i].textData[n],t[i].rewards=t[i].rewards[n],t[i].multiCompletionsRewards&&t[i].multiCompletionsRewards[n]&&(t[i].multiCompletionsRewards=t[i].multiCompletionsRewards[n]),t[i]=at(t[i],e.settings.currency[n]);try{e.settings.vip&&(e.settings.vip=e.settings.vip[n]),e.settings.currency=e.settings.currency[n],e.settings.doublePromotionData&&(e.settings.doublePromotionData=e.settings.doublePromotionData[n]),e.settings.multiCreditPromotionData&&(e.settings.multiCreditPromotionData=e.settings.multiCreditPromotionData[n]),e.settings.linksData.contactSupport.label=e.settings.linksData.contactSupport.label[n],e.textData.header=e.textData.header[n]}catch(e){s.log("OfferWall | Failed to interpolate inventory response",s.LogLevels.error)}return e}function dt(e,n){n.failFlow!==A.close?(ze()?n.failFlow===A.inventory&&(e&&"rejected"!==e.state()||(e=ct()),e.then(function(e){var t=p.extend(!0,{},Y);t.ext.emptyOWReason=n.errMsg,et(t),e.callback.call(null,t)})):(n.failFlow===A.inventory&&(n=qe(A.inventoryInBackground,"Failed to get Inventory"),s.log("OfferWall | Inventory failed while preloading in background - Remove iframe")),s.unloadAdViewsByProduct(b)),He(n)):He(n)}function lt(e){s.log("Offerwall | Get Inventory"),ne.trackEvent(ee.getInventory);var t=s.getProtocol()+i.gatewayDestinationMap.OW.production;return re.getInventory(e.data,t).then(function(e){if(J){var t=Qe();return d.Utils.returnRejectedPromise(t)}return e},function(e){return J?Qe():Je(A.inventory,e.errorMessage,e.errorCode)}).then(function(e){return s.CampaignsFilter.filterByAppInstalledOW(e.offers,e.settings).then(function(){return d.Utils.returnResolvedPromise(e)})})}function ct(){var e=Ie(i.offerWallSetting.OWVersion)||i.offerWallSetting.defaultOWVersion;return Mt.bind(null,e)().then(null,function(e){return J?Qe():qe(A.adunit,e)})}function ut(){if(s.log("OfferWall | _handlePreConditions"),q&&"pending"===q.state())return s.log("OfferWall | _handlePreConditions already has deferred "+q.state()),q;var e;q=new p.Deferred,J=!1,$e();var t=!0,n=Re();n.pass||(He(e=qe(A.preConditions,n.reason)),t=!1);var i=je();return i.errMsg&&(He(e=qe(A.preConditions,i.errMsg)),t=!1),t?q.resolve(i):q.reject(e),q.promise()}function ft(e){return s.log("OfferWall | _getInventoryWithPromise"),Q&&"rejected"!==Q.state()?(s.log("OfferWall | _getInventoryWithPromise already has deferred "+Q.state()),Q):Q=lt(e).then(function(e){e.settings=e.settings||{};var t=e.settings;return t.shouldStartMuted=s.AdUtils.isCampaignShouldStartMuted(s.getConfig().controllerConfig,i.OW),De(p.extend(t,s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",e.settings.templateId))),pt({feedSize:e.offers.length,landingId:e.settings.templateId,strategyId:e.settings.strategyId,requestId:e.settings.requestID}),d.Utils.returnResolvedPromise(e)})}function pt(e){ne.updateBaseData(e)}function gt(){return s.log("OfferWall | _initOfferWall"),H&&"rejected"!==H.state()?s.log("OfferWall | _initOfferWall using cached promise in Init OW flow"):(H=new p.Deferred,mt().then(function(){H.resolve()})),H.promise()}function vt(t){var n=new p.Deferred;return s.shouldExtendApiDataWithDebugData()?s.extendApiDataWithDebugParams(t.data).then(function(e){t.data=e,n.resolve(t)}):n.resolve(t),n.promise()}function mt(){var t=null;return ut().then(function(e){return vt(e)}).then(function(e){return ft(e)}).then(function(e){return t=ct(),p.when(e,t)}).then(function(e,t){return Ze(e,t)},function(e){return dt(t,e)}).always(St)}function ht(){return ut().then(ft,function(e){return e&&e.errMsg||(e={errMsg:y.preconditions}),s.log("OfferWall.js | CB.init preConditionsFailed "+JSON.stringify(e),s.LogLevels.verbose),d.Utils.returnRejectedPromise(e.errMsg)}).then(null,function(e){return s.log("OfferWall.js | CB.init getInventoryPromise fail",s.LogLevels.verbose),e=e||y.server,d.Utils.returnRejectedPromise(e)}).always(St)}function bt(){return Z.precache?(gt(),d.Utils.returnResolvedPromise()):Z.getInventoryOnInit?ht():d.Utils.returnResolvedPromise()}function St(){if(!X&&(Z.precache||Z.getInventoryOnInit)&&!Dt(Ct())){var e=Z.refreshInterval;s.log("Setting OW refresh interval - "+e+" minutes",s.LogLevels.verbose),X=setTimeout(xe,e*t)}}function yt(){J&&d.Utils.returnRejectedPromise(Qe().errMsg)}function At(e){"object"!=typeof e&&(e={errMsg:e});var t=e.errMsg||"Generic error on ShowOfferWall";return J?t:e.failFlow===A.adunit?(ne.trackEvent(ee.showOWFail,{callFailReason:"l1651: "+t}),xt(t),t):e.failFlow===A.preConditions?(ne.trackEvent(ee.showOWFail,{callFailReason:"l1655: "+t}),xt(t),t):(s.log("Empty OfferWall error",s.LogLevels.verbose),Pt(),d.Utils.returnResolvedPromise())}function Ct(){var e,t=Ie("standaloneOfferWallData");if(t&&t.url){var n=t.url,i=nt();d.Utils.isDefined(i)&&(n=d.Utils.replacePlaceHolder(n,{"{{PlacementId}}":i})),-1===n.indexOf("openOWInStandalone")&&(n+="&openOWInStandalone=true"),e=p.extend({},t,{url:n})}return e}function Dt(e){return e&&e.openInStandaloneOfferWall&&e.url}function It(){return _&&"rejected"!==_.state()?(s.log("line[354]: Recalling showOW before resolving previous flow",s.LogLevels.error),ne.trackEvent(ee.showOWFail,{callFailReason:"Recalling showOW before resolving previous flow"}),_):(_=new p.Deferred,Se(),ne.incrementSessionNumber(),ne.trackTimingStart(ee.initControllerToShowOWCalled,s.getApiData({controllerTimeLoaded:1}).controllerTimeLoaded),ne.trackTimingStop(ee.showOWCalled,{eNameStart:ee.initControllerToShowOWCalled}),ne.trackTimingStart(ee.showOWCalledToOwVisible),Fe().then(function(){if(Dt(n=Ct()))return d.Utils.returnResolvedPromise();var e=gt();return t=Ke(),wt(e),e.then(yt,At)},function(e){return ne.trackEvent(ee.showOWFail,{callFailReason:"l1735: "+e}),xt(e),e}).always(function(){t&&t()}).then(function(){if(Dt(n)){var e={url:n.url,method:"external_browser"};s.openUrl(e)}else Pt();s.log("Resolving ShowOfferWall"),_.resolve.apply(this,arguments)},function(e){s.log("Rejecting ShowOfferWall"),_.reject(e)}),_.promise());var t,n}function wt(e){if(w.url=null,w.isWPAD=!1,"resolved"!==e.state()||!Z.precache){var t={preload:!1,immersive:!!Ie(i.offerWallSetting.immersive)&&Ie(i.offerWallSetting.immersive),OLXD:Ie(i.offerWallSetting.OLXD)};s.loadAdUnitUrl(w,w.url,b,t),s.displayAdView(w)}}function Pt(){w.isWPAD=!1,s.loadAdUnitUrl(w,w.url,b,{preload:!1}),s.displayAdView(w)}var Ot=function(e){var t=e.applicationUserId,n=e.applicationKey;return t!==B||n!==R},Tt=function(e){B=e.applicationUserId,R=e.applicationKey};function Ft(e){return O.dialogErrorMessage}function xt(e){s.log("No OfferWall dialog error");var t={productType:c,message:Ft(e),alwaysClose:!0,yes:"close",no:"OK"};s.alert(t)}function Lt(){var e=s.getProtocol();h={dev:e+i.gatewayDestinationMap.OW.production,stage:e+i.gatewayDestinationMap.OW.production,prod:e+i.gatewayDestinationMap.OW.production}}function Nt(e){return h[e]||h.prod}function Ut(){var e=s.getApplicationExternalConfig().getABTestConfiguration("Offerwall",m.landingId),t=e.OWPopupInterval?e.OWPopupInterval:0;if(!t||!te)return!0;var n=window.timerService.timeElapsed(te);return t*i.timeunit-n<=0&&(window.timerService.stopTimer(te),!(te=void 0))}var Vt={init:function(e){r=this,p=s.jQuery(),Lt();var t=Nt(s.getEnv());if(!a){var n={productChance:(s.getEnv(),1),baseData:{productType:c}};"android"===s.getConfig().mobileSDKSettings.deviceOs&&(C.deviceApiLevel=0),ne=d.Eventics.createEventic(n,s.EventsManager),re=new(Et("../../components/FetcherService.js"))(t,D),ae.init(),ue(),Z=e.supplyConfig,a=!0}},getNextBtnText:function(){return d.Utils.isDefined(O.next)?O.next:"Next"},getConfirmCloseMsg:function(){return O.confirmCloseMsg&&O.confirmCloseMsg[S[0]]},showOfferWall:It,isNextAvailable:function(){return!1},getBack:function(){return w.url}};function Mt(t){s.log("OfferWall | Load external version: "+t),G=new p.Deferred,ne.trackTimingStart(ee.staticAssetsLoaded);var e=ke();if(J)Ve("User closed before visible");else{var n=j.getOWStaticGlobalsUrl(t)+j.getOWGlobalsHTML()+W;s.log("composedUrl: "+n),setTimeout(function(){s.updateAdUnitUrl(w,n,b,{preload:!0,forceCreation:!0})},0),Ne()}return G.promise().then(function(e){return ne.trackTimingStop(ee.staticAssetsLoaded,{custom_a:t}),e}).always(function(){e()})}return p.extend(Vt,{_promisedCanEngage:Ce,_initiateClientSideCallbacks:Te,_preShowOfferWall:Fe,_refreshInterval:xe,_refreshOfferWall:Le,_setAdunitAssetsTimer:Ne,_resolveAdunitAssetsPromise:Ue,_rejectAdunitAssetsPromise:Ve,_subscribeGetConfig:ke,_subscribeCloseDuringShow:Ke,_loadAdunitToIframe:Be,_verifyRestrictions:Re,_getAPIRequiredData:je,_rejectInitWithReason:He,_generateErrorObject:qe,_generateCloseBeforeVisibleErrorObject:Qe,_isDuringShow:ze,_isDuringInit:Xe,_clearRefreshInterval:$e,_handleDependenciesResolve:Ze,_handleDependenciesReject:dt,_getInventory:lt,_loadAdunit:ct,_handleInitOfferWallError:At,_showLoaderIfNeeded:wt,_initOfferWallByConfig:bt,_displayOfferWall:Pt,_getInventoryAndPreload:mt,_initOfferWall:gt,_setOfferWallSettings:De,_getOfferWallSetting:Ie,shouldAvoidHandleFrameClose:function(){return!1}}),Vt}e.exports=n},{"../../components/Constants.js":14,"../../components/FetcherService.js":23,"./OWEventCategories.js":135}],137:[function(G,e,t){e.exports=function(f,p,d,l){"use strict";var a,t,i,g=p.jQuery(),e=G("./LoadedInstances"),n=new(G("./SDKController/ManualLoadInstancesBuilder.js"))(p.getConfig().controllerConfig,l),c=new(G("./DemandSource/EventCategories"))(d.ProductName),o=new(G("./DataStore")),u=new(G("./DemandSource/dsConfig"))(d,c),v=new(G("./prdTaskManager"))(f,p,d.ProductName,l),r=new(G("../components/FilteredListService")),s={},m={},h=!1,b=p.DemandUtils,S=[],y=new e,A=p.InstancesTimers,C={loadSuccess:null,loadFailure:null};function D(e){A.clearInstanceTimers(d.ProductName,e),delete a[e]}function I(e){return g.extend(!0,{},{originalDemandSourceName:R(e)},e)}function w(e,t){var n=V(e);return n||(n=K(t)),n}function P(e){return t=e,!(p.getConfig().mobileSDKSettings.deviceOs===l.deviceOs.ios&&!t.isViewControllerSet);var t}function O(e,t,n){var i=R(e),r=W(e);if(L(r,i),U(i))!function(e,t,n){var i=u.errors.load.instanceExhausted;e.productType=d.ProductName;var r=b.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),t.trackEvent(c.loadAdFailedForExhaustedInstance,{},r),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),p.callSDKFunction(n,r)}(e,r,n);else{var a=w(i,e);if(T(a)){if(e&&e.productType===l.BN){if(!P(e))return o=e,r.trackEvent(c.loadAdFailed,{},{callfailreason:"Missing Parameter : View Controller",timingvalue:A.stopLoadTimer(o.productType,o.demandSourceName)}),void p.callSDKFunction(s,b.extendCallbackParamsWithDemandConfig(o,{errMsg:"Missing Parameter : View Controller"}));p.addExternalAdViewIdAndSetStatus(e)}var o,s;v.canEngage()?a.statesManager.load(a.loadAd,t,n,a.readyStateParams):j(e,r,n,"LWS is not allowed for nonBidding instance")}else F(e,r,n)}}function T(e){return e&&e.statesManager}function F(e,t,n){j(e,t,n,u.errors.general.dsNotSet)}function x(e,t){var n,i,r,a,o,s=w(R(e),e),d=_(s),l=(n=e)&&n.dynamicDemandSource?n.dynamicDemandSource:null,c=function(e){if(!e)return null;try{var t=f.Utils.parseJSON(decodeURIComponent(e));return f.Utils.isEmptyObject(t)&&(t=null),t}catch(e){}return null}(e.adm),u={dynamicDemandSource:l,auctionId:(i=c,r="-1",i&&i.seatbid.ext.hasOwnProperty("auction")?i.seatbid.ext.auction.id:r)};g.extend(u,(o={},(a=e).label&&(o.adsizelabel=a.label),a.height&&a.width&&(o.adsizeheight=a.height,o.adsizewidth=a.width),o),function(e){if(!e||!e.seatbid||!e.seatbid.ext)return{};var t={landingId:e.seatbid.ext.landingId,strategyId:e.seatbid.ext.strategyId,adSource:e.seatbid.ext.adSource,rvnomoreoffersreason:e.seatbid.ext.dspName};return p.AdUtils.updateEventWithAdParams(e.seatbid.ext,e.seatbid.bid[0],t)}(c)),d.updateBaseData(u),L(d,e.originalDemandSourceName),T(s)?c?(e.adm=c,s.statesManager.loadWithADM(function(){s.loadAdWithAdm(e,t)},t)):j(e,d,t,"unable to parse adm from native SDK"):F(e,d,t)}function L(e,t){p.log("productAdapter - load",p.LogLevels.verbose);var n=A.extendEventDataWithElapsedLoadTime(d.ProductName,t,{});e.trackEvent(c.loadAd,{demandSourceName:t},n),u.shouldDisplayOnAdReady&&e.trackTimingStart(c.showAdCalled)}function N(e){return e&&e.productType===d.ProductName}function U(e){return-1!==S.indexOf(e)}function V(e){return e?a[e]:null}function M(e){return f.Eventics.createEventic({productChance:1,baseData:{productType:d.ProductName,demandSourceName:e.originalDemandSourceName,isBiddingInstance:e.isInAppBidding}},p.EventsManager)}function E(e){var t=M(e);i=function(e){if(i)return i;var t={productType:d.ProductName,isInAppBidding:!0,originalDemandSourceName:e.originalDemandSourceName||R(e)},n=g.extend(!0,{},u.precacheConfig);return n.cacheBase=l.cacheAdsDirectory,n.precachePath="../"+n.cacheBase+"/",g.extend(n,t),new(G("../components/precacheManager"))(f,p,n)}(e);var n=new(G("./DemandSource/BidderProductInstance"))(f,p,l,e,u,t,i);return n.statesManager=new(G("./ProductAdapter/BidderProductStatesManager"))(f,p,e,u,l,t,d.NativeAPI),n}function k(e){if(e){var t,n,i,r=e.demandSourceName;return a[r]||(p.log("initiating "+d.ProductName+" demand source with configuration "+JSON.stringify(e),p.LogLevels.verbose),e.shouldAvoidHandleFrameClose=d.shouldAvoidHandleFrameClose,a[r]=e.isInAppBidding?E(e):(n=M(t=e),(i=new(G("./DemandSource/ProductInstance"))(f,p,l,t,u,n,o)).statesManager=new(G("./ProductAdapter/ProductStatesManager"))(f,p,t,u,l,n,d.NativeAPI),i),a[r].init()),a[r]}}function K(e){return k(n.createDemandEntityConfigObj({productType:d.ProductName,demandSourceName:R(e),isInAppBidding:B(e),demandSourceId:e.demandSourceId,originalDemandSourceName:e.originalDemandSourceName||R(e),adSize:{width:e.width,height:e.height,label:e.label}}))}function B(e){return!(!e||!e.inAppBidding||"true"!==e.inAppBidding.toLowerCase())}function R(e){return e&&e.demandSourceName?e.demandSourceName:d.DemandName}function j(e,t,n,i){e.productType=d.ProductName;var r=b.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r.callfailreason=i,r.timingvalue=A.stopLoadTimer(e.productType,e.demandSourceName),r=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,r),t.trackEvent(c.loadAdFailed,{},r),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),p.callSDKFunction(n,r)}function W(e){return _(a[R(e)])}function _(e){return e&&e.getDSEventics&&e.getDSEventics()?e.getDSEventics():t}return{init:function(){if(a=this,!h){var e={productChance:1,baseData:{productType:d.ProductName}};t=f.Eventics.createEventic(e,p.EventsManager),function(){var e=p.getProtocol();s={dev:e+d.gatewayDestinationMap.prod,stage:e+d.gatewayDestinationMap.prod,prod:e+d.gatewayDestinationMap.prod};var t,n,i=p.getApiData({destinationMap:0});if(i&&i.destinationMap)for(t in m=i.destinationMap)n=m[t],m[t]&&0<m[t].length&&-1===m[t].indexOf(e)&&(m[t]=e+n)}(),f.PubSub.subscribe(d.AdUnitCallbacks.engageEnd,function(e,t){if(N(e)){var n=V(e.demandSourceName);n&&n.statesManager&&((e&&e.engaged||d.shouldResetOnEngageEnd)&&n.statesManager.engageEnd(),n.engageEnd(e,function(){v.publish("Engaged",[{duringEngage:!1,productType:d.ProductName}]),f.Utils.isFunction(t)&&t()}))}}),f.PubSub.subscribe(d.AdUnitCallbacks.adClicked,function(e){if(N(e)){var t=p.getCurrentDisplayedAd();t&&p.callSDKFunction(d.ControllerNativeAPI.adClicked,b.extendCallbackParamsWithProductConfig(t,{}))}}),f.PubSub.subscribe(d.AdUnitCallbacks.adVisible,function(e){if(N(e)){var t=V(e.demandSourceName);t?(p.log("ProductAdapter | "+d.AdUnitCallbacks.adVisible+" demandSourceName="+e.demandSourceName),t.adVisible(e),t.statesManager&&t.statesManager.adVisible()):p.log(d.AdUnitCallbacks.adVisible+" called without an active demand source name")}}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.cacheReady,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&(t.readyStateParams=e,t.statesManager.cacheReady(C.loadSuccess,e))}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.noMoreOffers,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(C.loadFailure,e.errorMsg)}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.failedToShow,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&(p.log(d.ProductName+" failed to show - can not engage ad",p.LogLevels.error),t.statesManager.failedToShow())}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.failedToLoad,function(e){var t=V(e.demandSourceName);if(t&&t.statesManager){p.log(d.ProductName+" failed to load",p.LogLevels.error);var n={callFailReason:e.errMsg,timingvalue:A.stopLoadTimer(d.ProductName,e.demandSourceName)};n=A.extendEventDataWithElapsedLoadTime(d.ProductName,e.demandSourceName,n),W(e).trackEvent(c.loadAdFailed,{},n),A.clearLoadStartTimeForInstance(d.ProductName,e.demandSourceName),t.statesManager.failedToLoad()}}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.actionClick,function(e){p.OpenURLService.open(e)||p.log(d.ProductName+" failed to perform ActionClick",p.LogLevels.info)}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.exhaustedDemandSource,function(e){var t=R(e),n=V(t);p.log("exhaustedDemandSource: "+t,p.LogLevels.verbose),n&&(n.exhausted=!0),S.push(t),e&&e.engaged||(p.log("Demand source deleted in BG: "+t,p.LogLevels.verbose),D(t))}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.fallbackToNonPrecache,function(e){var t=V(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(C.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")}),f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.resetStateManager,function(e){var t=V(R(e));t&&t.statesManager&&t.statesManager.resetAdState()}),f.PubSub.subscribe("SDKController"+d.ControllerCallbacks.onAdWindowsClosed,function(e){if(N(e)){var t=V(e.demandSourceName);if(t)return t.exhausted?(p.log("Demand source deleted: "+e.demandSourceName,p.LogLevels.verbose),void D(e.demandSourceName)):void(e.isInAppBidding&&y.add(e.demandSourceName))}}),d.ControllerCallbacks.reset&&f.PubSub.subscribe(d.ProductName+d.ControllerCallbacks.reset,function(e){var t=V(e.demandSourceName);if(t)return p.getExternalContainer().resetReportAdVisibilityFlags(),W(e).trackEvent(c.bannerDestroyed),t.statesManager.resetAdState(),void t.reset();p.log("Reset called without an active demand source name",p.LogLevels.verbose)}),v.init(),h=!0}},getProductType:function(){return d.ProductName},getDestination:function(e){return m&&m[e]?m[e]:s[p.getEnv()]},getAmountOfSupportedInventories:function(){return d.amountOfInventories},shouldAvoidHandleFrameClose:function(){return d.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return d.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return v},getConfirmCloseMsg:function(e){return a[e]?a[e].getConfirmCloseMsg():null},initProduct:function(e,t,n){R(e),B(e=I(e))&&(e.demandSourceName=e.demandSourceId),A.setLoadStartTimeForInstance(d.ProductName,e.demandSourceName,e.loadStartTime);var i={isBiddingInstance:B(e)};i=A.extendEventDataWithElapsedLoadTime(d.ProductName,e.demandSourceName,i),W(e).trackEvent(c.initAd,{demandSourceName:e.originalDemandSourceName},i);var r=p.getSDKLimitationData(d.ProductName);if(r.didSucceed){var a=K(e);a&&(a.initProduct&&f.Utils.isFunction(a.initProduct)&&a.initProduct(e),a.statesManager&&a.statesManager.init(t))}else _failProduct(e,n,r.errMsg)},loadProduct:function(e,t,n){p.log("productAdapter - loadProduct",p.LogLevels.verbose),e=I(e),A.startLoadTimer(d.ProductName,e.demandSourceName),A.setLoadStartTimeForInstance(d.ProductName,e.demandSourceName,e.loadStartTime),C.loadSuccess=t,C.loadFailure=n,B(e)?((e.productType!==l.BN||p.isBannerAndLoadWhileShowSupported(e.productType))&&(y.removeAll(a,e.demandSourceId),y.add(e.demandSourceId),e.demandSourceName=e.demandSourceId),x(e,n)):O(e,t,n)},showProduct:function(e,t,n){B(e=I(e))&&(y.clear(e.demandSourceId),e.demandSourceName=e.demandSourceId);var i=R(e),r=V(i),a=e&&e.orientationRestriction;W(e).updateBaseData({sessionDepth:p.ImpressionsCounterService.getCountersByProduct(u.productType).totalSessionImpressions+1}),W(e).trackEvent(c.showAd),p.AppOrientationManager.updateAppOrientationByNewRestriction(a),function(e,t,n,i){if(U(n)){var r={errMsg:u.errors.show.instanceExhausted,demandSourceName:n};return W(e).trackEvent(c.showAdFail,{callfailreason:u.errors.show.instanceExhausted}),p.callSDKFunction(t,r),!1}return!!i||(W(e).trackEvent(c.showAdFail,{callfailreason:u.errors.general.dsNotSet}),p.callSDKFunction(t,{errMsg:u.errors.general.dsNotSet}),!1)}(e,n,i,r)&&(v.canEngage()?(W(e).trackTimingStart(c.showAdCalled),r.statesManager&&r.statesManager.show(r.showAd,t,n)):r.onShowAdFailed(n,"Cannot engage offer at this time"))},initProductFail:function(e,t,n){var i=b.extendCallbackParamsWithDemandConfig(e,{errMsg:n});i.callfailreason=n,i.timingvalue=A.stopLoadTimer(e.productType,e.demandSourceName),i=A.extendEventDataWithElapsedLoadTime(e.productType,e.demandSourceName,i),W(e).trackEvent(c.initAdFail,{},i),A.clearLoadStartTimeForInstance(e.productType,e.demandSourceName),p.callSDKFunction(t,i)},className:"ProductAdapter",filteredListService:r}}},{"../components/FilteredListService":25,"../components/precacheManager":82,"./DataStore":117,"./DemandSource/BidderProductInstance":118,"./DemandSource/EventCategories":120,"./DemandSource/ProductInstance":127,"./DemandSource/dsConfig":128,"./LoadedInstances":134,"./ProductAdapter/BidderProductStatesManager":138,"./ProductAdapter/ProductStatesManager":140,"./SDKController/ManualLoadInstancesBuilder.js":150,"./prdTaskManager":170}],138:[function(e,t,n){function i(a,o,s,d,l,c,e){var u=o.jQuery(),f={readyToLoad:0,inLoadingProcess:1,loaded:2,readyToShow:3,inShowingProcess:4,visible:5},t=f.readyToLoad,n=f.readyToShow,p=d.eventicsCategories,g=o.DemandUtils,v=!1,m=g.extendCallbackParamsWithDemandConfig(s),h=o.InstancesTimers;function r(e){return t===e}function b(e){return n===e}function S(e){t=parseInt(e,10)}function y(e){n=parseInt(e,10)}function A(){return S(f.readyToLoad)}function i(){return y(f.readyToShow)}function C(){return r(f.readyToLoad)?d.errors.show.notLoaded:r(f.inLoadingProcess)?d.errors.show.duringLoad:b(f.inShowingProcess)?d.errors.show.tryingToEngage:b(f.visible)?d.errors.show.visible:"fail reason is unknown."}function D(e){if(b(f.visible)||b(f.inShowingProcess))o.log(C(),o.LogLevels.error);else if(!r(f.loaded)){var t=g.extendCallbackParamsWithDemandConfig(s,{errMsg:C()});o.callSDKFunction(e,t)}}function I(e){var t=g.isLegacy(s)?{}:m;v=!0,o.callSDKFunction(e,t)}function w(e,t){if(o.log("_loadWithADM",o.LogLevels.error),!v){var n="instance was not initiated",i=g.extendCallbackParamsWithDemandConfig(s,{errMsg:n}),r=u.extend(!0,{},m,{demandSourceName:s.originalDemandSourceName,callfailreason:n,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});return r=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,r),c.trackEvent(p.loadAdFailed,{},r),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName),void o.callSDKFunction(t,i)}S(f.inLoadingProcess),e()}function P(e,t,n){if(r(f.loaded)&&b(f.readyToShow))y(f.inShowingProcess),e(m,t,n);else{var i=u.extend(!0,{},m,{demandSourceName:s.originalDemandSourceName});c.trackEvent(p.showAdFail,{callfailreason:C()},i),D(n)}}function O(e,t){S(f.loaded);var n=u.extend(!0,{},m,{demandSourceName:s.originalDemandSourceName,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});n=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,n),c.trackEvent(p.loadAdSuccess,{},n),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName),o.callSDKFunction(e,g.extendCallbackParamsWithDemandConfig(s,t)),a.PubSub.publish("ProductStatesManager.stateResolved",[g.extendCallbackParamsWithProductConfig(s,{response:!0})])}function T(e,t){var n=t===l.errors.noFill?p.noFill:p.loadAdFailed,i=u.extend(!0,{},m,{demandSourceName:s.originalDemandSourceName,callFailReason:t,timingvalue:h.stopLoadTimer(s.productType,s.originalDemandSourceName)});i=h.extendEventDataWithElapsedLoadTime(s.productType,s.originalDemandSourceName,i),c.trackEvent(n,{},i),h.clearLoadStartTimeForInstance(s.productType,s.originalDemandSourceName);var r=g.extendCallbackParamsWithDemandConfig(s,{errMsg:d.errors.load.noMoreOffers});o.callSDKFunction(e,r),a.PubSub.publish("ProductStatesManager.stateResolved",[g.extendCallbackParamsWithProductConfig(s,{response:!1})]),A()}function F(){i()}function x(){A()}function L(){y(f.readyToShow)}function N(){S(f.readyToLoad),y(f.visible)}function U(){return!!v}var V={init:I,show:P,cacheReady:O,noMoreOffers:T,failedToShow:F,failedToLoad:x,engageEnd:L,adVisible:N,loadWithADM:w,resetAdState:i,isInitiated:U};return V}t.exports=i},{}],139:[function(e,t,n){t.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,waitingToLoad:1,inLoadingProcess:2,internalLoadingProcess:3,loaded:4,loadedFromInternalLoad:5,visible:6,inShowingProcess:7,failedInBackground:8}}},{}],140:[function(_,e,t){function n(o,s,d,l,a,c,u){var e=_("./ProductAdapterConstants.js"),f=e.adStates,t=f.notSet,p=l.eventicsCategories,g=!1,v=!1,m=s.DemandUtils,n=!1,h=m.extendCallbackParamsWithDemandConfig(d),b=s.InstancesTimers;function S(e){return t===e}function y(e){t=parseInt(e,10)}function i(){return t}function A(){return y(f.notSet)}function r(){return S(f.loadedFromInternalLoad)||S(f.loaded)}function C(e,t,n){if(g)g=!1;else if(S(f.waitingToLoad))y(f.internalLoadingProcess);else{if(S(f.inLoadingProcess)||v||d.productType===a.BN&&S(f.loaded)){n.name===p.loadAdFailed.name&&t===a.errors.noFill&&(n=p.noFill);var i=jQuery.extend(!0,{},h);i=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,i),c.trackEvent(n,{callFailReason:t},i),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName);var r=m.extendCallbackParamsWithDemandConfig(d,{errMsg:l.errors.load.noMoreOffers});s.callSDKFunction(e,r),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!1})])}v=!1,A()}}function D(e){if(u)if(e===u.load){if(S(f.inLoadingProcess)||S(f.waitingToLoad))return l.errors.load.duringLoad;if(S(f.visible)||S(f.inShowingProcess))return l.errors.load.duringShow}else if(e===u.show){if(S(f.notSet))return l.errors.show.notLoaded;if(S(f.inLoadingProcess)||S(f.waitingToLoad))return l.errors.show.duringLoad;if(S(f.visible)||S(f.inShowingProcess))return l.errors.show.visible}}function I(e,t){if(u)if(e===u.load)(S(f.inLoadingProcess)||S(f.waitingToLoad))&&s.log(D(u.load),s.LogLevels.error);else if(e===u.show)if(S(f.notSet)||V()||S(f.inLoadingProcess)){var n=m.extendCallbackParamsWithDemandConfig(d,{errMsg:D(u.show)});s.callSDKFunction(t,n)}else(S(f.visible)||S(f.inShowingProcess))&&s.log(D(u.show),s.LogLevels.error)}function w(e){var t=m.isLegacy(d)?{}:h;n=!0,s.callSDKFunction(e,t)}function P(e,t,n,i){d.productType!==a.BN?O(e,t,n,i):T(e,n)}function O(e,t,n,i){var r;if(S(f.notSet)||S(f.loaded))y(f.inLoadingProcess),e(h,n);else if(S(f.loadedFromInternalLoad))r={timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)},r=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,r),c.trackEvent(p.loadAdSuccess,{},jQuery.extend(!0,{},h,r)),s.callSDKFunction(t,m.extendCallbackParamsWithDemandConfig(d,i)),y(f.loaded),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})]);else if(g||v){var a=g?l.errors.load.inStateVisibleOrInShowingProcess:l.errors.load.inLoadingStateOrWaitingToLoad;r=jQuery.extend(!0,{},h),r=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,r),c.trackEvent(p.loadAdIgnored,{callfailreason:a},r),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName)}else S(f.visible)||S(f.inShowingProcess)?g=!0:V()?v=!0:(c.trackEvent(p.loadAdFailed,{},jQuery.extend(!0,{},h,{callfailreason:D(u.load),timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)})),I(u.load))}function T(e,t){var n=function(){};if(S(f.notSet))y(f.inLoadingProcess),e(h,n,t);else if(S(f.loaded))y(f.notSet),e(h,void 0,t);else if(S(f.visible)||S(f.inShowingProcess))y(f.inLoadingProcess),e(h,n,t);else if(V())v=!0;else if(S(f.inLoadingProcess))c.trackEvent(p.bannerReloadDuringLoad,m.extendCallbackParamsWithDemandConfig(d));else{var i=jQuery.extend(!0,{},h,{callfailreason:D(u.load),timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)});c.trackEvent(p.loadAdFailed,{},i),I(u.load)}}function F(e,t,n){r()?(y(f.inShowingProcess),e(h,t,n)):(c.trackEvent(p.showAdFail,{callfailreason:D(u.show)},h),I(u.show,n))}function x(e,t){d.productType!==a.BN?L(e,t):N(e,t)}function L(e,t){var n=!1;if((S(f.inLoadingProcess)||v)&&(n=!0),v=!1,S(f.internalLoadingProcess)?y(f.loadedFromInternalLoad):y(f.loaded),n){var i=jQuery.extend(!0,{},h,{timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)});i=b.extendEventDataWithElapsedLoadTime(d.productType,d.demandSourceName,i),c.trackEvent(p.loadAdSuccess,{},i),b.clearLoadStartTimeForInstance(d.productType,d.demandSourceName),s.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(d,t)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})])}}function N(e,t){(S(f.inLoadingProcess)||S(f.visible)||v)&&(c.trackEvent(p.loadAdSuccess,{},{timingvalue:s.InstancesTimers.stopLoadTimer(d.productType,d.demandSourceName)}),c.trackTimingStart(p.bannerLoadSuccessToVisible),s.callSDKFunction(e,m.extendCallbackParamsWithDemandConfig(d,t)),o.PubSub.publish("ProductStatesManager.stateResolved",[m.extendCallbackParamsWithProductConfig(d,{response:!0})])),v=!1,y(f.loaded)}function U(e,t){C(e,t,p.loadAdFailed)}function V(){return S(f.waitingToLoad)||S(f.internalLoadingProcess)}function M(){A()}function E(){A()}function k(){d.productType===a.BN?B():K()}function K(){y(g?f.inLoadingProcess:f.waitingToLoad)}function B(){y(f.notSet)}function R(){y(f.visible)}function j(){return S(f.failedInBackground)}var W={getAdState:i,init:w,load:P,show:F,cacheReady:x,noMoreOffers:U,failedToShow:M,failedToLoad:E,engageEnd:k,isFailedInBG:j,adVisible:R,resetAdState:A};return W}e.exports=n},{"./ProductAdapterConstants.js":139}],141:[function(c,e,t){e.exports=function(n,r,i){"use strict";var e,t=c("./AdapterSharedConfig"),a=c("./ProductAdapter"),o=[],s=!1;function d(){if(!r.RewardedVideo){var e=c("./AdapterSharedConfig"),t=c("./RewardedVideo/RewardedAdConfiguration")(e,r.SupplyConfigurations,i);r.RewardedVideo=new a(n,r,t,i),r.RewardedVideo.init()}return r.RewardedVideo}function l(e){return e&&"true"===e.rewarded?d():function(){if(!r.Interstitial){var e=c("./InterstitialDemandSource/AdConfiguration")(t,r.SupplyConfigurations,i);r.Interstitial=new a(n,r,e,i),r.Interstitial.init()}return r.Interstitial}()}return{initModule:function(){e||(o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.init,function(e,t,n){r.log("productRouter | NativeAPI.init"),t=n=function(){},l(e).initProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.load,function(e,t,n){r.log("productRouter | NativeAPI.load"),l(e).loadProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+t.NativeAPI.show,function(e,t,n){var i;(i=e,i&&"true"===i.rewarded?r.RewardedVideo:r.Interstitial).showProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".initRewardedVideo",function(e,t,n){d().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")})),o.push(n.PubSub.subscribe(i.CB+".showRewardedVideo",function(e,t,n){d().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")})),o.push(n.PubSub.subscribe(i.CB+".initBanner",function(e,t,n){var i;!e||e.inAppBidding||s||(s=!0,r.initBannerExternalService()),(i=e,r.Banner||(r.Banner=r.BannerFactory.create(i),r.Banner.init()),r.Banner).initProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".loadBanner",function(e,t,n){e.productType=i.BN,r.Banner.loadProduct(e,t,n)})),o.push(n.PubSub.subscribe(i.CB+".bannerViewVisible",function(e,t,n){r.Banner.showProduct(e,t,n)})),e=!0)},destroyListeners:function(){jQuery.each(o,function(e,t){n.PubSub.unsubscribe(t)}),e=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig":106,"./InterstitialDemandSource/AdConfiguration":133,"./ProductAdapter":137,"./RewardedVideo/RewardedAdConfiguration":142}],142:[function(e,t,n){t.exports=function(e,t,n){var i=t.shouldFetchNewFeedOnAdCloseFlag(n.RV);return i=void 0===i||i,{NativeAPI:e.NativeAPI,ControllerCallbacks:e.ControllerCallbacks,AdUnitCallbacks:e.AdUnitCallbacks,ControllerNativeAPI:e.NativeAPI,retriesLogic:e.retriesLogic,DemandName:"SupersonicAds",ProductName:n.RV,Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,shouldFetchNewFeedOnAdClose:i,isSupportFetchFeedOnAdCloseLogic:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0,isExhaustInstanceAllowed:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.RV.production},amountOfInventories:1,lwsSupported:!0}}},{}],143:[function(e,t,n){t.exports=function(e,t,n,i){var r=i.responseTypesWithReason,a={};function o(e){n.publishAvailabilityFalse("NoMoreOffers",e)}function s(e){t.log("Availability Manager | reportAdAvailable",t.LogLevels.verbose),n.isCurrentState(r.ready)||n.publishAvailabilityTrue(e)}return{setAMSettings:function(e,t){e&&"object"==typeof e&&(t?jQuery.extend(a,e):a=e)},cacheAdsFailed:function(e,t,n,i){e&&t?i():o(n)},cacheTimeoutFail:function(e){o(e)},canReportAvailable:function(e,t){a.reportOnAdunitReady&&a.isPreCache&&0!==a.numOfBannersToInitSuccess||s({numOfAdUnits:e,totalNumberCredits:t})},adLoadError:function(){o("Ad loaded with error")},inventoryEmpty:function(e){o(e)},reportAdAvailable:s,reset:function(){n.setLastResponse(r.none),a={}},adLoadedSuccessfully:function(e,t){t?s(e):(a.reportOnAdunitReady||a.preFetchAllVasts)&&a.isPreCache&&s(e)}}}},{}],144:[function(e,t,n){t.exports=function(n,e,i,r,t){var a=i.responseTypesWithReason,o=a.none,s=e.DemandUtils;function d(e){return o===e}function l(e,t){n.PubSub.publish(i.productType+"."+e,[s.extendCallbackParamsWithParentProductConfig(r,t)])}function c(){t.publish("InitiatedAPICall",[s.extendCallbackParamsWithProductConfig(r,{duringInit:!1})])}return{setLastResponse:function(e){o=e},getLastResponse:function(){return o},publishAvailabilityTrue:function(e){c(),l("CacheReady",jQuery.extend(e,{firstCampaignCredits:1})),o=a.ready},publishAvailabilityFalse:function(e,t){c(),d(a.notReady)||"NoMoreOffers"===e&&(l(e,{numOfAdUnits:0,firstCampaignCredits:0,totalNumberCredits:0,errorMsg:t}),o=a.notReady)},isCurrentState:d}}},{}],145:[function(e,t,n){t.exports=function(n,t,i,r){var a,e=!1,o=!1,s=!1,d=!1,l=!1,c=!1;function u(e){return e&&e.productType===i.productType&&(!i.demandSourceName||e.demandSourceName===i.demandSourceName)}return{init:function(){e||(n.PubSub.subscribe(r.taskManager+".InitiatedAPICall",function(e){u(e)&&n.Utils.isDefined(e.duringInit)&&(o=e.duringInit)}),n.PubSub.subscribe(r.taskManager+".AdErrorState",function(e){u(e)&&n.Utils.isDefined(e.error)&&(l=e.error)}),n.PubSub.subscribe(r.taskManager+".Engaged",function(e){u(e)&&n.Utils.isDefined(e.duringEngage)&&(s=e.duringEngage,t.log("duringEngage "+s+" on demand "+i.demandSourceName,t.LogLevels.verbose))}),n.PubSub.subscribe(r.taskManager+".CacheUpdateStatus",function(e){u(e)&&n.Utils.isDefined(e.duringCacheUpdate)&&(d=e.duringCacheUpdate)}),n.PubSub.subscribe(r.taskManager+".InitiatedTimeoutAttempt",function(e){u(e)&&n.Utils.isDefined(e.duringAPITimeoutAttempts)&&(c=e.duringAPITimeoutAttempts)}),e=!0,a=t[i.productType].getProductTM())},canEngage:function(){return!o&&!s&&a.canEngage()},canPreload:function(){var e=!l&&!o&&a.isConnected();return i&&i.isInAppBidding||(e=e&&!s),e},canInitCallToApi:function(){return s||o||d||!a.isConnected()?n.Utils.returnRejectedPromise():a.canInitCallToApi()},allowExternalCallToApi:function(){return!c},setConnection:function(e){return a.setConnection(e)},getStatusMsg:function(){return" duringInit:"+o+" duringEngage:"+s+" duringCacheUpdate:"+d+" error state:"+l+" during timeout attempts:"+c+a.getStatusMsg()},getStatus:function(){return{duringInit:o,duringEngage:s,duringCacheUpdate:d,adErrorState:l,timeoutAttempts:c,isConnected:a.isConnected()}},publish:function(e,t){n.PubSub.publish(r.taskManager+"."+e,t)}}}},{}],146:[function(n,e,t){e.exports=function(t,e,s,d){var l=n("./configurationValidator.js")(s,d.DebugLevels,d.errors),c=function(){var n=!0;return e.each(t.mobileSDKSettings,function(e,t){return e.match(/^deviceIds/)&&s.isDefined(t)&&t&&(n=!1),n}),n};return{parseConfiguration:function(e,t,n){var i,r,a=[],o=t.length;for(r=0;r<o;r++)s.isDefined(e[t[r]])||("applicationUserId"!==t[r]||c())&&a.push(t[r]);return 0<a.length?{didSucceed:(i={errMsg:d.errors.missing+JSON.stringify(a)},!1),errMsg:i}:l(e,n)},getDeviceApiLevel:function(){var e=t.mobileSDKSettings.deviceApiLevel;return"android"!==t.mobileSDKSettings.deviceOs||e?"ios"!==t.mobileSDKSettings.deviceOs||e||(e=t.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=t.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=t.mobileSDKSettings.deviceOSVersion;return"android"===t.mobileSDKSettings.deviceOs&&(e=t.mobileSDKSettings.deviceApiLevel?t.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":154}],147:[function(e,t,n){t.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},OWClosed:{name:"OWClosed",id:104},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},latencyTestSuccess:{name:"latencyTestSuccess",id:244},latencyTestFail:{name:"latencyTestFail",id:245},latencyTestException:{name:"latencyTestException",id:246},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270},omidStartSessionRequired:{name:"omidStartSessionRequired",id:364},omidStartSessionSuccess:{name:"omidStartSessionSuccess",id:365},omidFinishSessionRequired:{name:"omidFinishSessionRequired",id:366},omidFinishSessionSuccess:{name:"omidFinishSessionSuccess",id:367},removeContainerError:{name:"removeContainerError",id:190},linkActivationOnAd:{name:"linkActivationOnAd",id:324},auidFail:{name:"auidFail",id:197},patchOrientation:{name:"patchOrientation",id:343},initFailed:{name:"initFailed",id:344},setAdDisplayAlreadyAdShown:{name:"setAdDisplayAlreadyAdShown",id:350},webViewOpened:{name:"webViewOpened",id:376}}}},{}],148:[function(e,t,n){t.exports=function(){var a={},o="loadTimer",r={};function s(e,t){return e&&t?e+"."+t:null}function d(e,t){var n=s(e,t);return r.hasOwnProperty(n)?{timeElapsed:Date.now()-r[n],columnName:"custom_c"}:{timeElapsed:Date.now(),columnName:"custom_d"}}return{startLoadTimer:function(e,t){var n=s(e,t);n&&(a.hasOwnProperty(n)?a[n][o]&&window.timerService.stopTimer(a[n][o]):a[n]={},a[n][o]=window.timerService.startTimer())},stopLoadTimer:function(e,t){var n=s(e,t);if(!(n&&a[n]&&a[n][o]))return-1;var i=a[n][o],r=window.timerService.stopTimer(i);return delete a[n][o],r},clearInstanceTimers:function(e,t){var n=s(e,t);if(n&&a[n]){var i=a[n];for(var r in i)i.hasOwnProperty(r)&&window.timerService.stopTimer(i[r]);delete a[n]}},setLoadStartTimeForInstance:function(e,t,n){var i=s(e,t);!r.hasOwnProperty(i)&&n&&(r[i]=n)},getTimeElapsedFromLoadForInstance:d,clearLoadStartTimeForInstance:function(e,t){var n=s(e,t);r.hasOwnProperty(n)&&delete r[n]},extendEventDataWithElapsedLoadTime:function(e,t,n){var i=d(e,t);return n[i.columnName]=i.timeElapsed,n}}}},{}],149:[function(e,t,n){t.exports=function(t){var n="LoadedCreatives | ",i=t.AdUtils,r=[];function a(e){return e?void 0!==l(i.getAdId(e),e):(c("in _isExistAd without ad"),!1)}function o(){return r.length}function s(e,t){return e.productType===t.productType&&(!t.demandSourceName||e.demandSourceName===t.demandSourceName)}function d(t,n){return function(e){return s(e,n)&&i.getAdId(e)==t}}function l(e,t){var n=d(e,t),i=r.filter(n);return 0<i.length?i[0]:void 0}function c(e){t.log(n+e)}return{isExistAd:a,addAd:function(e){return c("_addAd"),e?a(e)?(c("_addAd ad already exist"),!1):(r.push(e),!0):(c("_addAd ad is undefined"),!1)},removeAdById:function(e,t){c("_isExistAd adId = "+e);var n=d(e,t),i=o();return r=r.filter(function(e){return!n(e)}),i!==o()},getAdById:l,getAds:function(t){return r.filter(function(e){return s(e,t)})},getAdsByProductType:function(t){return r.filter(function(e){return e.productType===t.productType})},size:o,toArray:function(){return r.slice()},printAll:function(){r.forEach(function(e){t.log("adViewId "+e.adViewId)})}}}},{}],150:[function(t,e,n){e.exports=function(e,r){var a=t("../DemandSource/DemandEntityBuilder.js"),o=e&&e.instancesMap,s=e&&e.waterfallMap;return{createDemandEntityConfigObj:function(e){var t=function(e,t){var n=o&&o[r.sspProductNames[e]];if(n)for(var i=0;i<n.length;i++)if(-1!==n[i].instances.indexOf(t))return{demandGroupName:n[i].demandGroupName,isInstance:!0}}(e.productType,e.demandSourceName)||{},n=!0===t.isInstance?r.demandSourceType.instance:r.demandSourceType.demandSource,i={demandGroupName:t.demandGroupName,demandSourceName:e.demandSourceName,demandType:n,isInAppBidding:e.isInAppBidding,demandSourceId:e.demandSourceId,waterfallPosition:function(e,t){var n=s&&s[r.sspProductNames[e]];if(n)return n[t]}(e.productType,e.demandSourceName),originalDemandSourceName:e.originalDemandSourceName,adSize:e.adSize};return new a({productType:e.productType},i)}}}},{"../DemandSource/DemandEntityBuilder.js":119}],151:[function(e,t,n){t.exports=function(i,r,a,n){var o="$$";return{handler:function(e){return!!((t=e)&&"string"==typeof t.data&&0<t.data.length)&&(0===e.data.indexOf(o)?function(e){var t=e.slice(o.length);if(!t)return!1;var n=a.getParams(t);return a.isDefined(n.event)?(r.log("received event: "+n.event,r.LogLevels.verbose),i.publish("SDKController."+n.event,[n]),!0):a.isDefined(n.name)&&a.isDefined(n.parameters)?(r.log("received event: "+n.name,r.LogLevels.verbose),i.publish("SDKController."+n.name,[n.parameters]),!0):void 0}(e.data):function(t){try{var e=JSON.parse(t);return a.extend(e.arguments,{callback:n(e.id)}),i.publish("SDKController."+e.method,[e.arguments]),!0}catch(e){r.log("SDKController | unable to parse message: "+JSON.stringify(t),r.LogLevels.error)}return!1}(e.data));var t}}}},{}],152:[function(Ai,e,t){function R(g,v,m){var h="SDKController | ",o=Ai("../../patches/PatchAppOrientation"),i=Ai("./MessageHandler"),c=Ai("../../presenter/uiConfig.js"),n=Ai("../../components/Logger.js")(g.Utils),r=Ai("../AdUnitManager/AdUnitGlobals.js")(m),e=Ai("../AdPlayer/AdPlayerAssets"),t=Ai("../AdUnitManager/LibsManager.js")(g.Utils),a=Ai("../../components/DisplayedAdManager.js"),s=Ai("../AdUnitUrl.js")(r,g.Utils),d=new(Ai("../AdPlayer/AdPlayerUrl"))(g.Utils),l=Ai("./mainConfig.js")(),u=new(Ai("../../components/ExternalConfig")),f=new(Ai("../../components/BlacklistService"))(m),b=new(Ai("../../components/FrameHelper.js"))(n,v),p=Ai("./ConfigurationHelper.js"),S=Ai("../../components/AdOrientationManager"),y=Ai("../../components/containers/WebViewManager.js"),A=Ai("../../components/containers/AdViewsManager.js"),C=Ai("../../components/containers/BannerExternalContainer.js"),D=Ai("./sessionConfig")(),I=Ai("../../components/NativeLifeCycleEventsConstants.js"),w=new(Ai("../../components/NotchFactory.js"))(v,m),P=Ai("../../components/token/TokenService.js"),O=Ai("../UserSegmentation/SegmentationManager"),T=Ai("../UserSegmentation/SegmentationAllocator.js"),F=Ai("../../components/NativeAPIAdapter.js"),x=Ai("../../constants/SDKFeatureNames"),L,N,U,V,M,E,k,K,B,R,j,W,_,G,H,q,Q,J=!1,z,X,$=g.Utils,Y=g.PubSub,Z=null,ee,te=!1,ne=!0,ie=!1,re=m.CB,ae=m.RV,oe=m.OW,se=m.IS,de=m.BN,le=m.errors,ce=m.videoStates,ue=m.closeButtonStates,fe=m.featureCompatibilityMap,pe=m.confirmCloseMsg,ge=m.requiredDeviceInfo,ve=m.requiredAppInfo,me=m.optionalAppInfo,he={v:"3.1.75",controllerbn:"2071",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,safeAreaInsets:null,ext:{}},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,skd:null},configMapping:{jb:function(){return he.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null},userType:SuperSonicGlobalConfig.userType},be={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},Se="mobileController.min.css",ye=SuperSonicGlobalConfig.mobileSDKSettings.isProd?"/versions/"+he.v+"/"+Se:he.v+"/"+Se,Ae,Ce,De,Ie,we,Pe,Oe,Te=!1,Fe=0,xe=3,Le,Ne,Ue,Ve={defaultBehavior:0,adunitResponsibility:1},Me={close:1,nextFrame:2},Ee=m.defaultOrientation,ke={none:0,device:1,controller:2},Ke=c.style.defaultControlFrames,Be=m.blockedProductsPerApiLevel,Re=m.storeSearchKeys,je={scrollHeight:""},We={RewardedVideo:{},Interstitial:{},OfferWall:Ve.defaultBehavior,Banner:Ve.defaultBehavior},_e={RewardedVideo:{},Interstitial:{},OfferWall:ue.close,Banner:ue.closeBanner},Ge={RewardedVideo:ue.close,Interstitial:ue.close,OfferWall:ue.close,Banner:ue.closeBanner},He={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},qe=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"},{url:"https://ow-gateway.supersonicads.com/delivery/mobilePanel.php",method:"GET",region:"all"}],Qe,Je,ze=!1,Xe=m.appExtConfigPath,$e=m.appExtConfigPathStaging,Ye=c.templates.mainDefaultTemplate,Ze=c.templates.defaultDialogBoxTemplate,et=c.templates.defaultNavigationTemplate,tt=c.templates.loaderOWTemplate,nt=c.templates.loaderOWOfferTemplate,it=g.Eventics,rt=Ai("../../modules/SDKController/EventCategories")(),at=function(e,t){var n=W.getDisplayedAdType(),i={productType:"UnKnown",action:"stopTiming",eventParam:{eName:rt.adClosed,data:{eNameStart:rt.adVisibleToClose}}};if(t&&t.customData&&t.customData.click&&v.extend(i.eventParam.data,t.customData.click),t&&t.frameType&&(i.eventParam.data.frameType=t.frameType),e&&(i.eventParam.data.generalMessage=e),n){n===m.OW&&(i.eventParam.eName=rt.OWClosed,z.callSDKFunction("removeCloseEventHandler")),i.productType=n;var r=W.getDisplayedAdDemandName();r&&(i.demandSourceName=r);var a={productType:i.productType,demandSourceName:i.demandSourceName};t&&t.customData&&"object"==typeof t.customData&&v.extend(a,t.customData),a.ad=W.get(),Y.publish("SDKController.Analytics",[i]),Y.publish("SDKController.adClosed",[a])}else Y.publish("SDKController.Analytics",[i])},ot=function(e,t,n,i){var r,a=e.length,o=!0,s=[],d=null;for(r=0;r<a;r++)$.isDefined(t[e[r]])||(s.push(e[r]),o=!1);return o||(d=le.missing+JSON.stringify(s)+" in "+n,$.isDefined(i)&&i&&z.callSDKFunction(i,{errMsg:d}),z.log(d,z.LogLevels.error)),{didSucceed:o,errMsg:d}},st=function(){v.fn.textfill2=function(e){var t,n,i=e.maxFontPixels,r=e.maxHeight,a=e.maxWidth,o=void 0!==e.parentContainer?v(e.parentContainer):null,s=v(this),d=null!==o?o.height():v(this).parent().height(),l=null!==o?o.width():v(this).parent().width();return void 0!==r&&(d=r),void 0!==a&&(l=a),s.each(function(){for(i=e.maxFontPixels;v(this).css({"font-size":i}),i-=1,e.lineHeight&&o.css({"line-height":e.lineHeight+"em"}),t=v(this).height(),n=v(this).width(),d<t||l<n&&3<i;);}),this},v.fn.textWidth=function(){var e,t=v(this).children(),n=v('<span style="display: inline-block;" />');return t.wrap(n),e=t.parent().width(),t.unwrap(),e}},dt=function(){Y.subscribe(re+".initProducts",function(e,t,n){v.when(yt(e)).then(function(){"use strict";$.isDefined(t)&&z.callSDKFunction(t),At(e)},function(e){"use strict";$.isDefined(n)&&z.callSDKFunction(n,{errMsg:e})})}),Y.subscribe(re+".nativeNavigationPressed",function(){if(W.isDisplayed()){var e=W.getDisplayedAdType(),t=W.getDisplayedAdDemandName();if(!ie){var n,i=W.get()||{};if((n=i.settings||{}).hasOwnProperty("disableBB")&&!n.disableBB||"offerwall"===e.toLowerCase())(t?We[e][t]:We[e])===Ve.adunitResponsibility?Lt({name:"backButtonPressed"}):Jt()}}}),Y.subscribe(re+".engageEnd",function(e){if(!ut())if("forceClose"===e.action)at(),jt(!1,!1),G.onEngageEnd();else if("secondaryClose"===e.action){var t=W.getDisplayedAdType();B.returnFromNavigationMode(It,je,t,Pt),t===oe&&Y.publish("SDKController.AdClosed",[W.get()])}}),Y.subscribe(re+".failedToStartStoreActivity",function(e){if(e){z.log("failedToStartStoreActivity | params: "+JSON.stringify(e),z.LogLevels.info);var t={};t.rvnomoreoffersreason=decodeURIComponent(e.url);var n=W.getDisplayedAdType();n&&(t.productType=n),Ie.trackEvent(rt.failedToStartStoreActivity,{generalMessage:decodeURIComponent(e.errMsg)},t)}}),Y.subscribe(re+".interceptedUrlToStore",function(e){W.isDisplayed()&&Lt({name:"interceptedUrlToStore",intercept:!0})}),Y.subscribe(re+".pageFinished",function(){Lt({name:"pageFinished"})}),Y.subscribe(re+".enterBackground",function(e){z.log("entered BG");var t={name:"enterBackground"};e&&$.isDefined(e.action)&&(t.action=e.action),Lt(t)}),Y.subscribe(re+".enterForeground",function(e){var t=K.getContainerState();z.log("entered FG | webview is "+JSON.stringify(t));var n={name:"enterForeground"};e&&$.isDefined(e.active)&&(n.active=e.active),t.engaged&&t.opened&&he.mobileSDKSettings.deviceOs===m.deviceOs.android&&!t.standalone&&(W.isDisplayed()&&at(),jt(!1,!1)),Lt(n)}),Y.subscribe(re+".viewableChange",function(e){var t={name:"viewableChange"};if(e&&$.isDefined(e.isViewable)){var n=W.getDisplayedAdType();if("Banner"===n&&(e.changeReason===m.viewableChangeReasons.storeKitClose||e.changeReason===m.viewableChangeReasons.storeKitOpen))return void z.log("viewableChange from Banner storeKit - ignored",z.LogLevels.info);if(Te=e.isViewable,z.StoreKitService.isStoreKitVisible()&&(Lt({name:"viewableChangeInSK",isViewable:Te}),Te))return;z.SKOverlayManager.isSKOverlayVisible()&&Lt({name:"viewableChangeInOV",isViewable:Te}),z.log("viewableChange to:"+e.isViewable),$.isDefined(e.webview)&&"main"!==e.webview||K.setContainerVisibility(e.isViewable),t.isViewable=e.isViewable,W.isDisplayed()&&Gt(),$.isDefined(e.webview)&&(t.webview=e.webview),n&&(t.productType=n),e.changeReason&&(t.changeReason=e.changeReason)}Lt(t),e&&$.isDefined(e.isViewable)&&K.triggerRedraw()}),Y.subscribe(re+".deviceStatusChanged",function(e){var t=v.extend({name:"deviceStatusChanged"},e);Lt(t),g.Utils.isDefined(e.connectionType)&&(it.updateBaseData({connectionType:e.connectionType}),ne="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),Y.subscribe(re+".parseBandwidth",function(e){z.log(JSON.stringify(e),3)}),Y.subscribe(re+".getBandwidthFailed",function(e){z.log(JSON.stringify(e),3),z.log("getBandwidth Failed",z.LogLevels.error)}),Y.subscribe("SDKController.GetConfig",function(e){e&&e.productType&&Y.publish(e.productType+".GetConfig",[e])}),Y.subscribe("SDKController.GetCompletionOffers",function(e){e&&e.productType&&Y.publish(e.productType+".GetCompletionOffers",[e])}),Y.subscribe("SDKController.ActionClick",function(e){e&&e.productType&&Y.publish(e.productType+".ActionClick",[e])}),Y.subscribe("SDKController.OpenUrl",function(e){ot(["url","method"],e,"openUrl").didSucceed?(z.log("Request to open external url",z.LogLevels.info),wt(e)):z.log("error calling open url with "+JSON.stringify(e),z.LogLevels.error)}),Y.subscribe("SDKController.nativePixel",function(e){ot(["url"],e,"nativePixel").didSucceed?(z.log("Request to send click in native api",z.LogLevels.info),Zn(e.url)):z.log("error sending safe click "+JSON.stringify(e),z.LogLevels.error)}),Y.subscribe("SDKController.FirePixel",function(e){ot(["url"],e,"FirePixel").didSucceed?(z.log("Request to fire pixel from controller",z.LogLevels.info),"native"===e.type&&Zn(e.url)||ei(e)):z.log("error firing pixel "+JSON.stringify(e),z.LogLevels.error)}),Y.subscribe("SDKController.adEventNotification",function(e){z.log("ad notified controller with event: "+JSON.stringify(e),z.LogLevels.info),ot(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&ti(e.eventName,e.productType,e.dsName,e.extData)}),Y.subscribe("SDKController.hideClose",function(e){var t=ee.getAdById(z.AdUtils.getAdId(e),e);if(t){var n=K.getAdViewByAd(t);n.data("close",!1),K.isViewDisplayed(n,t)&&Ct()}else z.log("line[1196]: ERROR",z.LogLevels.error)}),Y.subscribe("SDKController.AdClose",function(e){e.ignoreClick?en():Jt(e)}),Y.subscribe("SDKController.closeAdunit",function(e){at(),jt(!1)}),Y.subscribe("SDKController.setBackButtonState",function(e){if(e&&e.state&&e.productType){var t="default"===e.state?Ve.defaultBehavior:Ve[e.state];e.demandSourceName?We[e.productType][e.demandSourceName]=t:We[e.productType]=t}}),Y.subscribe("SDKController.setCloseButtonState",function(e){jn(e)}),Y.subscribe("SDKController.ScrollHeight",function(e){var t,n,i;g.Utils.isDefined(e.value)&&(t=e.value,z.log("scroll height is: "+t,z.LogLevels.info),v.when(zt()).then(function(e){i=W.getDisplayedAdType(),n=i&&"application"===Ee[i]&&E.isAppOrientation("portrait")?Math.max(e.height,e.width):i&&$.isDefined(i)&&"application"===Ee[i]&&E.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,t<n&&(t=n),z.log("min scroll height is: "+n+"scroll height was set to: "+t+" screen height: "+e.height,z.LogLevels.verbose),je.scrollHeight=t,he.mobileSDKSettings.deviceOs!==m.deviceOs.android&&v("body").css("height",je.scrollHeight)}))}),Y.subscribe("SDKController.scrollTop",function(){z.log("scrollTop",z.LogLevels.verbose),setTimeout(function(){v("html,body").scrollTop(0)},1e3)}),Y.subscribe("SDKController.getScreenSize",function(){v.when(zt()).then(function(e){Lt({name:"screenSize",width:e.width,height:e.height,orientation:e.orientation,scrollTop:e.scrollTop})})}),Y.subscribe("SDKController.showNoConnectionMessage",function(){var e={productType:oe,message:"You are not connected to the internet, please connect and try again.",yes:"close",no:"OK"};z.alert(e)}),Y.subscribe("SDKController.GetDeviceVolume",function(e){$.isDefined(e.callback)&&En(e.callback)}),Y.subscribe(I.serviceCallback+"."+I.AndroidEvents.onDestroy,function(e){z.log("SDKController | received event | onDestroy",z.LogLevels.verbose),ut()?z.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),z.LogLevels.verbose):ft()}),Y.subscribe(m.CB+".unauthorizedMessage",function(e){Ie.trackEvent(rt.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),z.log("SDKController | Failed to authorize message",z.LogLevels.error)}),Y.subscribe(m.CB+".linkActivationOnAd",function(e){e&&e.url&&Ie.trackEvent(rt.linkActivationOnAd,{generalMessage:e.url})}),Y.subscribe("SDKController.onOmidStartSessionRequired",function(e){Ie.trackEvent(rt.omidStartSessionRequired,{generalMessage:e})}),Y.subscribe("SDKController.onOmidStartSessionSuccess",function(e){Ie.trackEvent(rt.omidStartSessionSuccess,{generalMessage:e})}),Y.subscribe("SDKController.onOmidFinishSessionRequired",function(e){Ie.trackEvent(rt.omidFinishSessionRequired,{generalMessage:e})}),Y.subscribe("SDKController.onOmidFinishSessionSuccess",function(e){Ie.trackEvent(rt.omidFinishSessionSuccess,{generalMessage:e})}),Y.subscribe("SDKController.onOmidServiceFailure",function(e){Ie.trackEvent(rt.omidServiceFailure,{generalMessage:e})}),Y.subscribe("SDKController.removeContainerError",function(e){e&&e.errMsg&&Ie.trackEvent(rt.removeContainerError,{callFailReason:e.errMsg})})};function lt(){q=Ai("./videoStateHandler.js")(g.PubSub,z),Q=Ai("./nativeConfigHandler.js")(g.PubSub,z)}function ct(){var e={productChance:(z.getEnv(),1),protocol:he.mobileSDKSettings.protocol?he.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};Ie=it.createEventic(e,z.EventsManager)}function ut(){var e=Gn(W.get());return!e||!g.Utils.isFunction(e.shouldAvoidHandleFrameClose)||e.shouldAvoidHandleFrameClose()}function ft(){z.log("SDKController.js | handleFrameDestroyed",z.LogLevels.verbose),W.isDisplayed()&&at(m.adClosedErrorReason.unexpectedCloseActivityDestroy),jt(!1,!1),nn()}var pt=function(){v("body").append(Ye+Ze+et+tt);for(var e="",t=0;t<10;t++)e+=nt;v(".loaderOW .offers").prepend(e),on()};function gt(){Y.subscribe(re+".acknowledgeMessage",function(e){U.acknowledgeMessage(e)})}function vt(e){var t=new i(g.PubSub,z,g.Utils,Fn);g.Msg.init(z,t.handler,sn),Y.init();var n=Ai("../SDKInterface.js");Ce=new n(he.mobileSDKSettings,m,z,e),U=new F(z,g,Ce,v),gt()}function mt(){n.init(he.mobileSDKSettings.deviceOs,Ce,he.mobileSDKSettings.debug,z.PixelTrackingService.firePixel),Y.subscribe("SDKController.log",function(e){$.isDefined(e.debugLevel)&&$.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),z.log(e.msg,e.debugLevel,e.origin))})}var ht=function(){t.init(n,v,z.Cache),r.init(n,he.mobileSDKSettings,v,z.Cache,cn(),s,t,z.getEnv(),g,rt),H=new e(m.adPlayerDirectory,he.mobileSDKSettings,z.getEnv(),d,z.Cache,cn(),g,v),f.init(n),W=new a(z,Ie,rt,m),z.ProductRouter=Ai("../ProductRouter.js")(g,z,m),z.ProductRouter.initModule(),z.OfferWall.init({supplyConfig:z.SupplyConfigurations.getOfferWallConfig()})};function bt(){z.HTTPService.init(),z.OrientationService.init(Ie),z.GDPRService.init(),St()&&z.RingerSwitchService.init(),z.NativeLifeCycleEventsService.init(),bn();var e=Ai("../../components/containers/WebView"),t=Ai("../../components/containers/BackgroundController"),n=Ai("../../components/containers/NavigationModeView"),i=Ai("../../components/IframeManager"),r=Ai("../../components/containers/BannerExternalAdViewService"),a=new t(z,m,c),o=Ai("../../components/containers/WPADUtils")(z),s=new e(g,z,c.style.forceCloseProperties,m,a,M),d=new i(z,m,b,W),l=new y(g,z,m,W);K=new A(z,d,l,s,W),B=new n(z,K,s),j=new r(g,z,m,W),R=new C(g,z,j,o.generateBannerAdViewId()),_=new P(g,z,m,Ie,rt),z.AppUserIdService.init(Ie),(L=new O(g,z)).init(),N=new T(L),z.AndroidNomediaFileHandler.init(Ie),z.DeviceDataService.init(Ie)}function St(){return he.mobileSDKSettings.deviceOs===m.deviceOs.ios&&"wk"===he.mobileSDKSettings.webviewType}var yt=function(e){var t=new v.Deferred;z.log("Products info received: "+JSON.stringify(e),z.LogLevels.info);var n,i,r,a=me.length,o=[];for(n=0;n<a;n++)$.isDefined(e[me[n]])||(he.applicationSettings[me[n]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&o.push(i);return un(o),(r=k.parseConfiguration(e,ve,he.applicationSettings)).didSucceed?t.resolve():t.reject(r.errMsg),t.promise()},At=function(e){v.each(e.products,function(e,t){g.hasOwnProperty(t)&&$.isFunction(g[t].init)&&g[t].init()})},Ct=function(){De.addClass("ssaOnAdUnitCloseVisible")},Dt=function(){De.removeClass("ssaOnAdUnitCloseVisible")},It=function(e,t,n){if(Rt()&&Lt({name:"dialogBoxAboutToClose",shouldResume:e}),!t||!Rt()){if(v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").css("display","none"),$.isFunction(n))return void n.call();b.getDisplayedAdFrame()&&Lt({name:"showFrame"})}we.fadeOut(100,function(){v(".dialogBox").css("visibility","hidden"),v("#ssaDialogBoxOverlay").fadeOut(100,function(){$.isFunction(n)?n.call():b.getDisplayedAdFrame()&&Lt({name:"showFrame"})})})},wt=function(t,n){var i,r=[],e=null,a=null;function o(){var e=W.getDisplayedAdType();W.isDisplayed()&&Y.publish("SDKController.AdOpened",[{productType:e}]),n&&n.call(null)}if(a=Y.subscribe(re+".openUrlFailure",function(e){clearTimeout(i),Y.clearHandlers(r),Y.unsubscribe(a);var t=$.isDefined(e.errMsg)?e.errMsg:"Unknown reason for error",n=W.getDisplayedAdType()||"";Ie.trackEvent(rt.openUrlError,{generalMessage:t},{productType:n}),z.log("SDK failed to open url",z.LogLevels.verbose)}),e=fi()&&"webview"===t.method?Y.subscribe(re+".openUrlSuccess",function(){if(clearTimeout(i),Y.clearHandlers(r),t.controls){var e=W.getDisplayedAdType();B.changeToNavigationMode(It,De,je,e,Pt)}o()}):Y.subscribe(re+".viewableChange",function(e){clearTimeout(i),Y.clearHandlers(r),!$.isDefined(e.isViewable)||e.isViewable||he.mobileSDKSettings.deviceOs===m.deviceOs.android&&"main"!==e.webview||o()}),r.push(a),r.push(e),"storeKit"===t.method&&(he.mobileSDKSettings.deviceOs!==m.deviceOs.ios||z.isLegacy({ios:"5.17",android:"99"})?t.method="external_browser":t.method="store"),"store"===t.method){var s=z.StoreKitService.getStoreObject(t.viewUniqueId);if(!z.StoreKitService.canPresentStoreKitObj(s))return void Y.publish("StoreKit.storeKitCoolDown",["SDKController try to load twice storeKit. viewUniqueId = "+t.viewUniqueId]);z.StoreKitService.setStoreKitObjectPresentingProgress(s)}"webview"===t.method&&t.controls?he.mobileSDKSettings.deviceOs===m.deviceOs.android?z.callSDKFunction("openUrl",{url:t.url,method:"webview"},"openUrlSuccess","openUrlFailure"):z.callSDKFunction("openUrl",{url:t.url,method:t.method,controlFrames:Ke},"openUrlSuccess","openUrlFailure"):z.callSDKFunction("openUrl",{url:t.url,method:t.method,appId:t.appId,viewUniqueId:t.viewUniqueId},"openUrlSuccess","openUrlFailure"),i=setTimeout(function(){Y.unsubscribe(e),"ios"===z.getApiData({deviceOs:1}).deviceOs&&parseFloat(z.getConfigurationHelper().getDeviceOsVersion())<8&&n&&n.call(null)},500)},Pt=function(){De.unbind("touchend").bind("touchend",Jt),Ot(Me.close),Oe.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault(),Y.publish("SDKController.dialogBoxResume",[W.get()]),It(!0,!0)})},Ot=function(n){Pe.unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault();var t=ne?n:Me.close;switch(Y.publish("SDKController.dialogBoxExit",[W.get()]),t){case Me.nextFrame:Lt({name:"moveToNextFrame"}),It(!1,!0);break;case Me.close:W.isDisplayed()?(Lt({name:"confirmCloseClicked"}),It(!1,!0)):jt(!0)}})};function Tt(t){z.log(h+"broadcastMessageToAllAdViews"),R.checkStatusOfAdView().then(function(e){e&&e.isExternalAdViewInitiated&&R.sendMessageToExternalAdView(t)}),K.sendMessageToAllAdViews(t)}function Ft(e){return e===m.BN&&!z.isBannerAndLoadWhileShowSupported(e)}function xt(e,t){if(t)return t.settings.viewType===m.viewTypes.externalView&&Ft(t.productType)?R.sendMessageToExternalAdView(e):(z.log("sendMessageToDisplayedAdView | posting to DISPLAYED ad unit"),K.sendMessageToAdView(e,t));var n="";try{n=JSON.stringify(e)}catch(e){}z.log("sendMessageToDisplayedAdView | can't find displayed ad. "+n)}var Lt=function(e,t){if("string"==typeof e)throw new Error("postAdUnitEvent message type not supported "+typeof e);return z.log(h+"postAdUnitEvent | before posting to ad unit"+JSON.stringify(e)),t?Tt(e):xt(e,W.get())};function Nt(){var e=W.getDisplayedAdType(),t=W.getDisplayedAdDemandName();z.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+t,z.LogLevels.verbose),e&&(t?(_e[e][t]=ue.close,We[e][t]=Ve.defaultBehavior):(_e[e]=ue.close,We[e]=Ve.defaultBehavior))}function Ut(e){for(var t=v("#ssaDialogBox"),n=t[0]&&t[0].className.split(" "),i=0;i<n.length;i++){var r=n[i];r!==m.styleAccordingToProtocol.secured&&r!==m.styleAccordingToProtocol.unsecured||t.removeClass(r),r.match(/template.*/)&&t.removeClass(r)}var a=he.mobileSDKSettings.protocol===m.protocol.https?m.styleAccordingToProtocol.secured:m.styleAccordingToProtocol.unsecured;t.addClass(a),e.settings.templateid&&t.addClass("template"+e.settings.templateid)}function Vt(e){e?Dt():Ct()}function Mt(){Kt()}var Et=function(e,t){var n=v.Deferred();return z.log("SDKController | onAdUnitOpen"),Ot(Me.close),K.displayContainer(e),v.when(Xt(e)).then(function(){tn(),Ut(e),K.handleScreenVisible(t,e),n.resolve()}).fail(function(e){n.reject(e)}),n.promise()};function kt(e){e&&(z.ImpressionsCounterService.setInstanceImpressionsCounter(e),_.updateToken(z.ImpressionsCounterService.getTokenCounters()))}var Kt=function(){var t=W.get(),e=W.getDisplayedAdType();try{clearTimeout(Le),t?(t.onAdVisibleFlag=!0,Ht()):z.log("_shouldReceiveMessage"),t&&t.settings&&z.LastSeenCampaignService.setLastDisplayedAdCampaignId(t.cid,e,t.settings),kt(t),Bt(t)&&t.showAdCallbacks&&t.showAdCallbacks.onShowSuccess(),z.log("SDKController | onAdVisible"),Y.publish("SDKController.AdVisible",[t]),Lt({name:"adVisible",productType:e})}catch(e){throw z.log("SDKController | onAdVisible | Exception"),Bt(t)&&t.showAdCallbacks&&t.showAdCallbacks.onShowFailed(m.errors.showAdFailedReasons.onAdVisibleFailed+": "+JSON.stringify(e)),e}};function Bt(e){return!(!e||!e.settings)&&!!e.settings.enableNewShowAdFlow}function Rt(){return $.isVisible(we)}var jt=function(e,t){z.RingerSwitchService.isInitiated()&&z.RingerSwitchService.stopListener(),je.scrollHeight="",v("body").css("height",je.scrollHeight);var n=function(){Wt(t)};Rt()?It(!1,e,n):n()};function Wt(e){var t=function(){},n=W.get();if(W.reset(),e&&K.displayLoader(n.productType),z.callSDKFunction("setBackButtonState",{state:ke.controller}),e?Dt():t=_t.bind(this,n),n)return n.engaged=!0,void Dn(n,{preloadNextInBG:!e},t);K.unloadProductFromContainer(),t()}var _t=function(e){z.log("SDKController | ad unit close done",z.LogLevels.verbose),e&&e.isWPAD?(z.log("SDKController | ad unit close done wpad",z.LogLevels.verbose),K.hideContainer(e)):(setTimeout(function(){z.log("SDKController | closing webview with currentAd "+JSON.stringify(e),z.LogLevels.verbose),K.hideContainer(e)},250),e&&e.settings&&e.settings.setContainerBGColorBlack&&K.setContainerBGColorTransparent())},Gt=function(){if(!ie){var e,t=W.get(),n=W.getDisplayedAdType(),i=W.getDisplayedAdDemandName(),r=W.getDisplayedAdSettings(),a={eventParam:{eName:rt.userClosedBeforeAdVisible},action:"startTiming",productType:n,demandSourceName:i};Y.publish("SDKController.Analytics",[a]),t&&t.isScreenVisibleTimedOut||(e=n===m.OW?r&&(r.OLXD||0===r.OLXD)?1e3*r.OLXD:m.closeAndBackDisabledTimerOW:m.closeAndBackDisabledTimer,qt(),ie=!0,Le=setTimeout(function(){Ht()},e))}},Ht=function(){Qt(),ie=!1},qt=function(){v("#ssaNavigatorCloseButton").addClass("invisible")},Qt=function(){v("#ssaNavigatorCloseButton").removeClass("invisible")},Jt=function(e){K.hideLoader(),en();var t=W.get(),n=W.getDisplayedAdType(),i=W.getDisplayedAdDemandName();if(!n)return at(null,e),void jt(!1);var r=rn(n);switch(!t||t.onAdVisibleFlag||ie||(!function(e,t,n){Ne&&(clearTimeout(Ne),Y.unsubscribe(Ue),e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(m.errors.showAdFailedReasons.userClosedBeforeAdVisible));var i={eventParam:{eName:rt.userClosedBeforeAdVisible},action:"fireEvent",productType:t,demandSourceName:n};Y.publish("SDKController.Analytics",[i])}(t,n,i),e&&"touchend"===e.type&&(r=ue.close)),r){case ue.close:z.ViewsManager.waitForAllViews().then(function(){nn(),at(null,e),jt(!1)});break;case ue.closeBanner:nn(),jt(!1);break;case ue.confirm:Ot(Me.close),z.alert(an(productType,i));break;case ue.confirmNextFrame:Ot(Me.nextFrame),z.alert(an(productType,i));break;case ue.nextFrame:Lt({name:"moveToNextFrame"});break;case ue.ignore:}},zt=function(){var n="deviceScreenSize[width]",i="deviceScreenSize[height]",r=m.appInfo.orientation.portrait,a=m.appInfo.orientation.landscape,o=m.defaultOrientation,s=he.mobileSDKSettings[n],d=he.mobileSDKSettings[n],l=new v.Deferred;return v.when(z.OrientationService.oldGetOrientation()).then(function(e){var t=W.getDisplayedAdType();!t||o[t]!==a&&o[t]!==r||(e=o[t]),e===a&&(s=Math.max(he.mobileSDKSettings[n],he.mobileSDKSettings[i]),d=Math.min(he.mobileSDKSettings[n],he.mobileSDKSettings[i])),e===r&&(s=Math.min(he.mobileSDKSettings[n],he.mobileSDKSettings[i]),d=Math.max(he.mobileSDKSettings[n],he.mobileSDKSettings[i])),he.mobileSDKSettings.deviceOs===m.deviceOs.android&&(s/=he.mobileSDKSettings.deviceScreenScale,d/=he.mobileSDKSettings.deviceScreenScale),l.resolve({width:s,height:d,orientation:e,scrollTop:v(window).scrollTop()})}),l.promise()},Xt=function(e){return Bt(e)?$t(e):Yt()},$t=function(t){var n=new v.Deferred;if(Te)return n.resolve();return!t||t.productType!==m.RV&&t.productType!==m.IS||(W.set(t),Ne=setTimeout(function(){Dt(),t.isScreenVisibleTimedOut=!0,Y.unsubscribe(Ue),n.reject(m.errors.showAdFailedReasons.screenVisibleTimeout)},t&&t.settings&&t.settings.screenVisibleTimeout||12e3)),Ue=Y.subscribe(re+".viewableChange",function(e){e&&$.isDefined(e.isViewable)&&e.isViewable&&(z.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,z.LogLevels.info),Ie.trackEvent(rt.webViewOpened,{},z.AdUtils.extractEventData(t)),clearTimeout(Ne),Y.unsubscribe(Ue),n.resolve())}),n.promise()};function Yt(){var t,n=new v.Deferred;return Te?n.resolve():t=Y.subscribe(re+".viewableChange",function(e){e&&$.isDefined(e.isViewable)&&e.isViewable&&(z.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,z.LogLevels.info),Y.unsubscribe(t),n.resolve())}),n.promise()}var Zt=function(e){if(e.productType!==m.BN||e.isInAppBidding)z.isBannerAndLoadWhileShowSupported(e.productType)&&W.set(e),K.onAdUnitLoaded(e,Vt,Mt);else{R.onBannerViewLoaded(function(){W.set(e)},Mt)}},en=function(){z.callSDKFunction("removeCloseEventHandler",z.ViewsManager.getDisplayWebViewParams(!1))};function tn(){z.NativeLifeCycleEventsService.startNotify(I.AndroidEvents.onDestroy)}function nn(){z.NativeLifeCycleEventsService.stopNotify(I.AndroidEvents.onDestroy)}function rn(e){var t=W.getDisplayedAdDemandName();if(e)return(t?_e[e][t]:_e[e])||Ge[e]}function an(e,t){var n=z[e];return n&&n.getConfirmCloseMsg&&n.getConfirmCloseMsg(t)||pe}var on=function(){De=v("#ssaNavigatorCloseButton"),we=v("#ssaDialogBox"),Pe=v("#ssaDialogConfirmBtn"),Oe=v("#ssaDialogCancelBtn"),Ae=v("#ssaViewWrap"),Pt()},sn=function(){return!0},dn=function(e){z.log(e,z.LogLevels.error)},ln=function(e){var t,n={};return $.isString(e)?(t=e.split(/\?(.+)/),n.name=t[0],n.parameters=e.split(/parameters=(.+)/)[1],n):null},cn=function(){return he.mobileSDKSettings.deviceOs===m.deviceOs.android?"supersonicads":"SSAPublisher"},un=function(t){v.each(he.applicationSettings,function(e){e.match(/^custom/)&&-1===v.inArray(e,t)&&delete he.applicationSettings[e]})},fn=function(){var t={};return v.each(he.applicationSettings,function(e){e.match(/^custom/)&&(t[e]=he.applicationSettings[e])}),t},pn=function(e){var t=he.mobileSDKSettings.protocol+"//"+he.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",n=new Image,i={},r={logType:"",count:1,applicationKey:he.applicationSettings.applicationKey,applicationUserId:he.applicationSettings.applicationUserId,SDKVersion:he.mobileSDKSettings.SDKVersion,deviceOs:he.mobileSDKSettings.deviceOs,deviceOSVersion:he.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=v.extend({"deviceIds[OpenUDID]":he.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":he.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":he.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":he.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":he.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":he.mobileSDKSettings["deviceIds[IMEI]"]},r,e),v.each(e,function(e,t){$.isDefined(r[e])||(i[e]=t)}),v.isEmptyObject(i)||(e.customQueryString+=$.serialize(i)),n.src=$.renderTemplate(t,e)},gn=function(e){var n="";return $.isDefined(e)||(e=he),v.each(e,function(e,t){return!e.match(/^deviceIds/)||!$.isDefined(t)||null===t||(n=t,!1)}),n},vn=function(){var e=he.mobileSDKSettings;if(e.deviceScreenScale)try{var t=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1),n=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==m.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(n),e.deviceWidthDP=parseInt(t)}catch(e){z.log("SDKController | Failed to parse screen DP",z.LogLevels.error)}},mn=function(){var t=new v.Deferred,n=!1,i=he.mobileSDKSettings;return li()?t.resolve():z.CampaignsFilter.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then(function(e){v.each(e,function(e,t){t.isInstalled&&(n=!0)}),i.gpi=n,t.resolve()},function(){i.gpi=n,t.reject("Unable to check if Google play services is installed on the device")}),t.promise()},hn=function(){var e,t,i,r=[],a=new v.Deferred;return e=Y.subscribe(re+".parseDeviceStatus",function(e,t){Y.clearHandlers(r),z.log(h+"parseDeviceStatus received");var n=o(e.appOrientation);n.patch&&(Ie.trackEvent(rt.patchOrientation,{},{generalMessage:decodeURIComponent(e.appOrientation)}),e.appOrientation=n.appOrientation),(i=k.parseConfiguration(e,ge,he.mobileSDKSettings)).didSucceed?(z.callSDKFunction(t),E.init(he.controllerConfig.appOrientation,he.mobileSDKSettings),he.mobileSDKSettings.appOrientation=E.getOrientation(),he.mobileSDKSettings.displaySizeWidth=he.mobileSDKSettings["deviceScreenSize[width]"],he.mobileSDKSettings.displaySizeHeight=he.mobileSDKSettings["deviceScreenSize[height]"],vn(),G=w.create(he.mobileSDKSettings),z.AdvertisingIdService.decideOnAdvertisingId(he.mobileSDKSettings,he.controllerConfig),a.resolve()):a.reject(i.errMsg)}),r.push(e),t=Y.subscribe(re+".getDeviceStatusFailed",function(e){Y.clearHandlers(r),dn(e),a.reject(le.device)}),r.push(t),z.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),a.promise()},bn=function(){he.mobileSDKSettings.deviceOs!==m.deviceOs.ios&&z.callSDKFunction("setStoreSearchKeys",{searchKeys:Re[he.mobileSDKSettings.deviceOs]})},Sn=function(e){return $.isDefined(he[e])&&null!==he[e]||$.isDefined(he.applicationSettings[e])&&null!==he.applicationSettings[e]||$.isDefined(he.mobileSDKSettings[e])&&null!==he.mobileSDKSettings[e]||$.isDefined(he.controllerConfig[e])&&null!==he.controllerConfig[e]||$.isDefined(he.configMapping[e])&&null!==he.configMapping[e]()},yn=function(e){return $.isDefined(be[e])},An=function(e){var t;return $.isDefined(he[e])?t=he[e]:$.isDefined(he.applicationSettings[e])?t=he.applicationSettings[e]:$.isDefined(he.mobileSDKSettings[e])?t=he.mobileSDKSettings[e]:$.isDefined(he.controllerConfig[e])?t=he.controllerConfig[e]:$.isDefined(he.configMapping[e])?t=he.configMapping[e]():"customParam"===e&&(t=fn()),t},Cn=function(){var e,t,n=[],o=new v.Deferred;return e=Y.subscribe(re+".parseCachedFilesMap",function(e,t){var n,i,r,a={};(r=ot(["path"],e,"parseCachedFileMap")).didSucceed?(n=decodeURIComponent(e.path).split("/"),""!==e.path?a[i=n[n.length-1]]=$.isDefined(e[i])?e[i]:e:a=e,z.log("SDKController | successfully received files map:"+JSON.stringify(e),z.LogLevels.info),delete e.path,Tn(a).then(function(e){z.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(X.cachePriorityArray),z.LogLevels.verbose),z.log("SDKController | The file map after:"+JSON.stringify(e),z.LogLevels.verbose);var t=z.Cache.init(e,X.cachePriorityArray);return z.AdsAssetsManager.init(z.Cache,he.controllerConfig.cacheConfig),t}).then(function(){z.log("SDKController | Cache module initiated",z.LogLevels.info),z.callSDKFunction(t),o.resolve()}).fail(function(e){e="SDKController | Cache module failed to initiated",z.log(e,z.LogLevels.error),o.reject(e)})):o.reject(r.errMsg)}),n.push(e),t=Y.subscribe(re+".getCachedFilesMapFailed",function(e){z.log("SDKController | failed to receive files map:"+e,z.LogLevels.error),o.reject(le.filemap)}),n.push(t),z.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),o.promise()},Dn=function(t,n,i){n=n||{preloadNextInBG:!0},K.unloadAdView(t),ee.removeAdById(z.AdUtils.getAdId(t),t);var r=Gn(t),a=!1;r&&g.Utils.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(t).then(function(){a=r.getNextAd(!n.preloadNextInBG,t.inventoryId)}),z.log("engageEnd on controller with :"+t.engaged,z.LogLevels.verbose),g.PubSub.publish("SDKController.engageEnd",[t,function(){t.engaged&&K.unloadProductFromContainer(t);var e=!n.preloadNextInBG;r&&g.Utils.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(e,t.inventoryId),i&&i(),q.getState()===ce.play&&q.handleOnEngageEnd(t)}])},In=function(){var e=ke.controller;return he.mobileSDKSettings.deviceOs===m.deviceOs.android&&10==k.getDeviceApiLevel()&&(e=ke.device),e},wn=function(e){return Pn(e),On(e),e&&e.applicationKey&&(he.applicationSettings.applicationKey=e.applicationKey),k.parseConfiguration(e,ve,he.applicationSettings)},Pn=function(e){var t,n=me.length;for(t=0;t<n;t++)$.isDefined(e[me[t]])||(he.applicationSettings[me[t]]=null)},On=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&t.match(/^custom/)&&n.push(t);un(n)};function Tn(a){var e,r,t,o=[],n=new v.Deferred,s=[],d=["temp","files","assets","libs","graphicAssets",m.adPlayerDirectory],i=function(){var t=new v.Deferred,n=0;function i(){var e;(e=new v.Deferred,0<s.length&&v.each(s,function(e,t){X.cachePriorityArray&&X.cachePriorityArray[t]&&delete X.cachePriorityArray[t],delete a[t]}),"0"!==X.controllerVersion?(X.controllerVersion=he.v,z.setGlobalAppData(X).then(function(){e.resolve()},function(){e.reject("NewController: Save app global data failed")})):e.resolve(),e.promise()).then(function(){t.resolve(a)},function(e){t.reject(e)}),Y.clearHandlers(o)}return e=Y.subscribe(re+".deleteFolderSuccess",function(){z.log("NewController: A new controller version detected. Folder deleted successfully",z.LogLevels.verbose),++n>=s.length&&i()}),r=Y.subscribe(re+".deleteFolderFailed",function(e){if(Y.clearHandlers(o),g.Utils.isDefined(e.errCode)&&1==e.errCode)z.log("NewController: The folder requested for deletion was not found. Continue...",z.LogLevels.verbose),++n>=s.length&&i();else{Y.clearHandlers(o),t.reject("NewController: Purge cache for new controller version failed.")}}),function(){var e=m.cacheAdsDirectory,t="purgeCampaignsCache",n="purgeGlobalsCache",i=he.mobileSDKSettings;if(i.hasOwnProperty(t)&&!1===i[t])for(var r in a)r!==e&&-1===r.indexOf("RewardedVideo")&&-1===r.indexOf("Interstitial")||d.push(r);i.hasOwnProperty(n)&&!1===i[n]&&d.push("globals")}(),o.push(e),o.push(r),v.each(a,function(e,t){-1===d.indexOf(e)&&s.push(e)}),z.log(s+JSON.stringify(s),z.LogLevels.verbose),0<s.length?v.each(s,function(e,t){z.deleteFolder(t)}):i(),t.promise()};return z.getGlobalAppData().then(function(e){z.log("SDKController | getGlobalAppData: "+JSON.stringify(e),z.LogLevels.verbose),t=(X=e).controllerVersion,$.isDefined(t)&&t!==he.v||!$.isDefined(t)?(z.log("NewController: A new controller version detected. Purging cache... old: "+t+"new: "+he.v,z.LogLevels.verbose),ze=!0,i().then(function(e){n.resolve(e)},function(){n.reject()})):(z.log("NewController: Controller version did not change. Saved version: "+t+" Current version: "+he.v,z.LogLevels.verbose),n.resolve(a))},function(){z.log("SDKController | getGlobalAppData: failed! ",z.LogLevels.verbose),n.reject("getGlobalAppData: failed! ")}),n.promise()}function Fn(t){return function(e){Lt({data:e,id:t},!0)}}function xn(){return he.controllerConfig&&void 0!==he.controllerConfig.abTest?he.controllerConfig.abTest:-4}function Ln(e){Qe||z.getApplicationInfo(e).then(null,function(){var e=v.Deferred();return e.resolve(z.getConfig()),e.promise()}).always(function(e){var t=Nn(e);it.init(t),Qe=!0})}function Nn(e){var t=-1;try{t=parseInt(k.getDeviceApiLevel())}catch(e){z.log("getEventicsBaseData | Error converting deviceApiLevel to Integer "+e,z.LogLevels.verbose)}return{sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,controllerbn:e.controllerbn,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey,deviceId:Hn(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:k.getDeviceOsVersion(),deviceApiLevel:t,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:E.getOrientation(),env:yi.getEnv(),lat:"true"===e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:xn(),usertype:e.userType,platformABGroup:z.getSDKDataByKey(m.abTests.controllerConfigGroup),mediationType:e.controllerConfig.mediationType,appVersion:e.mobileSDKSettings.appVersion,SDKpluginType:e.applicationSettings.SDKPluginType}}function Un(e,t){var n,i=[],r=new v.Deferred,a=t.length;for(n=0;n<a;n++)i.push(Vn(e,t[n]));return v.when.apply(null,i).always(function(){z.deleteFolder(e),r.resolve(0)}),r.promise()}function Vn(r,a){var o=new v.Deferred,e=function(e){var t={timingValue:(new Date).getTime()-void 0,success:e},n=t.success?rt.cdnABTestSuccess:rt.cdnABTestFail,i={eNameStart:rt.cdnABTestSuccess,timingValue:t.timingValue,rvnomoreoffersreason:r,generalMessage:a};Ie.trackTimingStop(n,i),o.resolve()};return Ie.trackTimingStart(rt.cdnABTestSuccess),z.cacheAsset(r,a).then(e.bind(null,!0),e.bind(null,!1)),o.promise()}function Mn(){if(Z&&"rejected"!==Z.state())return g.Utils.returnResolvedPromise();var e="prod"===z.getEnv()?Xe:$e,t=z.getBaseCdnUrl()+e;return Z=v.ajax({url:t,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"getExtConfig",timeout:2e4}).then(function(e,t,n){z.log(h+"MicroJob | Got Application configuration"),u.setConfig(e)},function(e,t,n){var i=h+"MicroJob | Failed to receive configuration from server "+n;z.log(i,z.LogLevels.verbose),Ie.trackEvent(rt.getExternalApplicationConfigurationError,{generalMessage:i})}),g.Utils.returnResolvedPromise()}function En(t){var e="deviceVolumeSuccess";Y.subscribe(re+"."+e,function(e){z.log("Device volume received: "+(e?JSON.stringify(e):"empty")),t&&e&&t.call(null,{deviceVolume:e.deviceVolume||"0"})}),z.callSDKFunction("getDeviceVolume",{},e,e)}function kn(){var n,i,r=new v.Deferred;return n=Y.subscribe(re+".getDebugParamsSuccess",function(e){z.log(h+"getDebugParamsSuccess "+JSON.stringify(e));try{var t={};he.mobileSDKSettings.deviceOs===m.deviceOs.android?t=$.parseJSON(decodeURIComponent(e.SDK5DebugParams)):"object"==typeof e.SDK5DebugParams&&(t=e.SDK5DebugParams),r.resolve(t)}catch(e){z.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,z.LogLevels.verbose),r.reject("failed to parse received SDK5 params")}Y.clearHandlers([n,i])}),i=Y.subscribe(re+".getDebugParamsFailed",function(e){var t="failed to get debug param";z.log("getSDKDebugParams | getDebugParamsFailed | "+t,z.LogLevels.verbose),r.reject(t),Y.clearHandlers([n,i])}),z.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),r.promise()}function Kn(t){var n=new v.Deferred;return kn().then(function(e){return g.Utils.returnResolvedPromise(v.extend(t,e))}).always(function(e){n.resolve(e||t)}),n.promise()}function Bn(e){var t="false";!0===e&&(t="true"),z.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:t})}function Rn(){return he.mobileSDKSettings&&he.mobileSDKSettings.bundleId&&-1!==m.testAppBundleIds.indexOf(he.mobileSDKSettings.bundleId)}function jn(e){z.log("setCloseButtonState params "+JSON.stringify(e),z.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?_e[e.productType][e.demandSourceName]=ue[e.state]:_e[e.productType]=ue[e.state])}function Wn(){if(!Je){var e=z.getApiData(l.deviceDataRequestObject);e&&0<Object.keys(e).length&&(Je={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:k.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:he.mobileSDKSettings.webviewType})}return Je||{}}function _n(){var e;return he.controllerConfig&&!0===he.controllerConfig.isSecured?e=m.protocol.https:he.mobileSDKSettings.deviceOs===m.deviceOs.android?e=m.protocol.http:he.mobileSDKSettings.deviceOs===m.deviceOs.ios&&(he.mobileSDKSettings.deviceOSVersion&&0<=$.versionCompare(he.mobileSDKSettings.deviceOSVersion,"10")?he.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=m.protocol.http,J=!0):he.mobileSDKSettings.allowArbitraryLoads?e=m.protocol.http:(e=m.protocol.https,J=!0):e=he.mobileSDKSettings.allowArbitraryLoads?m.protocol.http:m.protocol.https),e}function Gn(e){if(e&&e.productType){var t=z[e.productType];return e.demandSourceName&&t&&(t=t[e.demandSourceName]),t}}function Hn(e){return fi()?qn(e):e["deviceIds[AID]"]}function qn(e){return 0<=$.versionCompare(e.deviceOSVersion,"10")&&"true"===e.isLimitAdTrackingEnabled?e["deviceIds[IDFV]"]:e["deviceIds[IFA]"]}function Qn(){var e=z.Cache.getCacheByType({cacheBase:"assets"}),t=he.mobileSDKSettings.jQueryUrls;e&&-1<z.Cache.getFileIndexInCache(e.cache,t[0])?z.log(h+"jQuery file already cache"):(z.log(h+"Start save jQuery to cache"),z.cacheAsset("assets",t).then(function(){z.log(h+"jQuery file saved successfully")},function(){z.log(h+"jQuery file cache failed")}))}function Jn(){var e=he.mobileSDKSettings.controllerPathFolder+he.v,t=z.Cache.getCacheByType({cacheBase:e});t&&-1<z.Cache.getFileIndexInCache(t.cache,he.mobileSDKSettings.controllerJSUrl)?z.log(h+"controller js file already cache"):Xn(e,he.mobileSDKSettings.controllerJSUrl)}function zn(){var e=he.mobileSDKSettings.controllerPathFolder+he.v,t=z.Cache.getCacheByType({cacheBase:e}),n=he.mobileSDKSettings.rootPath+ye,i=he.mobileSDKSettings.cacheFolderPath+"/"+Se;t&&-1<z.Cache.getFileIndexInCache(t.cache,n)?$n(i):Xn(e,n).then(function(){z.log("updateControllerCssToCache - cache css file succeeded",z.LogLevels.verbose),$n(i)},function(){z.log("updateControllerCssToCache - cache css file failed",z.LogLevels.verbose),$n(n)})}function Xn(e,t){return z.log(h+"Start saving file to cache, url: "+t),z.cacheAsset(e,t).then(function(){z.log(h+"File save success | "+t)},function(e){return z.log(h+"File save fail | "+t+" "+e),e})}function $n(e){var t=v("head");0<v("#ssaMobileControllerCss").length||t.prepend('<link rel="stylesheet" id="ssaMobileControllerCss" type="text/css" />'),v("#ssaMobileControllerCss").attr("href",e)}function Yn(){Qn(),Jn(),zn(),he.mobileSDKSettings.deviceOs===m.deviceOs.android&&z.AndroidNomediaFileHandler.updateNomediaFileToCache()}function Zn(e){if(!z.HTTPService.getIsNativeEngineExist())return!1;return z.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function ei(e){z.PixelTrackingService.firePixel(e)}function ti(e,t,n,i){var r,a,o=new v.Deferred,s=[];if(!$.isString(e)||!$.isString(t))return $.returnRejectedPromise("missing or corrupted params");r=Y.subscribe(re+".postAdEventNotificationSuccess",function(e){z.log("postAdEventNotificationSuccess"+JSON.stringify(e)),Y.clearHandlers(s),o.resolve()}),s.push(r),a=Y.subscribe(re+".postAdEventNotificationFailed",function(e){var t=e.errMsg?e.errMsg:"unknown reason";z.log("error calling postAdEventNotificationFailed: "+t,z.LogLevels.error),Y.clearHandlers(s),o.reject(t)}),s.push(a);var d={eventName:e,dsName:n,productType:t,extData:i||{}};return z.log("Controller - Notifies SDK on Event: "+d.eventName+" in Product: "+d.productType),z.callSDKFunction("postAdEventNotification",d,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),o.promise()}function ni(e){var t,n=v("#ssaDialogBox");switch(e){case"template4":t={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:ii(e).maxDialogBtnTextWidth,parentContainer:Pe}};break;default:t={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:ii(e).maxDialogBtnTextWidth,parentContainer:Pe}}}return t}function ii(e){return m.templateStyle[e]?m.templateStyle[e]:m.templateStyle.defaultTemplate}function ri(){var n="",e=v("#ssaDialogBox"),t=e[0]&&e[0].classList;return v.each(t,function(e,t){t.match(/template.*/)&&(n=t)}),n}function ai(e,t,n,i){g.PubSub.publish(re+"."+e,[t,n,i])}function oi(){for(;0<nativeQueue.length;){var e=nativeQueue.shift();ai(e.name,e.parameters,e.successCallback,e.errorCallback)}}function si(e){return z.SDKLimitations.getLimitData(e)}function di(e){z.OMIDService.isSupported(e)&&z.OMIDService.init(V)}function li(){return z.CompatibilityService.isFeatureSupportedInNativeSDK(x.limitAppFiltering)||z.CompatibilityService.isFeatureSupportedInNativeSDK(x.noPackagesInstallationPolling)}function ci(){z.SKOverlayManager.init(),ui()}function ui(){fi()&&z.callSDKFunction("toggleUDIA",{getByFlag:-1},"toggleUDIAStatusSuccess","toggleUDIAStatusFailed")}function fi(){return gi()===m.deviceOs.ios}function pi(){return gi()===m.deviceOs.android}function gi(){return he.mobileSDKSettings.deviceOs}function vi(e){K.unloadAdView(e),hi(e)}function mi(t){var n=W.get();ee.getAdsByProductType(t).forEach(function(e){e!==n&&z.OMIDService.finishSession(e).always(function(){vi(e),ee.removeAdById(z.AdUtils.getAdId(e),t)})})}function hi(e){e.productType===m.BN&&z.callSDKFunction("cleanAdInstance",{demandSourceId:e.demandSourceId,productType:e.productType},"cleanAdInstanceSuccess","cleanAdInstanceFailure")}function bi(t){var e=W.get(),n=ee.getAds(t);if(e){var i=K.getDisplayedAdView(e);z.log("Removing all current "+t.productType+" frames"),i&&i.hasClass&&i.hasClass(b.getAdUnitClassObj(t).class)&&W.isDisplayed()&&(at(),jt())}n.forEach(K.unloadAdView),n.forEach(function(e){z.log("remove from load creative "+z.AdUtils.getAdId(e)),ee.removeAdById(z.AdUtils.getAdId(e),t)})}function Si(e){if(e){z.getSegmentationAllocator().addControllerSourceSegment(e.controllerSourceStrategy);var t=e.controllerSourceCode;g.Utils.isDefined(t)&&it.updateBaseData({controllerSource:t})}}window.onerror=function(e,t,n,i,r){try{if(!r||!r.message)return;var a={url:t,lineNo:n,colNo:i,error:r&&r.message.substring(0,500)||""};z.log(h+"onError handler. Exception:"+JSON.stringify(a)),Ie&&Ie.trackEvent(rt.controllerException,{generalMessage:e},{rvnomoreoffersreason:JSON.stringify(a)})}catch(e){}};var yi={getAdPlayerAssets:function(){return H},adUnitGlobals:r,libsManager:t,adUnitUrl:s,adPlayerUrl:d,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:fe,debugMsg:n.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:_n,blacklistService:f,jQuery:function(){return v},api:function(){return _n()+"//"+he.mobileSDKSettings.domain},apiWithCdn:function(){return he.mobileSDKSettings.protocol+"//"+he.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return he.mobileSDKSettings.protocol+"//"+he.mobileSDKSettings.cdn},init:function(e,t){return z=this,v=window.jQuery,te||(v.extend(he.mobileSDKSettings,e.mobileSDKSettings),v.extend(he.controllerConfig,e.controllerConfig),V=new(Ai("../Environment/EnvironmentManager"))({controllerVersion:he.mobileSDKSettings.controllerVersion,schema:he.mobileSDKSettings.protocol,cdnDomain:he.mobileSDKSettings.cdn,scdnDomain:he.mobileSDKSettings.scdn,environment:he.mobileSDKSettings.env,deviceOs:he.mobileSDKSettings.deviceOs,cdnService:he.mobileSDKSettings.serviceCdn,stagingCdnDomain:he.mobileSDKSettings.domain,domain:he.mobileSDKSettings.domain}),he.mobileSDKSettings.overrideDebug&&(he.mobileSDKSettings.debug=he.mobileSDKSettings.defaultDebug),z.APIConfigurations.init(),k=new p(he,v,g.Utils,m),E=z.AppOrientationManager,M=new S(n,m,E),ee=new(Ai("./LoadedCreatives"))(z),vt(t),mt(),ct(),st(),pt(),ht(),bt(),dt(),lt(),Si(he.controllerConfig.controllerSourceData),z.log(h+"Controller initiated"),Q.setNativeConfiguration(D.native[he.mobileSDKSettings.deviceOs]),di(he.controllerConfig),v.when(hn(),Cn()).then(function(){var e=_n();r.setProtocol(e),H.setProtocol(e),window.queueValidMessages={},oi(),ci()},function(e){try{Ie.trackEvent(rt.initFailed,{},{generalMessage:decodeURIComponent(e)})}catch(e){}z.callSDKFunction("initController",{stage:"failed",errMsg:e})}).then(Mn).then(function(){v.when(Yn(),mn()).always(function(){var e={};li()||(e.gpi=he.mobileSDKSettings.gpi),_.updateToken(e)})}).fail(function(e){e?z.log(h+e):z.log(h+"failed promise on get app config")}),te=!0),te},getConfigurationHelper:function(){return k},getAPIRequiredData:function(){var e=z.APIConfigurations.getCommonRequiredData(),t=z.getApiData(e),n=new v.Deferred;return t&&t!=={}?g.Utils.isDefined(t.errMsg)?n.reject(t.errMsg):n.resolve(t):n.reject("Failed to get required parameters"),n.promise()},isIOS:fi,isAndroid:pi,getDeviceOs:gi,getApiData:function(e){var t,n={};for(t in e)if(e.hasOwnProperty(t)){if(1===e[t]&&!Sn(t)&&!yn(t)){n={errMsg:le.missing+t};break}Sn(t)?n[t]=An(t):"customParams"===t?v.extend(n,fn()):yn(t)&&(n[t]=be[t]())}return n},getSDKDataByKey:function(e){return An(e)},isAppsInstalledInfoRestricted:li,runFunction:function(e,t,n){var i=ln(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,t,n);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=$.parseJSON(i.parameters);try{$.isDefined(i.name)&&ai(i.name,r,t,n)}catch(e){z.log("error running function:"+i.name+", error:"+e,z.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,t,n)}},callSDKFunction:function(e,t,n,i){U.callSDKFunction(e,t,n,i)},callSDKFunctionWithCallback:function(e,t,n,i){U.callSDKFunctionWithCallback(e,t,n,i)},callSDKService:function(e,t,n,i,r){U.callSDKService(e,t,n,i,r)},getApplicationInfo:function(r,e){var n,i,a=v.Deferred(),o=function(e,t){Y.clearHandlers([n,i]),e?a.resolve(he):a.reject(le.appInfo,t)};if(n=Y.subscribe(re+".parseApplicationInfo",function(e,t,n){var i;$.isDefined(e.productType)&&e.productType!==r.productType&&e.demandSourceName!==r.demandSourceName?z.log(h+"parseApplicationInfo | info sent for the wrong product"):(z.log(h+"parseApplicationInfo: "+JSON.stringify(e)),delete e.productType,delete e.demandSourceName,(i=wn(e)).didSucceed?($.isDefined(t)&&z.callSDKFunction(t),o(!0)):($.isDefined(n)&&z.callSDKFunction(n,{errMsg:i.errMsg}),o(!1,i.errMsg)))}),i=Y.subscribe(re+".getApplicationInfoFailed",function(e){dn(e),o(!1,"Failed retrieving application info")}),$.isDefined(e)&&e){var t=wn(e);t.didSucceed?o(!0):(z.log(t.errMsg,z.LogLevels.error),o(!1,t.errMsg))}else z.callSDKFunction("getApplicationInfo",r,"parseApplicationInfo","getApplicationInfoFailed");return a.promise()},setCloseButtonState:jn,getEnv:function(){m.environment.production;return he.mobileSDKSettings.debug&&0<parseInt(he.mobileSDKSettings.debug)&&he.mobileSDKSettings.domain!==m.domainUrls.prod?he.mobileSDKSettings.domain===m.domainUrls.local?m.environment.develop:m.environment.stage:m.environment.production},getProtocol:function(){return he.mobileSDKSettings.protocol},isLegacy:function(e){var t=-1;try{var n="android"===he.mobileSDKSettings.deviceOs?e.android:e.ios;t=$.versionCompare(he.mobileSDKSettings.SDKVersion,n)}catch(e){z.log(e,z.LogLevels.error)}return t<0},cacheAdUnitAssets:function(t,e){var n,i=e.assets,r=e.lastUpdateTime,a=i.length,o=new v.Deferred,s=[],d=0;for(0===a&&o.resolve(0),n=0;n<a;n++)s.push(z.cacheAsset(t,i[n],r));return v.when.apply(null,s).always(function(){var e=arguments;for(n in e)z.log(h+"path: "+t+" res: "+e[n],3),e[n]&&d++;o.resolve(d)}),o.promise()},cacheAsset:function(t,n,e,i){var r,a,o,s=[],d=new v.Deferred;if($.isString(n)&&(n=[n]),"device"===he.applicationSettings.preCache){var l,c={path:$.isString(t)?t:t.toString(),overrideExistingFile:i},u=-1,f=function(e){d.reject(e),Y.clearHandlers(s)},p=function(e){++u>=n.length?f(e||"Index error in array assets url"):(l=n[u],c.file=J?$.changeUrlProtocol(l,m.protocol.https):l,z.log(h+"saveFile | "+c.file+" path: "+decodeURIComponent(c.path)),z.callSDKFunction("saveFile",c,"preCacheFileSuccess","preCacheFileFailed"))};$.isDefined(e)&&(c.lastUpdateTime=e.toString()),r=Y.subscribe(re+".assetCached",function(e){if(!ot(["path","file"],e,"preCacheFileSuccess").didSucceed)return z.log("error calling assetCached "+JSON.stringify(e),z.LogLevels.error),void f("error calling assetCached");decodeURIComponent(e.path)===t&&l.match(e.file)&&(Y.clearHandlers(s),z.log(h+"saveFile | success: "+decodeURIComponent(e.path)+"/"+e.file),d.resolve(!0))}),a=Y.subscribe(re+".assetCachedFailed",function(e){decodeURIComponent(e.path)===t&&l.match(e.file)&&(z.log(h+"saveFile | fail "+decodeURIComponent(e.path)+"/"+e.file),p("failed saved file"))}),o=Y.subscribe(re+".preCacheFileFailed",function(e){decodeURIComponent(e.path)===t&&l.match(e.file)&&(z.log(e.errMsg+": "+decodeURIComponent(e.path)+"/"+e.file,z.LogLevels.error),p(e.errMsg))}),s.push(r),s.push(a),s.push(o),p()}else d.resolve(!0);return d.promise()},deleteFolder:function(e){$.isString(e)||e.toString(),z.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(t,n){var e,i,r=new v.Deferred,a=[];return $.isString(t)||t.toString(),$.isString(n)||n.toString(),e=Y.subscribe(re+".deleteFileSuccess",function(e){if(!ot(["path","file"],e,"deleteFileSuccess").didSucceed)return z.log("error calling deleteFileSuccess "+JSON.stringify(e),z.LogLevels.error),r.reject("failed to delete file: "+e.file),void Y.clearHandlers(a);decodeURIComponent(e.path)===t&&n.match(e.file)&&(Y.clearHandlers(a),z.log("successfully deleted file: "+decodeURIComponent(e.path)+"/"+e.file),r.resolve())}),a.push(e),i=Y.subscribe(re+".deleteFileFailed",function(e){if(!ot(["path","file"],e,"deleteFileFailed").didSucceed)return z.log("error calling deleteFileFailed "+JSON.stringify(e),z.LogLevels.error),r.reject("failed to delete file: "+e.file),void Y.clearHandlers(a);decodeURIComponent(e.path)===t&&n.match(e.file)&&(Y.clearHandlers(a),z.log("failed to delete file: "+e.file),r.reject("failed to delete file: "+e.file))}),a.push(i),z.callSDKFunction("deleteFile",{path:t,file:n},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var t=e?In():ke.none;z.callSDKFunction("setBackButtonState",{state:t})},addAdToLoadedCreatives:function(e){return ee.addAd(e)},isContainerLoaded:function(e){return K.isContainerLoaded(e)},getContainerCreationHandler:function(e){return K.getContainerCreationHandler(e)},loadAdUnitUrl:function(e,t,n,i){K.createAndLoadView(e,t,n,i),ee.addAd(e)},displayAdView:function(e){K.displayAdView(e,Vt,Mt,Et)},updateAdUnitUrl:function(e,t,n,i){K.updateFrameUrl(e,t,n,i),ee.addAd(e)},onAdLoaded:function(e){z.log(h+"onAdLoaded | "+JSON.stringify(e));var t=function(){z.log(h+"ad loaded mismatch",z.LogLevels.error),Fe<xe&&(Y.publish("SDKController.AdLoadError",[e]),Fe++)};if(e&&e.productType)if(ee.getAdById(z.AdUtils.getAdId(e),e))Zt(e);else{var n={eventParam:{eName:rt.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(n.demandSourceName=e.demandSourceName),Y.publish("SDKController.Analytics",[n]),z.log(h+"onAdLoaded | mismatch from not being in loadedcreatives"),t()}else t()},removeAdUnit:function(e){if(W.isAdDisplayed(e)){var t=Gn(e);Nt();var n=!(!t||!$.isFunction(t.getNextAd))&&t.getNextAd(!0,e.inventoryId);jt(!1,n)}else{var i=ee.getAdById(z.AdUtils.getAdId(e),e);i.engaged=!1,Dn(i,{preloadNextInBG:!0})}},removeAdUnitFromExternal:function(e){ee.removeAdById(z.AdUtils.getAdId(e),e),g.PubSub.publish("SDKController.engageEnd",[e])},unloadAdViewsByProduct:bi,unloadAdViewsByProductExceptDisplayedView:mi,isRootFolder:function(e){return fi()?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return W.get()},setCurrentDisplayedAd:function(e){return W.set(e)},getCurrentDisplayedAdType:function(){return W.getDisplayedAdType()},isAdDisplayed:function(e){return W.isAdDisplayed(e)},getGlobalAppData:function(){var t,n,i,r,a=new v.Deferred;return t=Y.subscribe(re+".parseGlobalData",function(e){if(r="string"==typeof e.ssaGlobalAppData?$.parseJSON(decodeURIComponent(e.ssaGlobalAppData)):e.ssaGlobalAppData,z.log("Full global app data is: "+JSON.stringify(r)),!r)return a.reject("Invalid Global Data response"),void Y.clearHandlers([t,n]);a.resolve(r),Y.clearHandlers([t,n])}),n=Y.subscribe(re+".getGlobalDataFailed",function(e){i=ot(["errMsg"],e,"getGlobalDataFailed").didSucceed?e.errMsg:ot(["errMsg"],e,"getGlobalDataFailed").errMsg,a.reject(i),Y.clearHandlers([t,n])}),z.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),a.promise()},setCachePriorityArrayKey:function(t,n){return n?z.getGlobalAppData().then(function(e){return e.cachePriorityArray=e.cachePriorityArray||{},e.cachePriorityArray[t.cacheBase]=n,z.setGlobalAppData(e)}):g.Utils.returnResolvedPromise()},setGlobalAppData:function(e){var t,n,i,r=new v.Deferred;return t=Y.subscribe(re+".setGlobalDataSuccess",function(){r.resolve(),Y.clearHandlers([t,n])}),n=Y.subscribe(re+".setGlobalDataFailed",function(e){i=ot(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:ot(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),Y.clearHandlers([t,n])}),z.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(t,n){var i,r,a,o,s=new v.Deferred;return $.isDefined(n)&&!$.isDefined(t)?s.reject("Missing info to retrieve user data."):(i=Y.subscribe(re+".parseUserData",function(e){return ot(["ssaUserData"],e,"parseUserData").didSucceed?(o="string"==typeof e.ssaUserData?$.parseJSON(decodeURIComponent(e.ssaUserData)):e.ssaUserData,z.log("Full user data is: "+JSON.stringify(o)),o?($.isDefined(t)&&(o=o[t]||{},$.isDefined(n)&&(o=o[n]||{})),z.log("Get user data response: "+JSON.stringify(o)+" for appKey "+t+" and userId "+n),s.resolve(o)):s.reject("Invalid User Data response"),void Y.clearHandlers([i,r])):(a=ot(["errMsg"],e,"parseUserData").errMsg,s.reject(a),void Y.clearHandlers([i,r]))}),r=Y.subscribe(re+".getUserDataFailed",function(e){a=ot(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:ot(["errMsg"],e,"getUserDataFailed").errMsg,s.reject(a),Y.clearHandlers([i,r])}),z.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed")),s.promise()},setUserData:function(t,n,i){var r,a,o,s,d=new v.Deferred;return $.isDefined(t)&&$.isDefined(n)?v.when(z.getUserData()).then(function(e){s=e,$.isDefined(s[t])||(s[t]={}),$.isDefined(s[t][n])||(s[t][n]={}),i==={}?s[t][n]={}:v.extend(s[t][n],i),r=Y.subscribe(re+".setUserDataSuccess",function(){d.resolve(),Y.clearHandlers([r,a])}),a=Y.subscribe(re+".setUserDataFailed",function(e){o=ot(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:ot(["errMsg"],e,"setUserDataFailed").errMsg,d.reject(o),Y.clearHandlers([r,a])}),z.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(s)},"setUserDataSuccess","setUserDataFailed")},function(e){d.reject(e)}):d.reject("Missing info to set user data."),d.promise()},getConfig:function(){return he},getApplicationExternalConfig:function(){return u},isSupportedOsVersion:function(e){return null===k.getDeviceApiLevel().match(Be[e][he.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!he.controllerConfig||-1===m.applicationsLimitations.indexOf(he.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(he.mobileSDKSettings.deviceModel);return-1!==m.deviceLimitations.indexOf(e)},checkRequiredCallbackParams:function(e,t,n,i){return ot(e,t,n,i)},alert:function(e){var t,n=v("#ssaDialogText"),i=v(".dialogBox"),r=ri(),a=ni(r),o=ii(r),s=!1,d=v("#ssaDialogConfirmBtnText"),l=v("#ssaDialogCancelBtnText"),c=v("#ssaDialogBtns");Lt({name:"dialogBoxAboutToOpen"}),i.removeAttr("style"),i.css("display","block"),(!Te||e&&e.alwaysClose)&&(K.hideLoader(),Dt(),s=!0),Te||K.displayContainer(e);var u=b.getDisplayedAdFrame();if(u&&g.Msg.postMessage("hideFrame","*",u[0].contentWindow),c.removeClass("singleBtn"),"object"==typeof e&&(Oe.removeClass("hidden").removeAttr("style"),Pe.removeClass("hidden").removeAttr("style"),$.isDefined(e.close)?(t=e.close,d.text(e.yes),l.text(e.no),Pe.textWidth()>o.minDialogBtnWidth||Oe.textWidth()>o.minDialogBtnWidth?(Oe.css({width:o.maxDialogBtnWidth+"px",left:"20px"}),Pe.css({width:o.maxDialogBtnWidth+"px",right:"20px"})):(Oe.css({width:o.baseDialogBtnWidth+"px",left:"55px"}),Pe.css({width:o.baseDialogBtnWidth+"px",right:"55px"})),(Pe.textWidth()>o.maxDialogBtnTextWidth||Oe.textWidth()>o.maxDialogBtnTextWidth||-1!==v.inArray(" ",e.yes)||-1!==v.inArray(" ",e.no))&&(d.textfill2(a.buttonText),a.buttonText.parentContainer=Oe,l.textfill2(a.buttonText))):$.isDefined(e.message)?(t=e.message,$.isDefined(e.yes)&&d.text(e.yes),$.isDefined(e.no)&&l.text(e.no)):t=JSON.stringify(e),s&&(c.addClass("singleBtn"),Oe.addClass("hidden"),Pe[0]))){var f=Pe[0].offsetWidth/2;Pe.css("margin-left",-1*f+"px")}n.text(t),n.textfill2(a.dialogText),i.css("visibility","visible");var p=v("#ssaDialogBoxOverlay");p.fadeIn(100),p.bind("click",function(e){e.preventDefault()}),we.fadeIn(300)},log:n.log,logEvent:function(e,t){pn(e)},openUrl:function(e,t){wt(e,t)},postAdUnitEvent:function(e,t){Lt(e,t)},initEventics:Ln,initBannerExternalService:function(){R.init(),j.init()},getFormattedDeviceData:Wn,shouldExtendApiDataWithDebugData:Rn,extendApiDataWithDebugParams:Kn,getSDKDebugParams:kn,getNotchService:function(){return G},getTokenService:function(){return _},setAllowFileAccessFromFileURLs:Bn,getDeviceId:function(){return Hn(z.getConfig().mobileSDKSettings)},getSDKLimitationData:si,addExternalAdViewIdAndSetStatus:function(e){R.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return R},getAdViewContainer:function(e){return K.getAdViewByAd(e)},onAdVisible:Kt,saveFileToCache:Xn,getSegmentationAllocator:function(){return N},environmentConfiguration:function(){return V},getLoadedCreatives:function(){return ee},isBannerNoneLWS:Ft,isBannerAndLoadWhileShowSupported:function(e){return e===m.BN&&z.CompatibilityService.isFeatureSupportedInNativeSDK(x.bannerMultipleInstances)}};return z=yi,yi}e.exports=function(e){var t=Ai("../../components/Constants.js"),n=Ai("../Cache.js"),i=Ai("../OfferWall/OfferWall.js"),r=Ai("../BannerFactory.js"),a=Ai("../../components/HTTPService.js"),o=Ai("../../components/AdUtils"),s=Ai("../../components/DemandUtils.js"),d=Ai("../../components/SupplyConfigurations.js"),l=Ai("../../components/storeKit/StoreKitService.js"),c=Ai("../../components/ViewsManager.js"),u=Ai("../../components/PixelTrackingService.js"),f=Ai("../../components/OpenURLService.js"),p=Ai("../../components/OMIDService.js"),g=Ai("../../components/DeviceDataService.js"),v=Ai("../../components/RingerSwitchService.js"),m=Ai("../../components/OrientationService.js"),h=Ai("../../components/GDPRservice.js"),b=Ai("../../components/orientation/AppOrientationManager.js"),S=Ai("../../components/PermissionService"),y=Ai("./SDKLimitations"),A=Ai("../../components/APIConfigurations.js"),C=Ai("../../components/NativeLifeCycleEventsService.js"),D=Ai("../../components/LastSeenCampaignService"),I=Ai("../../components/AndroidNomediaFileHandler.js"),w=Ai("../../components/ImpressionsCounterService.js"),P=Ai("../DemandSource/FetchDemand/FetchDirect"),O=Ai("../../components/ExtraOffers"),T=Ai("../../components/CampaignsFilter.js"),F=Ai("../../components/AdvertisingIdService.js"),x=Ai("../../components/SKAdImpression/SKAdImpressionService"),L=Ai("../../components/FeatureCompatibilityService"),N=Ai("../Cache/AdsAssetsNativeCommunicator.js"),U=Ai("../Cache/AdsAssetsManager.js"),V=Ai("../../components/SKOverlay/SKOverlayManager.js"),M=Ai("../../components/SKOverlay/SKOverlayEventDispatcher"),E=Ai("../../components/AppUserIdService.js"),k=Ai("./InstancesTimers.js"),K=Ai("../../components/EventsManager"),B=new R(e,window.jQuery,t);return B.Cache=new n(e,B),B.SDKLimitations=new y(B),B.OfferWall=new i(e,B),B.BannerFactory=new r(e,B),B.HTTPService=new a(e,B),B.AdUtils=new o(e,B,window.jQuery),B.DemandUtils=new s(e,B,t),B.SupplyConfigurations=new d(B,t,window.jQuery),B.StoreKitService=new l(e,B,t),B.ViewsManager=new c(e),B.PixelTrackingService=new u(B),B.OpenURLService=new f(B),B.OMIDService=new p(e,B,window.jQuery),B.DeviceDataService=new g(e,B),B.RingerSwitchService=new v(e,B),B.OrientationService=new m(e,B,t),B.GDPRService=new h(e,B,t),B.AppOrientationManager=new b(e,B,t),B.PermissionService=new S(e,B),B.APIConfigurations=new A(B),B.NativeLifeCycleEventsService=new C(e,B,t),B.LastSeenCampaignService=new D(B,t),B.AndroidNomediaFileHandler=new I(B),B.ImpressionsCounterService=new w(t),B.FetchDirectService=new P(window.jQuery.ajax),B.ExtraOffers=new O(t,B.FetchDirectService,B.environmentConfiguration),B.CampaignsFilter=new T(e,B,t),B.AdvertisingIdService=new F(e,B,t),B.SKAdImpressionService=new x(e,B,t),B.CompatibilityService=new L(SuperSonicGlobalConfig.controllerConfig),B.AdsAssetsNativeCommunicator=new N(e,B),B.AdsAssetsManager=new U(e,B,B.AdsAssetsNativeCommunicator),B.SKOverlayManager=new V(e,B,t),B.SKOverlayEventDispatcher=new M(e,B,t),B.AppUserIdService=new E(e,B,t),B.InstancesTimers=new k,B.EventsManager=new K(B),B}},{"../../components/APIConfigurations.js":2,"../../components/AdOrientationManager":4,"../../components/AdUtils":5,"../../components/AdvertisingIdService.js":6,"../../components/AndroidNomediaFileHandler.js":9,"../../components/AppUserIdService.js":11,"../../components/BlacklistService":12,"../../components/CampaignsFilter.js":13,"../../components/Constants.js":14,"../../components/DemandUtils.js":15,"../../components/DeviceDataService.js":17,"../../components/DisplayedAdManager.js":18,"../../components/EventsManager":19,"../../components/ExternalConfig":20,"../../components/ExtraOffers":21,"../../components/FeatureCompatibilityService":22,"../../components/FrameHelper.js":26,"../../components/GDPRservice.js":28,"../../components/HTTPService.js":29,"../../components/IframeManager":30,"../../components/ImpressionsCounterService.js":31,"../../components/LastSeenCampaignService":33,"../../components/Logger.js":34,"../../components/NativeAPIAdapter.js":37,"../../components/NativeLifeCycleEventsConstants.js":38,"../../components/NativeLifeCycleEventsService.js":39,"../../components/NotchFactory.js":40,"../../components/OMIDService.js":43,"../../components/OpenURLService.js":47,"../../components/OrientationService.js":49,"../../components/PermissionService":51,"../../components/PixelTrackingService.js":53,"../../components/RingerSwitchService.js":56,"../../components/SKAdImpression/SKAdImpressionService":57,"../../components/SKOverlay/SKOverlayEventDispatcher":60,"../../components/SKOverlay/SKOverlayManager.js":61,"../../components/SupplyConfigurations.js":62,"../../components/ViewsManager.js":65,"../../components/containers/AdViewsManager.js":67,"../../components/containers/BackgroundController":68,"../../components/containers/BannerExternalAdViewService":69,"../../components/containers/BannerExternalContainer.js":70,"../../components/containers/NavigationModeView":76,"../../components/containers/WPADUtils":77,"../../components/containers/WebView":78,"../../components/containers/WebViewManager.js":79,"../../components/orientation/AppOrientationManager.js":81,"../../components/storeKit/StoreKitService.js":89,"../../components/token/TokenService.js":92,"../../constants/SDKFeatureNames":93,"../../modules/SDKController/EventCategories":147,"../../patches/PatchAppOrientation":171,"../../presenter/uiConfig.js":177,"../AdPlayer/AdPlayerAssets":96,"../AdPlayer/AdPlayerUrl":97,"../AdUnitManager/AdUnitGlobals.js":101,"../AdUnitManager/LibsManager.js":104,"../AdUnitUrl.js":105,"../BannerFactory.js":108,"../Cache.js":109,"../Cache/AdsAssetsManager.js":111,"../Cache/AdsAssetsNativeCommunicator.js":112,"../DemandSource/FetchDemand/FetchDirect":122,"../Environment/EnvironmentManager":129,"../OfferWall/OfferWall.js":136,"../ProductRouter.js":141,"../SDKInterface.js":159,"../UserSegmentation/SegmentationAllocator.js":161,"../UserSegmentation/SegmentationManager":163,"./ConfigurationHelper.js":146,"./InstancesTimers.js":148,"./LoadedCreatives":149,"./MessageHandler":151,"./SDKLimitations":153,"./mainConfig.js":155,"./nativeConfigHandler.js":156,"./sessionConfig":157,"./videoStateHandler.js":158}],153:[function(e,t,n){t.exports=function(n){var i=" is not supported";return{getLimitData:function(e){var t={errMsg:"",didSucceed:!0};return n.isSupportedOsVersion(e)?n.isLimitedDeviceModel()&&(t.errMsg="Device"+i,t.didSucceed=!1):(t.errMsg="Operating system version "+n.getApiData({deviceOSVersion:1}).deviceOSVersion+i,t.didSucceed=!1),t}}}},{}],154:[function(e,t,n){t.exports=function(s,t,d){var l={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var t=e;return"portrait"===(t=t.toLowerCase())||"landscape"===t||"none"===t},connectionType:function(e){var t=decodeURIComponent(e);return"wifi"===(t=t.toLowerCase())||t.match(/^mobile\[.+\]$/)||"3g"===t||"none"===t},iphoneAppOnIpadDevice:function(e){var t=parseInt(e);return 0===t||1===t},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(e){return s.isDefined(e)},"deviceIds[IFA]":function(e){return s.isDefined(e)},"deviceIds[SERIAL]":function(e){return s.isDefined(e)},"deviceIds[AndroidID]":function(e){return s.isDefined(e)},"deviceIds[IMEI]":function(e){return s.isDefined(e)},"deviceIds[AID]":function(e){return s.isDefined(e)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(e){return s.isDefined(t[e])},disableCache:function(e){var t=parseInt(e);return 0===t||1===t},disableSession:function(e){var t=parseInt(e);return 0===t||1===t},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var t=parseInt(e);return 0<=t&&t<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},itemCount:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},minimumOfferCommission:function(e){var t=parseFloat(e);return!isNaN(t)&&0<=t},demoCampaigns:function(e){var t=parseInt(e);return 0===t||1===t},numOfCampaigns:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},campaignId:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},pageSize:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},landingId:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},page:function(e){var t=parseInt(e);return!isNaN(t)&&0<t},admin:function(e){var t=parseInt(e);return 0===t||1===t},useClientSideCallbacks:function(e){var t=e.toString();return"true"===t||"false"===t},unLocked:function(e){var t=e.toString();return"true"===t||"false"===t},isLimitAdTrackingEnabled:function(e){return s.isDefined(e)},placementId:function(e){var t=parseInt(e);return!isNaN(t)&&0<=t},allowArbitraryLoads:function(e){var t=e.toString();return"true"===t||"false"===t},allowArbitraryLoadsInWebContent:function(e){var t=e.toString();return"true"===t||"false"===t}};return function(e,t){var n,i,r,a=!0,o=null;for(n in e){if(s.isDefined(l[n])&&!1===l[n](e[n])){o=d.invalid+n,a=!1;break}r=e[i=n],t[i]=r}return{didSucceed:a,errMsg:o}}}},{}],155:[function(e,t,n){t.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],156:[function(i,e,t){function n(e,t){var n=i("../../components/Constants.js");return e.subscribe(n.CB+".nativeConfigSuccess",function(e){t.log("nativeConfig update successfully.",t.LogLevels.error)}),e.subscribe(n.CB+".nativeConfigFailed",function(e){t.log("nativeConfig failed to update.",t.LogLevels.error)}),{setNativeConfiguration:function(e){e&&t.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;e.exports=function(e,t){return r||(r=new n(e,t)),r}},{"../../components/Constants.js":14}],157:[function(e,t,n){t.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],158:[function(o,e,t){function n(e,t){var n=o("../../components/Constants.js"),i=n.videoStates,r=n.RV,a=i.none;return e.subscribe("SDKController.AdStarted",function(){t.log("VideoStateHandler | AdStarted",t.LogLevels.verbose),a=i.play,t.callSDKFunction("onVideoStatusChanged",{status:"started",productType:r})}),e.subscribe("SDKController.AdPlaying",function(){t.log("VideoStateHandler | AdPlaying",t.LogLevels.verbose),a=i.play,t.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:r})}),e.subscribe("SDKController.AdPaused",function(){t.log("VideoStateHandler | AdPaused",t.LogLevels.verbose),a=i.stop,t.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:r})}),e.subscribe("SDKController.AdVideoEnded",function(){t.log("VideoStateHandler | AdVideoEnded",t.LogLevels.verbose),a=i.stop,t.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:r})}),{handleOnEngageEnd:function(){t.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",t.LogLevels.verbose),a=i.none,t.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:r})},getState:function(){return a}}}var i;e.exports=function(e,t){return i||(i=new n(e,t)),i}},{"../../components/Constants.js":14}],159:[function(e,t,n){var o=e("./iOSSDKInterface.js"),s=e("./iOSSDKInterface_WK.js"),d=e("./androidSDKInterface.js");t.exports=function(e,t,n,i){"use strict";var r,a="undefined";switch(e.deviceOs){case t.deviceOs.android:r=new d(i,n,a);break;case t.deviceOs.ios:r="wk"===e.webviewType?new s(a):new o(a);break;default:r=new o(a)}return r}},{"./androidSDKInterface.js":167,"./iOSSDKInterface.js":168,"./iOSSDKInterface_WK.js":169}],160:[function(g,e,t){function v(i){var r,a,o={},s={},n=!1,d=function(t,e){var n=null;o=r.Utils,(s=r.PubSub).init(),o.isDefined(t.mobileSDKSettings)&&(n=(a=r.SDKController).init(t,e)),i.when(n).then(function(){t.products&&i.each(t.products,function(e){o.isDefined(e.init)&&e.init(t[e])})},function(){console.log("Failed to initiate controller")})},e={init:function(e,t){return r=this,d(e,t),n=!0},log:function(e,t){a&&a.log&&a.log(e,t||a.LogLevels.error)}};return e}e.exports=function(e,t,n,i){var r=g("../components/Utils.js"),a=g("../components/PubSub.js"),o=g("../components/Msg.js"),s=g("./AdAssets.js"),d=g("./VastUtils.js"),l=t.Eventics,c=new v(e),u={};c.Utils=new r(c,t,n,i),c.PubSub=new a(c),c.Msg=new o,c.AdAssets=new s,c.VastUtils=new d(c.AdAssets);var f,p=["KuduEventicsProvider"];return f=t.productionDebug||t.SuperSonicGlobalConfig&&t.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==t.SuperSonicGlobalConfig.mobileSDKSettings.domain?(p.push("QAEventicsProvider"),1):Math.random(),t.SuperSonicGlobalConfig&&t.SuperSonicGlobalConfig.mobileSDKSettings&&t.SuperSonicGlobalConfig.mobileSDKSettings.protocol&&(u.isSecured="https:"===t.SuperSonicGlobalConfig.mobileSDKSettings.protocol),c.Eventics=l(f),c.Eventics.setProvidersHandlers(p),c.Eventics.setProvidersConfig(u),c.PubSub.subscribe("updateEventsBaseData",function(e){e&&"object"!=typeof e||c.Eventics.updateBaseData(e)}),c}},{"../components/Msg.js":35,"../components/PubSub.js":54,"../components/Utils.js":63,"./AdAssets.js":95,"./VastUtils.js":165}],161:[function(e,t,n){t.exports=function(n){var i=e("./SegmentsRepository");function r(e,t){n.addSegment(e,t)}return{addCellularNetworkTypeSegment:function(e){var t,n=i.cellularNetworkType;-1===e?t=n.cellularNetworkTypeUnknown:"notReachable"===e?t=n.cellularNetworkTypeNotReachable:"wifi"===e?t=n.cellularNetworkTypeWifi:-1!==["CTRadioAccessTechnologyGPRS","CTRadioAccessTechnologyEdge","CTRadioAccessTechnologyCDMA1x"].indexOf(e)?t=n.cellularNetworkType2G:-1!==["CTRadioAccessTechnologyWCDMA","CTRadioAccessTechnologyHSDPA","CTRadioAccessTechnologyHSUPA","CTRadioAccessTechnologyCDMAEVDORev0","CTRadioAccessTechnologyCDMAEVDORevA","CTRadioAccessTechnologyCDMAEVDORevB","CTRadioAccessTechnologyeHRPD"].indexOf(e)?t=n.cellularNetworkType3G:"CTRadioAccessTechnologyLTE"===e&&(t=n.cellularNetworkType4G),r(t,n)},addIsSDCardAvailableSegment:function(e){var t,n=i.isSDCardAvailable;-1===e?t=n.isSDCardAvailableUnknown:"true"===e?t=n.isSDCardAvailableTrue:"false"===e&&(t=n.isSDCardAvailableFalse),r(t,n)},addTotalDeviceRAMSegment:function(e){var t=i.totalDeviceRAM,n=-1===e?e:parseInt(e)/1073741824;r(-1===e?t.totalDeviceRAMUnknown:n<1?t.totalDeviceRAMUnder1GB:n<2?t.totalDeviceRAMUnder2GB:n<3?t.totalDeviceRAMUnder3GB:n<4?t.totalDeviceRAMUnder4GB:n<6?t.totalDeviceRAMUnder6GB:n<8?t.totalDeviceRAMUnder8GB:n<12?t.totalDeviceRAMUnder12GB:t.totalDeviceRAM12GBAndAbove,t)},addIsChargingSegment:function(e){var t,n=i.isCharging;-1===e?t=n.isChargingUnknown:"true"===e?t=n.isChargingTrue:"false"===e&&(t=n.isChargingFalse),r(t,n)},addAirplaneModeSegment:function(e){var t,n=i.airplaneMode;-1===e?t=n.airplaneModeUnknown:"true"===e?t=n.airplaneModeTrue:"false"===e&&(t=n.airplaneModeFalse),r(t,n)},addChargingTypeSegment:function(e){var t=i.chargingType;r(-1===e?t.chargingTypeUnknown:"1"===e?t.chargingTypeAC:"2"===e?t.chargingTypeUSB:"4"===e?t.chargingTypeWireless:t.chargingTypeNone,t)},addStayOnWhenPluggedInSegment:function(e){var t,n=i.stayOnWhenPluggedIn;-1===e?t=n.stayOnWhenPluggedInUnknown:"true"===e?t=n.stayOnWhenPluggedInTrue:"false"===e&&(t=n.stayOnWhenPluggedInFalse),r(t,n)},addBatteryLevelSegment:function(e){var t,n=i.batteryLevel;void 0===e||e<0||(e<=20?t=n.batteryLowestFifth:e<=40?t=n.batterySecondFifth:e<=60?t=n.batteryThirdFifth:e<=80?t=n.batteryFourthFifth:e<=100&&(t=n.batteryHighestFifth)),r(t,n)},addAdLevelCacheSegment:function(e){r(e,i.adLevelCache)},addControllerSourceSegment:function(e){var t=i.controllerSourceStrategy;switch(e){case 0:r(t.fetchFromServerNoFallback,t);break;case 1:r(t.fetchFromServerWithLocalFallback,t);break;case 2:r(t.fetchForNextSessionLoadFromLocal,t)}}}}},{"./SegmentsRepository":164}],162:[function(e,t,n){t.exports={events:{receivedFromAdunit:{addSegment:"SDKController.addSegment",getSegments:"SDKController.getSegments",clearSegmentFromGroup:"SDKController.clearSegmentFromGroup"},sendToAdunit:{updateUserSegments:"updateUserSegments"}}}},{}],163:[function(d,e,t){e.exports=function(e,n){var i="SegmentationManager | ",t=d("./SegmentationConstants"),r=d("./SegmentsRepository"),l=[];function a(e,t){(function(e,t){if(isNaN(e)||(r=e,-1!==l.indexOf(r))||(n=e,!c(i=t)||!function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){var r=t[n[i]];if(e===r)return!0}return!1}(n,i)))return!1;for(var n,i,r,a=Object.keys(t),o=0;o<a.length;o++)for(var s=t[a[o]],d=0;d<l.length;d++)if(l[d]===s)return l[d]=e,!0;return l.push(e),!0})(e,t)&&s()}function c(e){return e&&"object"==typeof e}function o(e){if(c(e))for(var t=Object.keys(e),n=0;n<l.length;n++)for(var i=0;i<t.length;i++){var r=e[t[i]];if(l[n]===r)return l.splice(n,1),void s()}}function s(){e.PubSub.publish("updateEventsBaseData",[{segments:l.toString()}]),n.postAdUnitEvent({name:t.events.sendToAdunit.updateUserSegments,segments:l},!0)}return{init:function(){e.PubSub.subscribe(t.events.receivedFromAdunit.addSegment,function(e){a(e.segment,e.segmentGroup)}),e.PubSub.subscribe(t.events.receivedFromAdunit.getSegments,function(e){if(n.log(i+" controller - getSegments received"),e.getSegmentsCallback){var t=e.getSegmentsCallback;n.log(i+"send back to adunit "+t+" with data: "+JSON.stringify(l)),n.postAdUnitEvent({name:t,segments:l},!0)}}),e.PubSub.subscribe(t.events.receivedFromAdunit.clearSegmentFromGroup,function(e){o(e.segmentGroup)})},addSegment:a,getUserSegmentsObjectsAsArray:function(){return l},clearSegmentFromGroup:o,segmentsRepository:r}}},{"./SegmentationConstants":162,"./SegmentsRepository":164}],164:[function(e,t,n){t.exports={batteryLevel:{batteryLowestFifth:101,batterySecondFifth:102,batteryThirdFifth:103,batteryFourthFifth:104,batteryHighestFifth:105},cellularNetworkType:{cellularNetworkTypeWifi:117,cellularNetworkType2G:118,cellularNetworkType3G:119,cellularNetworkType4G:120,cellularNetworkTypeNotReachable:121,cellularNetworkTypeUnknown:122},isCharging:{isChargingTrue:123,isChargingFalse:124,isChargingUnknown:125},airplaneMode:{airplaneModeTrue:126,airplaneModeFalse:127,airplaneModeUnknown:128},stayOnWhenPluggedIn:{stayOnWhenPluggedInTrue:129,stayOnWhenPluggedInFalse:130,stayOnWhenPluggedInUnknown:131},chargingType:{chargingTypeAC:132,chargingTypeUSB:133,chargingTypeWireless:134,chargingTypeNone:135,chargingTypeUnknown:136},totalDeviceRAM:{totalDeviceRAMUnder1GB:137,totalDeviceRAMUnder2GB:138,totalDeviceRAMUnder3GB:139,totalDeviceRAMUnder4GB:140,totalDeviceRAMUnder6GB:141,totalDeviceRAMUnder8GB:142,totalDeviceRAMUnder12GB:143,totalDeviceRAM12GBAndAbove:144,totalDeviceRAMUnknown:145},isSDCardAvailable:{isSDCardAvailableTrue:146,isSDCardAvailableFalse:147,isSDCardAvailableUnknown:148},adLevelCache:{adLevelCacheTimeoutControl:154,adLevelCacheTimeoutFiveMinutes:155,adLevelCacheTimeoutThirtySeconds:156},controllerSourceStrategy:{fetchFromServerNoFallback:151,fetchFromServerWithLocalFallback:152,fetchForNextSessionLoadFromLocal:153}}},{}],165:[function(e,t,n){t.exports=function(t){function n(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function i(e,t){return e&&(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=t),e}function r(e){return!!e&&(0<t.extractVastSource(e).length||e.ext&&e.ext.videoData&&!0===e.ext.videoData.isVast)}return{getVastViewCount:n,setVastViewCount:i,setMaxVastCount:function(e){e&&r(e)&&"number"==typeof e.ext.vastExhaustIndex&&0<e.ext.vastExhaustIndex&&i(e,e.ext.vastExhaustIndex)},isVastCampaign:r,isThereVastCampaign:function(e){if(!e||!jQuery.isArray(e))return!1;for(var t=!1,n=0;n<e.length;n++)if(r(e[n])){t=!0;break}return t},areAllCampaignTypesAreVast:function(e){if(!e||!jQuery.isArray(e)||0===e.length)return!1;for(var t=!0,n=0;n<e.length;n++)if(!r(e[n])){t=!1;break}return t},incrementVastViewCount:function(e){return e&&r(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&r(e)&&e.ext.vastExhaustIndex&&n(e)<e.ext.vastExhaustIndex},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],166:[function(r,e,t){(function(e){"use strict";var t=r("./SonicCore.js"),n=r("./SDKController/SDKController.js");var i=e.SonicCore=e.SSA_CORE=new t(e.jQuery,e,document,"undefined");i.SDKController=new n(i,"undefined"),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":152,"./SonicCore.js":160}],167:[function(e,t,n){function i(i,n,t){function r(e,t){var n=i.hashMessage(e,t);Android.messageHandler(e,JSON.stringify(t),n)}function a(e,t){Android[e](JSON.stringify(t))}function o(e,t){return void 0!==e&&e[t]}var s={postMessage:function(t,e){if(o(window.Android,i?"messageHandler":t))try{i?r(t,e):a(t,e)}catch(e){n.log("Error running function "+t+" error:"+JSON.stringify(e),n.LogLevels.error)}else n.log("Error calling SDK function "+t,n.LogLevels.error)}},e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof s[e.eventName]?s[e.eventName](e.parameters):s.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return e}t.exports=i},{}],168:[function(e,t,n){function i(t){var i=function(e,t,n){var i,r=e+"://"+t+"?";jQuery.each(n,function(e,t){"object"==typeof t&&(n[e]=JSON.stringify(t))}),i=r+jQuery.param(n),a(i)},n=function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},a=function(e){0===o.length?(o.push("1"),n(e)):o.push(e)},r={postMessage:function(e,t,n){i(e,t,n)}},o=[],e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&n(e)}}};return e}t.exports=i},{}],169:[function(e,t,n){function i(t){var i=function(e,t,n){var i,r=e+"://"+t+"?";jQuery.each(n,function(e,t){"object"==typeof t&&(n[e]=JSON.stringify(t))}),i=r+jQuery.param(n),a(i)},n=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},a=function(e){0===o.length?(o.push("1"),n(e)):o.push(e)},r={postMessage:function(e,t,n){i(e,t,n)}},o=[],e={postMessage:function(e){typeof e.eventName!==t&&typeof e.prefix!==t&&typeof e.parameters!==t&&("function"==typeof r[e.eventName]?r[e.eventName](e.parameters):r.postMessage(e.prefix,e.eventName,e.parameters))},acknowledgeMessage:function(){if(0!==o.length){var e=o.shift();"1"===e&&0!==o.length&&(e=o.shift()),void 0!==e&&"1"!==e&&n(e)}}};return e}t.exports=i},{}],170:[function(e,t,n){t.exports=function(n,t,i,r){var e=!1,a=!1,o=!1,s=!0,d=r.CB+".enterBackground",l=r.CB+".enterForeground",c=r.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){e||(n.PubSub.subscribe(r.taskManager+".Engaged",function(e){n.Utils.isDefined(e.duringEngage)&&e.productType===i&&(a=e.duringEngage,t.log(u+"duringEngage "+a))}),n.PubSub.subscribe(d,function(){t.log(u+d),o=!0}),n.PubSub.subscribe(l,function(){t.log(u+l),o=!1}),n.PubSub.subscribe(c,function(e){n.Utils.isDefined(e.connectionType)&&(s="none"!==e.connectionType&&"notReachable"!==e.connectionType)}),e=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var e=new jQuery.Deferred;return o?n.PubSub.subscribeOnce(l,function(){e.resolve()}):e.resolve(),e.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(e,t){n.PubSub.publish(r.taskManager+"."+e,t)}}}},{}],171:[function(e,t,n){t.exports=function(e){return e&&"unknown"!==e?{appOrientation:e}:{appOrientation:"none",patch:!0}}},{}],172:[function(e,t,n){var i=function(){function e(){}return e.prototype.isFileNameMatches=function(e,t){if(e===t)return!0;var n=decodeURIComponent(decodeURIComponent(e));return n===t||n===decodeURIComponent(t)},e.prototype.getCachedFileName=function(e,t){return t?this._encodeFileName(this._encodeFileName(e)):this._encodeFileName(e)},e.prototype._encodeFileName=function(e){return encodeURI(e).replace(/%20/g,"+").replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/~/g,"%7E")},e}();t.exports=i},{}],173:[function(e,t,n){t.exports=function(t,n,i){var r="ios"===n.getConfig().mobileSDKSettings.deviceOs&&i;return r&&(n.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(i)),t.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",function(e){var t;t=e,n.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(i)+" , with params:"+JSON.stringify(t)),t&&i&&i.demandGroupName===t.demandGroupName&&i.productType===t.productType&&i.demandSourceName!==t.demandSourceName&&(n.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),n.callSDKFunction("loadInterstitialFail",{demandSourceName:i.demandSourceName}))})),{onShowSuccess:function(e){r&&t.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:e.productType,demandGroupName:e.demandGroupName,demandSourceName:e.demandSourceName}])}}}},{}],174:[function(e,t,n){t.exports=function(t,n){var i=e("../constants/SDKFeatureNames");return{shouldBlock:function(e){return(!n||!n.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&0<=t.versionCompare(e,"13.2")}}}},{"../constants/SDKFeatureNames":93}],175:[function(e,t,n){t.exports=function(e,n,r){function i(){var e=decodeURIComponent(n.deviceModel);return-1!==r.iphoneXDeviceModels.indexOf(e)}function t(){var e=n.deviceWidthDP,t=n.deviceHeightDP;return i()&&function(e,t){var n=r.iphoneXDeviceResolution;for(var i in n)if(n.hasOwnProperty(i)&&n[i].width&&n[i].height&&(e===n[i].width&&t===n[i].height||e===n[i].height&&t===n[i].width))return!0;return!1}(e,t)}return{hasNotch:i,onEngageEnd:function(){t()},onSetConfig:function(e){return i()&&(t=e).settings&&t.settings.standaloneView;var t},className:"PatchesIphoneX"}}},{}],176:[function(e,t,n){t.exports=function(t){var n={android:/^\b[1][0-9]\b|\b[2][0]\b/,ios:/^[8|9]/},i=["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]);return{shouldFail:function(e){return!(!e.controllerConfig||-1===i.indexOf(e.controllerConfig.applicationKey))&&null!==t.getDeviceApiLevel().match(n[e.mobileSDKSettings.deviceOs])}}}},{}],177:[function(e,t,n){t.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn1"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>',loaderOWTemplate:'<div class="loaderOW hidden">        <div class="header">        </div>        <div class="progressbarWrap">            <div class="progressbar"></div>        </div>        <div class="offers">        <div class="shine"></div>        </div>    </div>',loaderOWOfferTemplate:'<div class="offer">        <div class="offerWrap">        <div class="offerImg"></div>        <div class="offerDetails">        <div>        <span class="offerText">Loading Info...</span>        </div>        <div class="offerEarn">        <div class="badge"></div>        <div class="callToAction">Loading...</div>        </div>        </div>        <div class="offerBtn"></div>        </div>        </div>'},style:{forceCloseProperties:{disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}],178:[function(e,t,n){"use strict";var i;n.__esModule=!0,n.AdType=void 0,(i=n.AdType||(n.AdType={})).CPVI="CPVI",i.CustomEndCard="customEndCard",i.MRAID="MRAID",i.PlayableAd="playableAd",i.ImageInterstitial="imageInterstitial",i.StaticBanner="staticBanner",i.AppTrailerMarketplace="AT_MP"},{}],179:[function(e,t,n){"use strict";var i,r,a;n.__esModule=!0,n.Protocol=n.Environment=n.DeviceOs=void 0,(i=n.DeviceOs||(n.DeviceOs={})).Android="android",i.IOS="ios",(r=n.Environment||(n.Environment={})).Develop="dev",r.Production="prod",r.Stage="stage",(a=n.Protocol||(n.Protocol={})).Http="http:",a.Https="https:",a.File="file:"},{}],180:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("tslib");i.__exportStar(e("./ad"),n),i.__exportStar(e("./common"),n),i.__exportStar(e("./interfaces/externalContainer"),n)},{"./ad":178,"./common":179,"./interfaces/externalContainer":181,tslib:1}],181:[function(e,t,n){"use strict";n.__esModule=!0},{}]},{},[166]);